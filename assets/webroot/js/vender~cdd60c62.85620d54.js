(self.webpackChunk=self.webpackChunk||[]).push([[739],{43653:(t,e,i)=>{t.exports=i(61555)},29685:(t,e,i)=>{"use strict";var n=i(90501),s=i(93063),o=i(9233),a=i(44306),r=i(85938),h=i(12644),l=i(23977),u=i(71987),c=i(35424),d=i(10235),_=i(36374);t.exports=function(t){return new Promise((function(e,i){var g,p=t.data,m=t.headers,f=t.responseType;function A(){t.cancelToken&&t.cancelToken.unsubscribe(g),t.signal&&t.signal.removeEventListener("abort",g)}n.isFormData(p)&&n.isStandardBrowserEnv()&&delete m["Content-Type"];var v=new XMLHttpRequest;if(t.auth){var T=t.auth.username||"",y=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";m.Authorization="Basic "+btoa(T+":"+y)}var P=r(t.baseURL,t.url);function O(){if(v){var n="getAllResponseHeaders"in v?h(v.getAllResponseHeaders()):null,o={data:f&&"text"!==f&&"json"!==f?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:n,config:t,request:v};s((function(t){e(t),A()}),(function(t){i(t),A()}),o),v=null}}if(v.open(t.method.toUpperCase(),a(P,t.params,t.paramsSerializer),!0),v.timeout=t.timeout,"onloadend"in v?v.onloadend=O:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(O)},v.onabort=function(){v&&(i(new c("Request aborted",c.ECONNABORTED,t,v)),v=null)},v.onerror=function(){i(new c("Network Error",c.ERR_NETWORK,t,v,v)),v=null},v.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",n=t.transitional||u;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),i(new c(e,n.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,t,v)),v=null},n.isStandardBrowserEnv()){var b=(t.withCredentials||l(P))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;b&&(m[t.xsrfHeaderName]=b)}"setRequestHeader"in v&&n.forEach(m,(function(t,e){void 0===p&&"content-type"===e.toLowerCase()?delete m[e]:v.setRequestHeader(e,t)})),n.isUndefined(t.withCredentials)||(v.withCredentials=!!t.withCredentials),f&&"json"!==f&&(v.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&v.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(g=function(t){v&&(i(!t||t&&t.type?new d:t),v.abort(),v=null)},t.cancelToken&&t.cancelToken.subscribe(g),t.signal&&(t.signal.aborted?g():t.signal.addEventListener("abort",g))),p||(p=null);var E=_(P);E&&-1===["http","https","file"].indexOf(E)?i(new c("Unsupported protocol "+E+":",c.ERR_BAD_REQUEST,t)):v.send(p)}))}},61555:(t,e,i)=>{"use strict";var n=i(90501),s=i(82958),o=i(27303),a=i(92445);var r=function t(e){var i=new o(e),r=s(o.prototype.request,i);return n.extend(r,o.prototype,i),n.extend(r,i),r.create=function(i){return t(a(e,i))},r}(i(80746));r.Axios=o,r.CanceledError=i(10235),r.CancelToken=i(89939),r.isCancel=i(18414),r.VERSION=i(82196).version,r.toFormData=i(38428),r.AxiosError=i(35424),r.Cancel=r.CanceledError,r.all=function(t){return Promise.all(t)},r.spread=i(60363),r.isAxiosError=i(69465),t.exports=r,t.exports.default=r},89939:(t,e,i)=>{"use strict";var n=i(10235);function s(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var i=this;this.promise.then((function(t){if(i._listeners){var e,n=i._listeners.length;for(e=0;e<n;e++)i._listeners[e](t);i._listeners=null}})),this.promise.then=function(t){var e,n=new Promise((function(t){i.subscribe(t),e=t})).then(t);return n.cancel=function(){i.unsubscribe(e)},n},t((function(t){i.reason||(i.reason=new n(t),e(i.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},s.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},s.source=function(){var t;return{token:new s((function(e){t=e})),cancel:t}},t.exports=s},10235:(t,e,i)=>{"use strict";var n=i(35424);function s(t){n.call(this,null==t?"canceled":t,n.ERR_CANCELED),this.name="CanceledError"}i(90501).inherits(s,n,{__CANCEL__:!0}),t.exports=s},18414:t=>{"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},27303:(t,e,i)=>{"use strict";var n=i(90501),s=i(44306),o=i(86942),a=i(26158),r=i(92445),h=i(85938),l=i(37169),u=l.validators;function c(t){this.defaults=t,this.interceptors={request:new o,response:new o}}c.prototype.request=function(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},(e=r(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var i=e.transitional;void 0!==i&&l.assertOptions(i,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var n=[],s=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var o,h=[];if(this.interceptors.response.forEach((function(t){h.push(t.fulfilled,t.rejected)})),!s){var c=[a,void 0];for(Array.prototype.unshift.apply(c,n),c=c.concat(h),o=Promise.resolve(e);c.length;)o=o.then(c.shift(),c.shift());return o}for(var d=e;n.length;){var _=n.shift(),g=n.shift();try{d=_(d)}catch(t){g(t);break}}try{o=a(d)}catch(t){return Promise.reject(t)}for(;h.length;)o=o.then(h.shift(),h.shift());return o},c.prototype.getUri=function(t){t=r(this.defaults,t);var e=h(t.baseURL,t.url);return s(e,t.params,t.paramsSerializer)},n.forEach(["delete","get","head","options"],(function(t){c.prototype[t]=function(e,i){return this.request(r(i||{},{method:t,url:e,data:(i||{}).data}))}})),n.forEach(["post","put","patch"],(function(t){function e(e){return function(i,n,s){return this.request(r(s||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:i,data:n}))}}c.prototype[t]=e(),c.prototype[t+"Form"]=e(!0)})),t.exports=c},35424:(t,e,i)=>{"use strict";var n=i(90501);function s(t,e,i,n,s){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),n&&(this.request=n),s&&(this.response=s)}n.inherits(s,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var o=s.prototype,a={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(t){a[t]={value:t}})),Object.defineProperties(s,a),Object.defineProperty(o,"isAxiosError",{value:!0}),s.from=function(t,e,i,a,r,h){var l=Object.create(o);return n.toFlatObject(t,l,(function(t){return t!==Error.prototype})),s.call(l,t.message,e,i,a,r),l.name=t.name,h&&Object.assign(l,h),l},t.exports=s},86942:(t,e,i)=>{"use strict";var n=i(90501);function s(){this.handlers=[]}s.prototype.use=function(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},s.prototype.forEach=function(t){n.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=s},85938:(t,e,i)=>{"use strict";var n=i(63473),s=i(70533);t.exports=function(t,e){return t&&!n(e)?s(t,e):e}},26158:(t,e,i)=>{"use strict";var n=i(90501),s=i(24097),o=i(18414),a=i(80746),r=i(10235);function h(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new r}t.exports=function(t){return h(t),t.headers=t.headers||{},t.data=s.call(t,t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||a.adapter)(t).then((function(e){return h(t),e.data=s.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(h(t),e&&e.response&&(e.response.data=s.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},92445:(t,e,i)=>{"use strict";var n=i(90501);t.exports=function(t,e){e=e||{};var i={};function s(t,e){return n.isPlainObject(t)&&n.isPlainObject(e)?n.merge(t,e):n.isPlainObject(e)?n.merge({},e):n.isArray(e)?e.slice():e}function o(i){return n.isUndefined(e[i])?n.isUndefined(t[i])?void 0:s(void 0,t[i]):s(t[i],e[i])}function a(t){if(!n.isUndefined(e[t]))return s(void 0,e[t])}function r(i){return n.isUndefined(e[i])?n.isUndefined(t[i])?void 0:s(void 0,t[i]):s(void 0,e[i])}function h(i){return i in e?s(t[i],e[i]):i in t?s(void 0,t[i]):void 0}var l={url:a,method:a,data:a,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:h};return n.forEach(Object.keys(t).concat(Object.keys(e)),(function(t){var e=l[t]||o,s=e(t);n.isUndefined(s)&&e!==h||(i[t]=s)})),i}},93063:(t,e,i)=>{"use strict";var n=i(35424);t.exports=function(t,e,i){var s=i.config.validateStatus;i.status&&s&&!s(i.status)?e(new n("Request failed with status code "+i.status,[n.ERR_BAD_REQUEST,n.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):t(i)}},24097:(t,e,i)=>{"use strict";var n=i(90501),s=i(80746);t.exports=function(t,e,i){var o=this||s;return n.forEach(i,(function(i){t=i.call(o,t,e)})),t}},80746:(t,e,i)=>{"use strict";var n=i(13158),s=i(90501),o=i(34799),a=i(35424),r=i(71987),h=i(38428),l={"Content-Type":"application/x-www-form-urlencoded"};function u(t,e){!s.isUndefined(t)&&s.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var c,d={transitional:r,adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==n&&"[object process]"===Object.prototype.toString.call(n))&&(c=i(29685)),c),transformRequest:[function(t,e){if(o(e,"Accept"),o(e,"Content-Type"),s.isFormData(t)||s.isArrayBuffer(t)||s.isBuffer(t)||s.isStream(t)||s.isFile(t)||s.isBlob(t))return t;if(s.isArrayBufferView(t))return t.buffer;if(s.isURLSearchParams(t))return u(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var i,n=s.isObject(t),a=e&&e["Content-Type"];if((i=s.isFileList(t))||n&&"multipart/form-data"===a){var r=this.env&&this.env.FormData;return h(i?{"files[]":t}:t,r&&new r)}return n||"application/json"===a?(u(e,"application/json"),function(t,e,i){if(s.isString(t))try{return(e||JSON.parse)(t),s.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(i||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional||d.transitional,i=e&&e.silentJSONParsing,n=e&&e.forcedJSONParsing,o=!i&&"json"===this.responseType;if(o||n&&s.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(o){if("SyntaxError"===t.name)throw a.from(t,a.ERR_BAD_RESPONSE,this,null,this.response);throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:i(81093)},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};s.forEach(["delete","get","head"],(function(t){d.headers[t]={}})),s.forEach(["post","put","patch"],(function(t){d.headers[t]=s.merge(l)})),t.exports=d},71987:t=>{"use strict";t.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},82196:t=>{t.exports={version:"0.27.2"}},82958:t=>{"use strict";t.exports=function(t,e){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return t.apply(e,i)}}},44306:(t,e,i)=>{"use strict";var n=i(90501);function s(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,i){if(!e)return t;var o;if(i)o=i(e);else if(n.isURLSearchParams(e))o=e.toString();else{var a=[];n.forEach(e,(function(t,e){null!=t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,(function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),a.push(s(e)+"="+s(t))})))})),o=a.join("&")}if(o){var r=t.indexOf("#");-1!==r&&(t=t.slice(0,r)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},70533:t=>{"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},9233:(t,e,i)=>{"use strict";var n=i(90501);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,i,s,o,a){var r=[];r.push(t+"="+encodeURIComponent(e)),n.isNumber(i)&&r.push("expires="+new Date(i).toGMTString()),n.isString(s)&&r.push("path="+s),n.isString(o)&&r.push("domain="+o),!0===a&&r.push("secure"),document.cookie=r.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},63473:t=>{"use strict";t.exports=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}},69465:(t,e,i)=>{"use strict";var n=i(90501);t.exports=function(t){return n.isObject(t)&&!0===t.isAxiosError}},23977:(t,e,i)=>{"use strict";var n=i(90501);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function s(t){var n=t;return e&&(i.setAttribute("href",n),n=i.href),i.setAttribute("href",n),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return t=s(window.location.href),function(e){var i=n.isString(e)?s(e):e;return i.protocol===t.protocol&&i.host===t.host}}():function(){return!0}},34799:(t,e,i)=>{"use strict";var n=i(90501);t.exports=function(t,e){n.forEach(t,(function(i,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[n])}))}},81093:t=>{t.exports=null},12644:(t,e,i)=>{"use strict";var n=i(90501),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,i,o,a={};return t?(n.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=n.trim(t.substr(0,o)).toLowerCase(),i=n.trim(t.substr(o+1)),e){if(a[e]&&s.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([i]):a[e]?a[e]+", "+i:i}})),a):a}},36374:t=>{"use strict";t.exports=function(t){var e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}},60363:t=>{"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},38428:(t,e,i)=>{"use strict";var n=i(75291).lW,s=i(90501);t.exports=function(t,e){e=e||new FormData;var i=[];function o(t){return null===t?"":s.isDate(t)?t.toISOString():s.isArrayBuffer(t)||s.isTypedArray(t)?"function"==typeof Blob?new Blob([t]):n.from(t):t}return function t(n,a){if(s.isPlainObject(n)||s.isArray(n)){if(-1!==i.indexOf(n))throw Error("Circular reference detected in "+a);i.push(n),s.forEach(n,(function(i,n){if(!s.isUndefined(i)){var r,h=a?a+"."+n:n;if(i&&!a&&"object"==typeof i)if(s.endsWith(n,"{}"))i=JSON.stringify(i);else if(s.endsWith(n,"[]")&&(r=s.toArray(i)))return void r.forEach((function(t){!s.isUndefined(t)&&e.append(h,o(t))}));t(i,h)}})),i.pop()}else e.append(a,o(n))}(t),e}},37169:(t,e,i)=>{"use strict";var n=i(82196).version,s=i(35424),o={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){o[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}}));var a={};o.transitional=function(t,e,i){function o(t,e){return"[Axios v"+n+"] Transitional option '"+t+"'"+e+(i?". "+i:"")}return function(i,n,r){if(!1===t)throw new s(o(n," has been removed"+(e?" in "+e:"")),s.ERR_DEPRECATED);return e&&!a[n]&&(a[n]=!0,console.warn(o(n," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(i,n,r)}},t.exports={assertOptions:function(t,e,i){if("object"!=typeof t)throw new s("options must be an object",s.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(t),o=n.length;o-- >0;){var a=n[o],r=e[a];if(r){var h=t[a],l=void 0===h||r(h,a,t);if(!0!==l)throw new s("option "+a+" must be "+l,s.ERR_BAD_OPTION_VALUE)}else if(!0!==i)throw new s("Unknown option "+a,s.ERR_BAD_OPTION)}},validators:o}},90501:(t,e,i)=>{"use strict";var n,s=i(82958),o=Object.prototype.toString,a=(n=Object.create(null),function(t){var e=o.call(t);return n[e]||(n[e]=e.slice(8,-1).toLowerCase())});function r(t){return t=t.toLowerCase(),function(e){return a(e)===t}}function h(t){return Array.isArray(t)}function l(t){return void 0===t}var u=r("ArrayBuffer");function c(t){return null!==t&&"object"==typeof t}function d(t){if("object"!==a(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}var _=r("Date"),g=r("File"),p=r("Blob"),m=r("FileList");function f(t){return"[object Function]"===o.call(t)}var A=r("URLSearchParams");function v(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),h(t))for(var i=0,n=t.length;i<n;i++)e.call(null,t[i],i,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}var T,y=(T="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(t){return T&&t instanceof T});t.exports={isArray:h,isArrayBuffer:u,isBuffer:function(t){return null!==t&&!l(t)&&null!==t.constructor&&!l(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){var e="[object FormData]";return t&&("function"==typeof FormData&&t instanceof FormData||o.call(t)===e||f(t.toString)&&t.toString()===e)},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&u(t.buffer)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:c,isPlainObject:d,isUndefined:l,isDate:_,isFile:g,isBlob:p,isFunction:f,isStream:function(t){return c(t)&&f(t.pipe)},isURLSearchParams:A,isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:v,merge:function t(){var e={};function i(i,n){d(e[n])&&d(i)?e[n]=t(e[n],i):d(i)?e[n]=t({},i):h(i)?e[n]=i.slice():e[n]=i}for(var n=0,s=arguments.length;n<s;n++)v(arguments[n],i);return e},extend:function(t,e,i){return v(e,(function(e,n){t[n]=i&&"function"==typeof e?s(e,i):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t},inherits:function(t,e,i,n){t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,i&&Object.assign(t.prototype,i)},toFlatObject:function(t,e,i){var n,s,o,a={};e=e||{};do{for(s=(n=Object.getOwnPropertyNames(t)).length;s-- >0;)a[o=n[s]]||(e[o]=t[o],a[o]=!0);t=Object.getPrototypeOf(t)}while(t&&(!i||i(t,e))&&t!==Object.prototype);return e},kindOf:a,kindOfTest:r,endsWith:function(t,e,i){t=String(t),(void 0===i||i>t.length)&&(i=t.length),i-=e.length;var n=t.indexOf(e,i);return-1!==n&&n===i},toArray:function(t){if(!t)return null;var e=t.length;if(l(e))return null;for(var i=new Array(e);e-- >0;)i[e]=t[e];return i},isTypedArray:y,isFileList:m}},39200:(t,e,i)=>{t.exports=i(62749)},14228:(t,e,i)=>{t.exports=i(78726)},60559:(t,e,i)=>{t.exports=i(62033)},92714:(t,e,i)=>{t.exports=i(71232)},34848:(t,e,i)=>{t.exports=i(44585)},32967:(t,e,i)=>{t.exports=i(21075)},76900:(t,e,i)=>{t.exports=i(77572)},12193:(t,e,i)=>{t.exports=i(67314)},3852:(t,e,i)=>{t.exports=i(83497)},58293:(t,e,i)=>{t.exports=i(26202)},5134:(t,e,i)=>{t.exports=i(69238)},40698:(t,e,i)=>{t.exports=i(79937)},81701:(t,e,i)=>{t.exports=i(64263)},92941:(t,e,i)=>{t.exports=i(5832)},59880:(t,e,i)=>{t.exports=i(54023)},9010:(t,e,i)=>{t.exports=i(11294)},91267:(t,e,i)=>{t.exports=i(20627)},94825:(t,e,i)=>{t.exports=i(99378)},32735:(t,e,i)=>{t.exports=i(66457)},93120:(t,e,i)=>{t.exports=i(63156)},29743:(t,e,i)=>{t.exports=i(43014)},29013:(t,e,i)=>{t.exports=i(91160)},82165:(t,e,i)=>{t.exports=i(57954)},98174:(t,e,i)=>{t.exports=i(88660)},29911:(t,e,i)=>{t.exports=i(32952)},70776:(t,e,i)=>{t.exports=i(81467)},85016:(t,e,i)=>{t.exports=i(67581)},24806:(t,e,i)=>{t.exports=i(69276)},57533:(t,e,i)=>{t.exports=i(68982)},10558:(t,e,i)=>{t.exports=i(94541)},76875:(t,e,i)=>{t.exports=i(43180)},60606:(t,e,i)=>{t.exports=i(22130)},41461:(t,e,i)=>{t.exports=i(71686)},15507:(t,e,i)=>{t.exports=i(15589)},55799:(t,e,i)=>{t.exports=i(24222)},42219:(t,e,i)=>{t.exports=i(40166)},35004:(t,e,i)=>{t.exports=i(65823)},11143:(t,e,i)=>{t.exports=i(45046)},81281:(t,e,i)=>{t.exports=i(78462)},68702:(t,e,i)=>{t.exports=i(63585)},57046:(t,e,i)=>{t.exports=i(43575)},14461:(t,e,i)=>{t.exports=i(17403)},4539:(t,e,i)=>{t.exports=i(615)},62359:(t,e,i)=>{t.exports=i(9821)},39133:(t,e,i)=>{t.exports=i(2989)},47898:(t,e,i)=>{t.exports=i(84089)},62037:(t,e,i)=>{t.exports=i(49423)},46248:(t,e,i)=>{t.exports=i(42678)},9533:(t,e,i)=>{t.exports=i(88148)},72296:(t,e,i)=>{t.exports=i(5591)},40425:(t,e,i)=>{t.exports=i(4100)},41843:(t,e,i)=>{"use strict";i.d(e,{Z:()=>l});var n=i(47898),s=i(40425),o=i(62037),a=i(46248),r=i(9533),h=i(72296);function l(t,e,i,l,u){var c,d,_,g={};return n(c=s(l)).call(c,(function(t){g[t]=l[t]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=o(d=a(_=r(i).call(i)).call(_)).call(d,(function(i,n){return n(t,e,i)||i}),g),u&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(u):void 0,g.initializer=void 0),void 0===g.initializer&&(h(t,e,g),g=null),g}},94043:(t,e,i)=>{"use strict";function n(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}i.d(e,{Z:()=>n})},77328:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=0;function s(t){return"__private_"+n+++"_"+t}},93213:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(72296);function s(t,e,i){return e in t?n(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},60456:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});var n=i(72296);function s(t,e,i,s){i&&n(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(s):void 0})}},72544:(t,e,i)=>{"use strict";i.d(e,{O:()=>n});class n{constructor(){this.hoverCursor="",this.actions=new Array,this.isRecursive=!1}static get HasTriggers(){for(const t in n.Triggers)if(Object.prototype.hasOwnProperty.call(n.Triggers,t))return!0;return!1}static get HasPickTriggers(){for(const t in n.Triggers)if(Object.prototype.hasOwnProperty.call(n.Triggers,t)){const e=parseInt(t);if(e>=1&&e<=7)return!0}return!1}static HasSpecificTrigger(t){for(const e in n.Triggers)if(Object.prototype.hasOwnProperty.call(n.Triggers,e)){if(parseInt(e)===t)return!0}return!1}}n.Triggers={}},85362:(t,e,i)=>{"use strict";i.d(e,{a:()=>r});var n=i(62897),s=i(58095),o=i(15631),a=i(48620);class r{constructor(t,e){this.triggerOptions=t,this.onBeforeExecuteObservable=new n.y$,t.parameter?(this.trigger=t.trigger,this._triggerParameter=t.parameter):t.trigger?this.trigger=t.trigger:this.trigger=t,this._nextActiveAction=this,this._condition=e}_prepare(){}getTriggerParameter(){return this._triggerParameter}setTriggerParameter(t){this._triggerParameter=t}_evaluateConditionForCurrentFrame(){const t=this._condition;if(!t)return!0;const e=this._actionManager.getScene().getRenderId();return t._evaluationId!==e&&(t._evaluationId=e,t._currentResult=t.isValid()),t._currentResult}_executeCurrent(t){this._evaluateConditionForCurrentFrame()&&(this.onBeforeExecuteObservable.notifyObservers(this),this._nextActiveAction.execute(t),this.skipToNextActiveAction())}execute(t){}skipToNextActiveAction(){this._nextActiveAction._child?(this._nextActiveAction._child._actionManager||(this._nextActiveAction._child._actionManager=this._actionManager),this._nextActiveAction=this._nextActiveAction._child):this._nextActiveAction=this}then(t){return this._child=t,t._actionManager=this._actionManager,t._prepare(),t}_getProperty(t){return this._actionManager._getProperty(t)}_getEffectiveTarget(t,e){return this._actionManager._getEffectiveTarget(t,e)}serialize(t){}_serialize(t,e){const i={type:1,children:[],name:t.name,properties:t.properties||[]};if(this._child&&this._child.serialize(i),this._condition){const t=this._condition.serialize();return t.children.push(i),e&&e.children.push(t),t}return e&&e.children.push(i),i}}r._SerializeValueAsString=t=>"number"==typeof t?t.toString():"boolean"==typeof t?t?"true":"false":t instanceof s.FM?t.x+", "+t.y:t instanceof s.P?t.x+", "+t.y+", "+t.z:t instanceof o.Wo?t.r+", "+t.g+", "+t.b:t instanceof o.HE?t.r+", "+t.g+", "+t.b+", "+t.a:t,r._GetTargetProperty=t=>({name:"target",targetType:t._isMesh?"MeshProperties":t._isLight?"LightProperties":t._isCamera?"CameraProperties":t._isMaterial?"MaterialProperties":"SceneProperties",value:t._isScene?"Scene":t.name}),(0,a.H)("BABYLON.Action",r)},23954:(t,e,i)=>{"use strict";i.d(e,{V:()=>n});class n{constructor(t,e,i,n,s,o){this.source=t,this.pointerX=e,this.pointerY=i,this.meshUnderPointer=n,this.sourceEvent=s,this.additionalData=o}static CreateNew(t,e,i){const s=t.getScene();return new n(t,s.pointerX,s.pointerY,s.meshUnderPointer||t,e,i)}static CreateNewFromSprite(t,e,i,s){return new n(t,e.pointerX,e.pointerY,e.meshUnderPointer,i,s)}static CreateNewFromScene(t,e){return new n(null,t.pointerX,t.pointerY,t.meshUnderPointer,e)}static CreateNewFromPrimitive(t,e,i,s){return new n(t,e.x,e.y,null,i,s)}}},85619:(t,e,i)=>{"use strict";i.d(e,{k:()=>_});var n=i(58095),s=i(15631),o=i(96131),a=i(85362),r=i(31919),h=i(15210),l=i(84318),u=i(1101),c=i(48620),d=i(72544);class _ extends d.O{constructor(t){super(),(t=t||h.l.LastCreatedScene)&&(this._scene=t,t.actionManagers.push(this))}dispose(){const t=this._scene.actionManagers.indexOf(this);for(let t=0;t<this.actions.length;t++){const e=this.actions[t];_.Triggers[e.trigger]--,0===_.Triggers[e.trigger]&&delete _.Triggers[e.trigger]}t>-1&&this._scene.actionManagers.splice(t,1)}getScene(){return this._scene}hasSpecificTriggers(t){for(let e=0;e<this.actions.length;e++){const i=this.actions[e];if(t.indexOf(i.trigger)>-1)return!0}return!1}hasSpecificTriggers2(t,e){for(let i=0;i<this.actions.length;i++){const n=this.actions[i];if(t==n.trigger||e==n.trigger)return!0}return!1}hasSpecificTrigger(t,e){for(let i=0;i<this.actions.length;i++){const n=this.actions[i];if(n.trigger===t){if(!e)return!0;if(e(n.getTriggerParameter()))return!0}}return!1}get hasPointerTriggers(){for(let t=0;t<this.actions.length;t++){const e=this.actions[t];if(e.trigger>=_.OnPickTrigger&&e.trigger<=_.OnPointerOutTrigger)return!0}return!1}get hasPickTriggers(){for(let t=0;t<this.actions.length;t++){const e=this.actions[t];if(e.trigger>=_.OnPickTrigger&&e.trigger<=_.OnPickUpTrigger)return!0}return!1}registerAction(t){return t.trigger===_.OnEveryFrameTrigger&&this.getScene().actionManager!==this?(l.Y.Warn("OnEveryFrameTrigger can only be used with scene.actionManager"),null):(this.actions.push(t),this.getScene()._registeredActions++,_.Triggers[t.trigger]?_.Triggers[t.trigger]++:_.Triggers[t.trigger]=1,t._actionManager=this,t._prepare(),t)}unregisterAction(t){const e=this.actions.indexOf(t);return-1!==e&&(this.actions.splice(e,1),_.Triggers[t.trigger]-=1,0===_.Triggers[t.trigger]&&delete _.Triggers[t.trigger],t._actionManager=null,this.getScene()._registeredActions--,!0)}processTrigger(t,e){for(let i=0;i<this.actions.length;i++){const n=this.actions[i];if(n.trigger===t){if(e&&(t===_.OnKeyUpTrigger||t===_.OnKeyDownTrigger)){const t=n.getTriggerParameter();if("function"==typeof t){if(!t(e))continue}else if(t&&t!==e.sourceEvent.keyCode){if(!t.toLowerCase)continue;const i=t.toLowerCase();if(i!==e.sourceEvent.key){const t=e.sourceEvent.charCode?e.sourceEvent.charCode:e.sourceEvent.keyCode;if(String.fromCharCode(t).toLowerCase()!==i)continue}}}n._executeCurrent(e)}}}_getEffectiveTarget(t,e){const i=e.split(".");for(let e=0;e<i.length-1;e++)t=t[i[e]];return t}_getProperty(t){const e=t.split(".");return e[e.length-1]}serialize(t){const e={children:new Array,name:t,type:3,properties:new Array};for(let t=0;t<this.actions.length;t++){const i={type:0,children:new Array,name:_.GetTriggerName(this.actions[t].trigger),properties:new Array},n=this.actions[t].triggerOptions;if(n&&"number"!=typeof n)if(n.parameter instanceof Node)i.properties.push(a.a._GetTargetProperty(n.parameter));else if("object"==typeof n.parameter){const t={};u.j.DeepCopy(n.parameter,t,["mesh"]),n.parameter&&n.parameter.mesh&&(t._meshId=n.parameter.mesh.id),i.properties.push({name:"parameter",targetType:null,value:t})}else i.properties.push({name:"parameter",targetType:null,value:n.parameter});this.actions[t].serialize(i),e.children.push(i)}return e}static Parse(t,e,i){const a=new _(i);null===e?i.actionManager=a:e.actionManager=a;const h=(t,e,i,o)=>{if(null===o){const t=parseFloat(e);return"true"===e||"false"===e?"true"===e:isNaN(t)?e:t}const a=o.split("."),r=e.split(",");for(let t=0;t<a.length;t++)i=i[a[t]];if("boolean"==typeof i)return"true"===r[0];if("string"==typeof i)return r[0];const h=new Array;for(let t=0;t<r.length;t++)h.push(parseFloat(r[t]));return i instanceof n.P?n.P.FromArray(h):i instanceof n.Lt?n.Lt.FromArray(h):i instanceof s.Wo?s.Wo.FromArray(h):i instanceof s.HE?s.HE.FromArray(h):parseFloat(r[0])},l=(t,e,n,s,u=null)=>{if(t.detached)return;const d=new Array;let g=null,p=null;const m=t.combine&&t.combine.length>0;if(2===t.type?d.push(a):d.push(e),m){const e=new Array;for(let i=0;i<t.combine.length;i++)l(t.combine[i],_.NothingTrigger,n,s,e);d.push(e)}else for(let e=0;e<t.properties.length;e++){let n=t.properties[e].value;const s=t.properties[e].name,a=t.properties[e].targetType;"target"===s?n=g="SceneProperties"===a?i:"MaterialProperties"===a?i.getMaterialByName(n):i.getNodeByName(n):"parent"===s?n=i.getNodeByName(n):"sound"===s?i.getSoundByName&&(n=i.getSoundByName(n)):"propertyPath"!==s?n=2===t.type&&"operator"===s?o.Uf[n]:h(0,n,g,"value"===s?p:null):p=n,d.push(n)}if(null===u?d.push(n):d.push(null),"InterpolateValueAction"===t.name){const t=d[d.length-2];d[d.length-1]=t,d[d.length-2]=n}let f=((t,e)=>{const i=(0,c.q)("BABYLON."+t);return i&&new i(...e)})(t.name,d);if(f instanceof o.gP&&null!==n){const t=new r.TC(e,n);s?s.then(t):a.registerAction(t),s=t}null===u?f instanceof o.gP?(n=f,f=s):(n=null,s?s.then(f):a.registerAction(f)):u.push(f);for(let i=0;i<t.children.length;i++)l(t.children[i],e,n,f,null)};for(let e=0;e<t.children.length;e++){let n;const s=t.children[e];if(s.properties.length>0){const t=s.properties[0].value,e=null===s.properties[0].targetType?t:i.getMeshByName(t);e._meshId&&(e.mesh=i.getMeshById(e._meshId)),n={trigger:_[s.name],parameter:e}}else n=_[s.name];for(let t=0;t<s.children.length;t++)s.detached||l(s.children[t],n,null,null)}}static GetTriggerName(t){switch(t){case 0:return"NothingTrigger";case 1:return"OnPickTrigger";case 2:return"OnLeftPickTrigger";case 3:return"OnRightPickTrigger";case 4:return"OnCenterPickTrigger";case 5:return"OnPickDownTrigger";case 6:return"OnDoublePickTrigger";case 7:return"OnPickUpTrigger";case 8:return"OnLongPressTrigger";case 9:return"OnPointerOverTrigger";case 10:return"OnPointerOutTrigger";case 11:return"OnEveryFrameTrigger";case 12:return"OnIntersectionEnterTrigger";case 13:return"OnIntersectionExitTrigger";case 14:return"OnKeyDownTrigger";case 15:return"OnKeyUpTrigger";case 16:return"OnPickOutTrigger";default:return""}}}_.NothingTrigger=0,_.OnPickTrigger=1,_.OnLeftPickTrigger=2,_.OnRightPickTrigger=3,_.OnCenterPickTrigger=4,_.OnPickDownTrigger=5,_.OnDoublePickTrigger=6,_.OnPickUpTrigger=7,_.OnPickOutTrigger=16,_.OnLongPressTrigger=8,_.OnPointerOverTrigger=9,_.OnPointerOutTrigger=10,_.OnEveryFrameTrigger=11,_.OnIntersectionEnterTrigger=12,_.OnIntersectionExitTrigger=13,_.OnKeyDownTrigger=14,_.OnKeyUpTrigger=15},96131:(t,e,i)=>{"use strict";i.d(e,{Uf:()=>a,gP:()=>o});var n=i(85362),s=i(48620);class o{constructor(t){this._actionManager=t}isValid(){return!0}_getProperty(t){return this._actionManager._getProperty(t)}_getEffectiveTarget(t,e){return this._actionManager._getEffectiveTarget(t,e)}serialize(){}_serialize(t){return{type:2,children:[],name:t.name,properties:t.properties}}}class a extends o{static get IsEqual(){return a._IsEqual}static get IsDifferent(){return a._IsDifferent}static get IsGreater(){return a._IsGreater}static get IsLesser(){return a._IsLesser}constructor(t,e,i,n,s=a.IsEqual){super(t),this.propertyPath=i,this.value=n,this.operator=s,this._target=e,this._effectiveTarget=this._getEffectiveTarget(e,this.propertyPath),this._property=this._getProperty(this.propertyPath)}isValid(){switch(this.operator){case a.IsGreater:return this._effectiveTarget[this._property]>this.value;case a.IsLesser:return this._effectiveTarget[this._property]<this.value;case a.IsEqual:case a.IsDifferent:{let t;return t=this.value.equals?this.value.equals(this._effectiveTarget[this._property]):this.value===this._effectiveTarget[this._property],this.operator===a.IsEqual?t:!t}}return!1}serialize(){return this._serialize({name:"ValueCondition",properties:[n.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:n.a._SerializeValueAsString(this.value)},{name:"operator",value:a.GetOperatorName(this.operator)}]})}static GetOperatorName(t){switch(t){case a._IsEqual:return"IsEqual";case a._IsDifferent:return"IsDifferent";case a._IsGreater:return"IsGreater";case a._IsLesser:return"IsLesser";default:return""}}}a._IsEqual=0,a._IsDifferent=1,a._IsGreater=2,a._IsLesser=3;(0,s.H)("BABYLON.ValueCondition",a),(0,s.H)("BABYLON.PredicateCondition",class extends o{constructor(t,e){super(t),this.predicate=e}isValid(){return this.predicate()}}),(0,s.H)("BABYLON.StateCondition",class extends o{constructor(t,e,i){super(t),this.value=i,this._target=e}isValid(){return this._target.state===this.value}serialize(){return this._serialize({name:"StateCondition",properties:[n.a._GetTargetProperty(this._target),{name:"value",value:this.value}]})}})},31919:(t,e,i)=>{"use strict";i.d(e,{TC:()=>_,fQ:()=>p});var n=i(84318),s=i(58095),o=i(85362),a=i(48620);class r extends o.a{constructor(t,e,i,n){super(t,n),this.propertyPath=i,this._target=this._effectiveTarget=e}_prepare(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)}execute(){this._effectiveTarget[this._property]=!this._effectiveTarget[this._property]}serialize(t){return super._serialize({name:"SwitchBooleanAction",properties:[o.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath}]},t)}}class h extends o.a{constructor(t,e,i,n){super(t,n),this.value=i,this._target=e}execute(){this._target.state=this.value}serialize(t){return super._serialize({name:"SetStateAction",properties:[o.a._GetTargetProperty(this._target),{name:"value",value:this.value}]},t)}}class l extends o.a{constructor(t,e,i,n,s){super(t,s),this.propertyPath=i,this.value=n,this._target=this._effectiveTarget=e}_prepare(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)}execute(){this._effectiveTarget[this._property]=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)}serialize(t){return super._serialize({name:"SetValueAction",properties:[o.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:o.a._SerializeValueAsString(this.value)}]},t)}}class u extends o.a{constructor(t,e,i,n,s){super(t,s),this.propertyPath=i,this.value=n,this._target=this._effectiveTarget=e}_prepare(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath),"number"!=typeof this._effectiveTarget[this._property]&&n.Y.Warn("Warning: IncrementValueAction can only be used with number values")}execute(){this._effectiveTarget[this._property]+=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)}serialize(t){return super._serialize({name:"IncrementValueAction",properties:[o.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:o.a._SerializeValueAsString(this.value)}]},t)}}class c extends o.a{constructor(t,e,i,n,s,o){super(t,o),this.from=i,this.to=n,this.loop=s,this._target=e}_prepare(){}execute(){this._actionManager.getScene().beginAnimation(this._target,this.from,this.to,this.loop)}serialize(t){return super._serialize({name:"PlayAnimationAction",properties:[o.a._GetTargetProperty(this._target),{name:"from",value:String(this.from)},{name:"to",value:String(this.to)},{name:"loop",value:o.a._SerializeValueAsString(this.loop)||!1}]},t)}}class d extends o.a{constructor(t,e,i){super(t,i),this._target=e}_prepare(){}execute(){this._actionManager.getScene().stopAnimation(this._target)}serialize(t){return super._serialize({name:"StopAnimationAction",properties:[o.a._GetTargetProperty(this._target)]},t)}}class _ extends o.a{constructor(t=0,e){super(t,e)}execute(){}serialize(t){return super._serialize({name:"DoNothingAction",properties:[]},t)}}class g extends o.a{constructor(t,e,i,n=!0){super(t,i),this.children=e,this.enableChildrenConditions=n}_prepare(){for(let t=0;t<this.children.length;t++)this.children[t]._actionManager=this._actionManager,this.children[t]._prepare()}execute(t){for(const e of this.children)this.enableChildrenConditions&&!e._evaluateConditionForCurrentFrame()||e.execute(t)}serialize(t){const e=super._serialize({name:"CombineAction",properties:[],combine:[]},t);for(let t=0;t<this.children.length;t++)e.combine.push(this.children[t].serialize(null));return e}}class p extends o.a{constructor(t,e,i){super(t,i),this.func=e}execute(t){this.func(t)}}class m extends o.a{constructor(t,e,i,n){super(t,n),this._target=e,this._parent=i}_prepare(){}execute(){if(this._target.parent===this._parent)return;const t=this._parent.getWorldMatrix().clone();t.invert(),this._target.position=s.P.TransformCoordinates(this._target.position,t),this._target.parent=this._parent}serialize(t){return super._serialize({name:"SetParentAction",properties:[o.a._GetTargetProperty(this._target),o.a._GetTargetProperty(this._parent)]},t)}}(0,a.H)("BABYLON.SetParentAction",m),(0,a.H)("BABYLON.ExecuteCodeAction",p),(0,a.H)("BABYLON.DoNothingAction",_),(0,a.H)("BABYLON.StopAnimationAction",d),(0,a.H)("BABYLON.PlayAnimationAction",c),(0,a.H)("BABYLON.IncrementValueAction",u),(0,a.H)("BABYLON.SetValueAction",l),(0,a.H)("BABYLON.SetStateAction",h),(0,a.H)("BABYLON.SetParentAction",m),(0,a.H)("BABYLON.SwitchBooleanAction",r),(0,a.H)("BABYLON.CombineAction",g)},58873:(t,e,i)=>{"use strict";i(72544);var n=i(85362),s=(i(23954),i(85619),i(96131),i(31919),i(48620));class o extends n.a{constructor(t,e,i){super(t,i),this._sound=e}_prepare(){}execute(){void 0!==this._sound&&this._sound.play()}serialize(t){return super._serialize({name:"PlaySoundAction",properties:[{name:"sound",value:this._sound.name}]},t)}}class a extends n.a{constructor(t,e,i){super(t,i),this._sound=e}_prepare(){}execute(){void 0!==this._sound&&this._sound.stop()}serialize(t){return super._serialize({name:"StopSoundAction",properties:[{name:"sound",value:this._sound.name}]},t)}}(0,s.H)("BABYLON.PlaySoundAction",o),(0,s.H)("BABYLON.StopSoundAction",a);var r=i(84318),h=i(62897),l=i(15631),u=i(58095),c=i(18770);class d extends n.a{constructor(t,e,i,n,s=1e3,o,a,r){super(t,o),this.duration=1e3,this.onInterpolationDoneObservable=new h.y$,this.propertyPath=i,this.value=n,this.duration=s,this.stopOtherAnimations=a,this.onInterpolationDone=r,this._target=this._effectiveTarget=e}_prepare(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)}execute(){const t=this._actionManager.getScene(),e=[{frame:0,value:this._effectiveTarget[this._property]},{frame:100,value:this.value}];let i;if("number"==typeof this.value)i=c.f.ANIMATIONTYPE_FLOAT;else if(this.value instanceof l.Wo)i=c.f.ANIMATIONTYPE_COLOR3;else if(this.value instanceof u.P)i=c.f.ANIMATIONTYPE_VECTOR3;else if(this.value instanceof u.y3)i=c.f.ANIMATIONTYPE_MATRIX;else{if(!(this.value instanceof u._f))return void r.Y.Warn("InterpolateValueAction: Unsupported type ("+typeof this.value+")");i=c.f.ANIMATIONTYPE_QUATERNION}const n=new c.f("InterpolateValueAction",this._property,1e3/this.duration*100,i,c.f.ANIMATIONLOOPMODE_CONSTANT);n.setKeys(e),this.stopOtherAnimations&&t.stopAnimation(this._effectiveTarget);t.beginDirectAnimation(this._effectiveTarget,[n],0,100,!1,1,(()=>{this.onInterpolationDoneObservable.notifyObservers(this),this.onInterpolationDone&&this.onInterpolationDone()}))}serialize(t){return super._serialize({name:"InterpolateValueAction",properties:[n.a._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:n.a._SerializeValueAsString(this.value)},{name:"duration",value:n.a._SerializeValueAsString(this.duration)},{name:"stopOtherAnimations",value:n.a._SerializeValueAsString(this.stopOtherAnimations)||!1}]},t)}}(0,s.H)("BABYLON.InterpolateValueAction",d)},83534:(t,e,i)=>{"use strict";i.d(e,{H:()=>u});var n=i(18770),s=i(65174),o=i(62897),a=i(65273),r=i(58095),h=i(29945),l=i(48017);class u{get syncRoot(){return this._syncRoot}get masterFrame(){return 0===this._runtimeAnimations.length?0:this._runtimeAnimations[0].currentFrame}get weight(){return this._weight}set weight(t){this._weight=-1!==t?Math.min(Math.max(t,0),1):-1}get speedRatio(){return this._speedRatio}set speedRatio(t){for(let e=0;e<this._runtimeAnimations.length;e++){this._runtimeAnimations[e]._prepareForSpeedRatioChange(t)}this._speedRatio=t,null!==this._goToFrame&&this.goToFrame(this._goToFrame)}constructor(t,e,i=0,n=100,s=!1,a=1,r,h,l,u=!1){this.target=e,this.fromFrame=i,this.toFrame=n,this.loopAnimation=s,this.onAnimationEnd=r,this.onAnimationLoop=l,this.isAdditive=u,this._localDelayOffset=null,this._pausedDelay=null,this._manualJumpDelay=null,this._runtimeAnimations=new Array,this._paused=!1,this._speedRatio=1,this._weight=-1,this._syncRoot=null,this._frameToSyncFromJump=null,this._goToFrame=null,this.disposeOnEnd=!0,this.animationStarted=!1,this.onAnimationEndObservable=new o.y$,this.onAnimationLoopObservable=new o.y$,this._scene=t,h&&this.appendAnimations(e,h),this._speedRatio=a,t._activeAnimatables.push(this)}syncWith(t){if(this._syncRoot=t,t){const t=this._scene._activeAnimatables.indexOf(this);t>-1&&(this._scene._activeAnimatables.splice(t,1),this._scene._activeAnimatables.push(this))}return this}getAnimations(){return this._runtimeAnimations}appendAnimations(t,e){for(let i=0;i<e.length;i++){const n=e[i],o=new s.o(t,n,this._scene,this);o._onLoop=()=>{this.onAnimationLoopObservable.notifyObservers(this),this.onAnimationLoop&&this.onAnimationLoop()},this._runtimeAnimations.push(o)}}getAnimationByTargetProperty(t){const e=this._runtimeAnimations;for(let i=0;i<e.length;i++)if(e[i].animation.targetProperty===t)return e[i].animation;return null}getRuntimeAnimationByTargetProperty(t){const e=this._runtimeAnimations;for(let i=0;i<e.length;i++)if(e[i].animation.targetProperty===t)return e[i];return null}reset(){const t=this._runtimeAnimations;for(let e=0;e<t.length;e++)t[e].reset(!0);this._localDelayOffset=null,this._pausedDelay=null}enableBlending(t){const e=this._runtimeAnimations;for(let i=0;i<e.length;i++)e[i].animation.enableBlending=!0,e[i].animation.blendingSpeed=t}disableBlending(){const t=this._runtimeAnimations;for(let e=0;e<t.length;e++)t[e].animation.enableBlending=!1}goToFrame(t){var e;const i=this._runtimeAnimations;if(i[0]){const n=i[0].animation.framePerSecond;this._frameToSyncFromJump=null!==(e=this._frameToSyncFromJump)&&void 0!==e?e:i[0].currentFrame;const s=0===this.speedRatio?0:(t-this._frameToSyncFromJump)/n*1e3/this.speedRatio;this._manualJumpDelay=-s}for(let e=0;e<i.length;e++)i[e].goToFrame(t);this._goToFrame=t}pause(){this._paused||(this._paused=!0)}restart(){this._paused=!1}_raiseOnAnimationEnd(){this.onAnimationEnd&&this.onAnimationEnd(),this.onAnimationEndObservable.notifyObservers(this)}stop(t,e){if(t||e){const i=this._scene._activeAnimatables.indexOf(this);if(i>-1){const n=this._runtimeAnimations;for(let i=n.length-1;i>=0;i--){const s=n[i];t&&s.animation.name!=t||(e&&!e(s.target)||(s.dispose(),n.splice(i,1)))}0==n.length&&(this._scene._activeAnimatables.splice(i,1),this._raiseOnAnimationEnd())}}else{const t=this._scene._activeAnimatables.indexOf(this);if(t>-1){this._scene._activeAnimatables.splice(t,1);const e=this._runtimeAnimations;for(let t=0;t<e.length;t++)e[t].dispose();this._raiseOnAnimationEnd()}}}waitAsync(){return new Promise((t=>{this.onAnimationEndObservable.add((()=>{t(this)}),void 0,void 0,this,!0)}))}_animate(t){if(this._paused)return this.animationStarted=!1,null===this._pausedDelay&&(this._pausedDelay=t),!0;if(null===this._localDelayOffset?(this._localDelayOffset=t,this._pausedDelay=null):null!==this._pausedDelay&&(this._localDelayOffset+=t-this._pausedDelay,this._pausedDelay=null),null!==this._manualJumpDelay&&(this._localDelayOffset+=this._manualJumpDelay,this._manualJumpDelay=null,this._frameToSyncFromJump=null),this._goToFrame=null,0===this._weight)return!0;let e=!1;const i=this._runtimeAnimations;let n;for(n=0;n<i.length;n++){const s=i[n].animate(t-this._localDelayOffset,this.fromFrame,this.toFrame,this.loopAnimation,this._speedRatio,this._weight);e=e||s}if(this.animationStarted=e,!e){if(this.disposeOnEnd)for(n=this._scene._activeAnimatables.indexOf(this),this._scene._activeAnimatables.splice(n,1),n=0;n<i.length;n++)i[n].dispose();this._raiseOnAnimationEnd(),this.disposeOnEnd&&(this.onAnimationEnd=null,this.onAnimationLoop=null,this.onAnimationLoopObservable.clear(),this.onAnimationEndObservable.clear())}return e}}a.x.prototype._animate=function(){if(!this.animationsEnabled)return;const t=h.F.Now;if(!this._animationTimeLast){if(this._pendingData.length>0)return;this._animationTimeLast=t}this.deltaTime=this.useConstantAnimationDeltaTime?16:(t-this._animationTimeLast)*this.animationTimeScale,this._animationTimeLast=t;const e=this._activeAnimatables;if(0===e.length)return;this._animationTime+=this.deltaTime;const i=this._animationTime;for(let t=0;t<e.length;t++){const n=e[t];!n._animate(i)&&n.disposeOnEnd&&t--}this._processLateAnimationBindings()},a.x.prototype.beginWeightedAnimation=function(t,e,i,n=1,s,o=1,a,r,h,l,u=!1){const c=this.beginAnimation(t,e,i,s,o,a,r,!1,h,l,u);return c.weight=n,c},a.x.prototype.beginAnimation=function(t,e,i,n,s=1,o,a,r=!0,h,l,c=!1){e>i&&s>0&&(s*=-1),r&&this.stopAnimation(t,void 0,h),a||(a=new u(this,t,e,i,n,s,o,void 0,l,c));const d=!h||h(t);if(t.animations&&d&&a.appendAnimations(t,t.animations),t.getAnimatables){const u=t.getAnimatables();for(let t=0;t<u.length;t++)this.beginAnimation(u[t],e,i,n,s,o,a,r,h,l)}return a.reset(),a},a.x.prototype.beginHierarchyAnimation=function(t,e,i,n,s,o=1,a,r,h=!0,l,u,c=!1){const d=t.getDescendants(e),_=[];_.push(this.beginAnimation(t,i,n,s,o,a,r,h,l,void 0,c));for(const t of d)_.push(this.beginAnimation(t,i,n,s,o,a,r,h,l,void 0,c));return _},a.x.prototype.beginDirectAnimation=function(t,e,i,n,s,o,a,r,h=!1){if(void 0===o&&(o=1),i>n&&o>0)o*=-1;else if(n>i&&o<0){const t=n;n=i,i=t}return new u(this,t,i,n,s,o,a,e,r,h)},a.x.prototype.beginDirectHierarchyAnimation=function(t,e,i,n,s,o,a,r,h,l=!1){const u=t.getDescendants(e),c=[];c.push(this.beginDirectAnimation(t,i,n,s,o,a,r,h,l));for(const t of u)c.push(this.beginDirectAnimation(t,i,n,s,o,a,r,h,l));return c},a.x.prototype.getAnimatableByTarget=function(t){for(let e=0;e<this._activeAnimatables.length;e++)if(this._activeAnimatables[e].target===t)return this._activeAnimatables[e];return null},a.x.prototype.getAllAnimatablesByTarget=function(t){const e=[];for(let i=0;i<this._activeAnimatables.length;i++)this._activeAnimatables[i].target===t&&e.push(this._activeAnimatables[i]);return e},a.x.prototype.stopAnimation=function(t,e,i){const n=this.getAllAnimatablesByTarget(t);for(const t of n)t.stop(e,i)},a.x.prototype.stopAllAnimations=function(){if(this._activeAnimatables){for(let t=0;t<this._activeAnimatables.length;t++)this._activeAnimatables[t].stop();this._activeAnimatables.length=0}for(const t of this.animationGroups)t.stop()},a.x.prototype._registerTargetForLateAnimationBinding=function(t,e){const i=t.target;this._registeredForLateAnimationBindings.pushNoDuplicate(i),i._lateAnimationHolders||(i._lateAnimationHolders={}),i._lateAnimationHolders[t.targetPath]||(i._lateAnimationHolders[t.targetPath]={totalWeight:0,totalAdditiveWeight:0,animations:[],additiveAnimations:[],originalValue:e}),t.isAdditive?(i._lateAnimationHolders[t.targetPath].additiveAnimations.push(t),i._lateAnimationHolders[t.targetPath].totalAdditiveWeight+=t.weight):(i._lateAnimationHolders[t.targetPath].animations.push(t),i._lateAnimationHolders[t.targetPath].totalWeight+=t.weight)},a.x.prototype._processLateAnimationBindingsForMatrices=function(t){if(0===t.totalWeight&&0===t.totalAdditiveWeight)return t.originalValue;let e=1;const i=r.jp.Vector3[0],n=r.jp.Vector3[1],s=r.jp.Quaternion[0];let o=0;const a=t.animations[0],h=t.originalValue;let l=1,u=!1;if(t.totalWeight<1)l=1-t.totalWeight,h.decompose(n,s,i);else{if(o=1,e=t.totalWeight,l=a.weight/e,1==l){if(!t.totalAdditiveWeight)return a.currentValue;u=!0}a.currentValue.decompose(n,s,i)}if(!u){n.scaleInPlace(l),i.scaleInPlace(l),s.scaleInPlace(l);for(let a=o;a<t.animations.length;a++){const o=t.animations[a];if(0===o.weight)continue;l=o.weight/e;const h=r.jp.Vector3[2],u=r.jp.Vector3[3],c=r.jp.Quaternion[1];o.currentValue.decompose(u,c,h),u.scaleAndAddToRef(l,n),c.scaleAndAddToRef(r._f.Dot(s,c)>0?l:-l,s),h.scaleAndAddToRef(l,i)}s.normalize()}for(let e=0;e<t.additiveAnimations.length;e++){const o=t.additiveAnimations[e];if(0===o.weight)continue;const a=r.jp.Vector3[2],h=r.jp.Vector3[3],l=r.jp.Quaternion[1];o.currentValue.decompose(h,l,a),h.multiplyToRef(n,h),r.P.LerpToRef(n,h,o.weight,n),s.multiplyToRef(l,l),r._f.SlerpToRef(s,l,o.weight,s),a.scaleAndAddToRef(o.weight,i)}const c=a?a._animationState.workValue:r.jp.Matrix[0].clone();return r.y3.ComposeToRef(n,s,i,c),c},a.x.prototype._processLateAnimationBindingsForQuaternions=function(t,e){if(0===t.totalWeight&&0===t.totalAdditiveWeight)return e;const i=t.animations[0],n=t.originalValue;let s=e;if(0===t.totalWeight&&t.totalAdditiveWeight>0)s.copyFrom(n);else if(1===t.animations.length){if(r._f.SlerpToRef(n,i.currentValue,Math.min(1,t.totalWeight),s),0===t.totalAdditiveWeight)return s}else if(t.animations.length>1){let i,o,a=1;if(t.totalWeight<1){const e=1-t.totalWeight;i=[],o=[],i.push(n),o.push(e)}else{if(2===t.animations.length&&(r._f.SlerpToRef(t.animations[0].currentValue,t.animations[1].currentValue,t.animations[1].weight/t.totalWeight,e),0===t.totalAdditiveWeight))return e;i=[],o=[],a=t.totalWeight}for(let e=0;e<t.animations.length;e++){const n=t.animations[e];i.push(n.currentValue),o.push(n.weight/a)}let h=0;for(let t=0;t<i.length;)t?(h+=o[t],r._f.SlerpToRef(s,i[t],o[t]/h,s),t++):(r._f.SlerpToRef(i[t],i[t+1],o[t+1]/(o[t]+o[t+1]),e),s=e,h=o[t]+o[t+1],t+=2)}for(let e=0;e<t.additiveAnimations.length;e++){const i=t.additiveAnimations[e];0!==i.weight&&(s.multiplyToRef(i.currentValue,r.jp.Quaternion[0]),r._f.SlerpToRef(s,r.jp.Quaternion[0],i.weight,s))}return s},a.x.prototype._processLateAnimationBindings=function(){if(this._registeredForLateAnimationBindings.length){for(let t=0;t<this._registeredForLateAnimationBindings.length;t++){const e=this._registeredForLateAnimationBindings.data[t];for(const t in e._lateAnimationHolders){const i=e._lateAnimationHolders[t],s=i.animations[0],o=i.originalValue;if(null==o)continue;const a=n.f.AllowMatrixDecomposeForInterpolation&&o.m;let h=e[t];if(a)h=this._processLateAnimationBindingsForMatrices(i);else{if(void 0!==o.w)h=this._processLateAnimationBindingsForQuaternions(i,h||r._f.Identity());else{let t=0,e=1;if(i.totalWeight<1)h=s&&o.scale?o.scale(1-i.totalWeight):s?o*(1-i.totalWeight):o.clone?o.clone():o;else if(s){e=i.totalWeight;const n=s.weight/e;h=1!==n?s.currentValue.scale?s.currentValue.scale(n):s.currentValue*n:s.currentValue,t=1}for(let n=t;n<i.animations.length;n++){const t=i.animations[n],s=t.weight/e;s&&(t.currentValue.scaleAndAddToRef?t.currentValue.scaleAndAddToRef(s,h):h+=t.currentValue*s)}for(let t=0;t<i.additiveAnimations.length;t++){const e=i.additiveAnimations[t],n=e.weight;n&&(e.currentValue.scaleAndAddToRef?e.currentValue.scaleAndAddToRef(n,h):h+=e.currentValue*n)}}}e[t]=h}e._lateAnimationHolders={}}this._registeredForLateAnimationBindings.reset()}},l.N.prototype.copyAnimationRange=function(t,e,i,s=!1,o=null){0===this.animations.length&&(this.animations.push(new n.f(this.name,"_matrix",t.animations[0].framePerSecond,n.f.ANIMATIONTYPE_MATRIX,0)),this.animations[0].setKeys([]));const a=t.animations[0].getRange(e);if(!a)return!1;const r=a.from,h=a.to,l=t.animations[0].getKeys(),u=t.length,c=t.getParent(),d=this.getParent(),_=s&&c&&u&&this.length&&u!==this.length,g=_&&d&&c?d.length/c.length:1,p=s&&!d&&o&&(1!==o.x||1!==o.y||1!==o.z),m=this.animations[0].getKeys();let f,A,v;for(let t=0,e=l.length;t<e;t++)f=l[t],f.frame>=r&&f.frame<=h&&(s?(v=f.value.clone(),_?(A=v.getTranslation(),v.setTranslation(A.scaleInPlace(g))):p&&o?(A=v.getTranslation(),v.setTranslation(A.multiplyInPlace(o))):v=f.value):v=f.value,m.push({frame:f.frame+i,value:v}));return this.animations[0].createRange(e,r+i,h+i),!0}},18770:(t,e,i)=>{"use strict";i.d(e,{f:()=>_});var n=i(58095),s=i(15631),o=i(72739),a=i(96969),r=i(48620),h=i(45345),l=i(4906),u=i(17834),c=i(76144),d=i(51912);class _{static _PrepareAnimation(t,e,i,o,a,r,h,l){let u;if(!isNaN(parseFloat(a))&&isFinite(a)?u=_.ANIMATIONTYPE_FLOAT:a instanceof n._f?u=_.ANIMATIONTYPE_QUATERNION:a instanceof n.P?u=_.ANIMATIONTYPE_VECTOR3:a instanceof n.FM?u=_.ANIMATIONTYPE_VECTOR2:a instanceof s.Wo?u=_.ANIMATIONTYPE_COLOR3:a instanceof s.HE?u=_.ANIMATIONTYPE_COLOR4:a instanceof c.$&&(u=_.ANIMATIONTYPE_SIZE),null==u)return null;const d=new _(t,e,i,u,h),g=[{frame:0,value:a},{frame:o,value:r}];return d.setKeys(g),void 0!==l&&d.setEasingFunction(l),d}static CreateAnimation(t,e,i,n){const s=new _(t+"Animation",t,i,e,_.ANIMATIONLOOPMODE_CONSTANT);return s.setEasingFunction(n),s}static CreateAndStartAnimation(t,e,i,n,s,o,a,r,h,l,u){const c=_._PrepareAnimation(t,i,n,s,o,a,r,h);return c?(e.getScene&&(u=e.getScene()),u?u.beginDirectAnimation(e,[c],0,s,1===c.loopMode,1,l):null):null}static CreateAndStartHierarchyAnimation(t,e,i,n,s,o,a,r,h,l,u){const c=_._PrepareAnimation(t,n,s,o,a,r,h,l);if(!c)return null;return e.getScene().beginDirectHierarchyAnimation(e,i,[c],0,o,1===c.loopMode,1,u)}static CreateMergeAndStartAnimation(t,e,i,n,s,o,a,r,h,l){const u=_._PrepareAnimation(t,i,n,s,o,a,r,h);return u?(e.animations.push(u),e.getScene().beginAnimation(e,0,s,1===u.loopMode,1,l)):null}static MakeAnimationAdditive(t,e=0,i,s=!1,o){let a=t;if(s&&(a=t.clone(),a.name=o||a.name),!a._keys.length)return a;e=e>=0?e:0;let r=0;const h=a._keys[0];let l=a._keys.length-1;const u=a._keys[l],c={referenceValue:h.value,referencePosition:n.jp.Vector3[0],referenceQuaternion:n.jp.Quaternion[0],referenceScaling:n.jp.Vector3[1],keyPosition:n.jp.Vector3[2],keyQuaternion:n.jp.Quaternion[1],keyScaling:n.jp.Vector3[3]};let d=!1,g=h.frame,p=u.frame;if(i){const t=a.getRange(i);t&&(g=t.from,p=t.to)}let m=h.frame===g,f=u.frame===p;if(1===a._keys.length){const t=a._getKeyValue(a._keys[0]);c.referenceValue=t.clone?t.clone():t,d=!0}else if(e<=h.frame){const t=a._getKeyValue(h.value);c.referenceValue=t.clone?t.clone():t,d=!0}else if(e>=u.frame){const t=a._getKeyValue(u.value);c.referenceValue=t.clone?t.clone():t,d=!0}let A=0;for(;!d||!m||!f&&A<a._keys.length-1;){const t=a._keys[A],i=a._keys[A+1];if(!d&&e>=t.frame&&e<=i.frame){let n;if(e===t.frame)n=a._getKeyValue(t.value);else if(e===i.frame)n=a._getKeyValue(i.value);else{const t={key:A,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT};n=a._interpolate(e,t)}c.referenceValue=n.clone?n.clone():n,d=!0}if(!m&&g>=t.frame&&g<=i.frame){if(g===t.frame)r=A;else if(g===i.frame)r=A+1;else{const t={key:A,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},e=a._interpolate(g,t),i={frame:g,value:e.clone?e.clone():e};a._keys.splice(A+1,0,i),r=A+1}m=!0}if(!f&&p>=t.frame&&p<=i.frame){if(p===t.frame)l=A;else if(p===i.frame)l=A+1;else{const t={key:A,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},e=a._interpolate(p,t),i={frame:p,value:e.clone?e.clone():e};a._keys.splice(A+1,0,i),l=A+1}f=!0}A++}for(a.dataType===_.ANIMATIONTYPE_QUATERNION?c.referenceValue.normalize().conjugateInPlace():a.dataType===_.ANIMATIONTYPE_MATRIX&&(c.referenceValue.decompose(c.referenceScaling,c.referenceQuaternion,c.referencePosition),c.referenceQuaternion.normalize().conjugateInPlace()),A=r;A<=l;A++){const t=a._keys[A];if(!A||a.dataType===_.ANIMATIONTYPE_FLOAT||t.value!==h.value)switch(a.dataType){case _.ANIMATIONTYPE_MATRIX:t.value.decompose(c.keyScaling,c.keyQuaternion,c.keyPosition),c.keyPosition.subtractInPlace(c.referencePosition),c.keyScaling.divideInPlace(c.referenceScaling),c.referenceQuaternion.multiplyToRef(c.keyQuaternion,c.keyQuaternion),n.y3.ComposeToRef(c.keyScaling,c.keyQuaternion,c.keyPosition,t.value);break;case _.ANIMATIONTYPE_QUATERNION:c.referenceValue.multiplyToRef(t.value,t.value);break;case _.ANIMATIONTYPE_VECTOR2:case _.ANIMATIONTYPE_VECTOR3:case _.ANIMATIONTYPE_COLOR3:case _.ANIMATIONTYPE_COLOR4:t.value.subtractToRef(c.referenceValue,t.value);break;case _.ANIMATIONTYPE_SIZE:t.value.width-=c.referenceValue.width,t.value.height-=c.referenceValue.height;break;default:t.value-=c.referenceValue}}return a}static TransitionTo(t,e,i,n,s,o,a,r=null){if(a<=0)return i[t]=e,r&&r(),null;const h=s*(a/1e3);o.setKeys([{frame:0,value:i[t].clone?i[t].clone():i[t]},{frame:h,value:e}]),i.animations||(i.animations=[]),i.animations.push(o);const l=n.beginAnimation(i,0,h,!1);return l.onAnimationEnd=r,l}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(const t of this._runtimeAnimations)if(!t.isStopped())return!0;return!1}constructor(t,e,i,n,s,o){this.name=t,this.targetProperty=e,this.framePerSecond=i,this.dataType=n,this.loopMode=s,this.enableBlending=o,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=e.split("."),this.dataType=n,this.loopMode=void 0===s?_.ANIMATIONLOOPMODE_CYCLE:s,this.uniqueId=_._UniqueIdGenerator++}toString(t){let e="Name: "+this.name+", property: "+this.targetProperty;if(e+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],e+=", nKeys: "+(this._keys?this._keys.length:"none"),e+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),t){e+=", Ranges: {";let t=!0;for(const i in this._ranges)t&&(e+=", ",t=!1),e+=i;e+="}"}return e}addEvent(t){this._events.push(t),this._events.sort(((t,e)=>t.frame-e.frame))}removeEvents(t){for(let e=0;e<this._events.length;e++)this._events[e].frame===t&&(this._events.splice(e,1),e--)}getEvents(){return this._events}createRange(t,e,i){this._ranges[t]||(this._ranges[t]=new l.X(t,e,i))}deleteRange(t,e=!0){const i=this._ranges[t];if(i){if(e){const t=i.from,e=i.to;for(let i=this._keys.length-1;i>=0;i--)this._keys[i].frame>=t&&this._keys[i].frame<=e&&this._keys.splice(i,1)}this._ranges[t]=null}}getRange(t){return this._ranges[t]}getKeys(){return this._keys}getHighestFrame(){let t=0;for(let e=0,i=this._keys.length;e<i;e++)t<this._keys[e].frame&&(t=this._keys[e].frame);return t}getEasingFunction(){return this._easingFunction}setEasingFunction(t){this._easingFunction=t}floatInterpolateFunction(t,e,i){return o.R.Lerp(t,e,i)}floatInterpolateFunctionWithTangents(t,e,i,n,s){return o.R.Hermite(t,e,i,n,s)}quaternionInterpolateFunction(t,e,i){return n._f.Slerp(t,e,i)}quaternionInterpolateFunctionWithTangents(t,e,i,s,o){return n._f.Hermite(t,e,i,s,o).normalize()}vector3InterpolateFunction(t,e,i){return n.P.Lerp(t,e,i)}vector3InterpolateFunctionWithTangents(t,e,i,s,o){return n.P.Hermite(t,e,i,s,o)}vector2InterpolateFunction(t,e,i){return n.FM.Lerp(t,e,i)}vector2InterpolateFunctionWithTangents(t,e,i,s,o){return n.FM.Hermite(t,e,i,s,o)}sizeInterpolateFunction(t,e,i){return c.$.Lerp(t,e,i)}color3InterpolateFunction(t,e,i){return s.Wo.Lerp(t,e,i)}color3InterpolateFunctionWithTangents(t,e,i,n,o){return s.Wo.Hermite(t,e,i,n,o)}color4InterpolateFunction(t,e,i){return s.HE.Lerp(t,e,i)}color4InterpolateFunctionWithTangents(t,e,i,n,o){return s.HE.Hermite(t,e,i,n,o)}_getKeyValue(t){return"function"==typeof t?t():t}evaluate(t){return this._interpolate(t,{key:0,repeatCount:0,loopMode:_.ANIMATIONLOOPMODE_CONSTANT})}_interpolate(t,e){if(e.loopMode===_.ANIMATIONLOOPMODE_CONSTANT&&e.repeatCount>0)return e.highLimitValue.clone?e.highLimitValue.clone():e.highLimitValue;const i=this._keys,n=i.length;let s=e.key;for(;s>=0&&t<i[s].frame;)--s;for(;s+1<=n-1&&t>=i[s+1].frame;)++s;if(e.key=s,s<0)return this._getKeyValue(i[0].value);if(s+1>n-1)return this._getKeyValue(i[n-1].value);const o=i[s],a=i[s+1],r=this._getKeyValue(o.value),l=this._getKeyValue(a.value);if(o.interpolation===h.N.STEP)return a.frame>t?r:l;const u=void 0!==o.outTangent&&void 0!==a.inTangent,c=a.frame-o.frame;let d=(t-o.frame)/c;const g=this.getEasingFunction();switch(null!==g&&(d=g.ease(d)),this.dataType){case _.ANIMATIONTYPE_FLOAT:{const t=u?this.floatInterpolateFunctionWithTangents(r,o.outTangent*c,l,a.inTangent*c,d):this.floatInterpolateFunction(r,l,d);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return e.offsetValue*e.repeatCount+t}break}case _.ANIMATIONTYPE_QUATERNION:{const t=u?this.quaternionInterpolateFunctionWithTangents(r,o.outTangent.scale(c),l,a.inTangent.scale(c),d):this.quaternionInterpolateFunction(r,l,d);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.addInPlace(e.offsetValue.scale(e.repeatCount))}return t}case _.ANIMATIONTYPE_VECTOR3:{const t=u?this.vector3InterpolateFunctionWithTangents(r,o.outTangent.scale(c),l,a.inTangent.scale(c),d):this.vector3InterpolateFunction(r,l,d);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_VECTOR2:{const t=u?this.vector2InterpolateFunctionWithTangents(r,o.outTangent.scale(c),l,a.inTangent.scale(c),d):this.vector2InterpolateFunction(r,l,d);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_SIZE:switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(r,l,d);case _.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(r,l,d).add(e.offsetValue.scale(e.repeatCount))}break;case _.ANIMATIONTYPE_COLOR3:{const t=u?this.color3InterpolateFunctionWithTangents(r,o.outTangent.scale(c),l,a.inTangent.scale(c),d):this.color3InterpolateFunction(r,l,d);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_COLOR4:{const t=u?this.color4InterpolateFunctionWithTangents(r,o.outTangent.scale(c),l,a.inTangent.scale(c),d):this.color4InterpolateFunction(r,l,d);switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return t;case _.ANIMATIONLOOPMODE_RELATIVE:return t.add(e.offsetValue.scale(e.repeatCount))}break}case _.ANIMATIONTYPE_MATRIX:switch(e.loopMode){case _.ANIMATIONLOOPMODE_CYCLE:case _.ANIMATIONLOOPMODE_CONSTANT:return _.AllowMatricesInterpolation?this.matrixInterpolateFunction(r,l,d,e.workValue):r;case _.ANIMATIONLOOPMODE_RELATIVE:return r}}return 0}matrixInterpolateFunction(t,e,i,s){return _.AllowMatrixDecomposeForInterpolation?s?(n.y3.DecomposeLerpToRef(t,e,i,s),s):n.y3.DecomposeLerp(t,e,i):s?(n.y3.LerpToRef(t,e,i,s),s):n.y3.Lerp(t,e,i)}clone(){const t=new _(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed,this._keys&&t.setKeys(this._keys),this._ranges){t._ranges={};for(const e in this._ranges){const i=this._ranges[e];i&&(t._ranges[e]=i.clone())}}return t}setKeys(t){this._keys=t.slice(0)}serialize(){const t={};t.name=this.name,t.property=this.targetProperty,t.framePerSecond=this.framePerSecond,t.dataType=this.dataType,t.loopBehavior=this.loopMode,t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed;const e=this.dataType;t.keys=[];const i=this.getKeys();for(let n=0;n<i.length;n++){const s=i[n],o={};switch(o.frame=s.frame,e){case _.ANIMATIONTYPE_FLOAT:o.values=[s.value],void 0!==s.inTangent&&o.values.push(s.inTangent),void 0!==s.outTangent&&(void 0===s.inTangent&&o.values.push(void 0),o.values.push(s.outTangent)),void 0!==s.interpolation&&(void 0===s.inTangent&&o.values.push(void 0),void 0===s.outTangent&&o.values.push(void 0),o.values.push(s.interpolation));break;case _.ANIMATIONTYPE_QUATERNION:case _.ANIMATIONTYPE_MATRIX:case _.ANIMATIONTYPE_VECTOR3:case _.ANIMATIONTYPE_COLOR3:case _.ANIMATIONTYPE_COLOR4:o.values=s.value.asArray(),null!=s.inTangent&&o.values.push(s.inTangent.asArray()),null!=s.outTangent&&(void 0===s.inTangent&&o.values.push(void 0),o.values.push(s.outTangent.asArray())),void 0!==s.interpolation&&(void 0===s.inTangent&&o.values.push(void 0),void 0===s.outTangent&&o.values.push(void 0),o.values.push(s.interpolation))}t.keys.push(o)}t.ranges=[];for(const e in this._ranges){const i=this._ranges[e];if(!i)continue;const n={};n.name=e,n.from=i.from,n.to=i.to,t.ranges.push(n)}return t}static _UniversalLerp(t,e,i){const n=t.constructor;return n.Lerp?n.Lerp(t,e,i):n.Slerp?n.Slerp(t,e,i):t.toFixed?t*(1-i)+i*e:e}static Parse(t){const e=new _(t.name,t.property,t.framePerSecond,t.dataType,t.loopBehavior),i=t.dataType,o=[];let a,r;for(t.enableBlending&&(e.enableBlending=t.enableBlending),t.blendingSpeed&&(e.blendingSpeed=t.blendingSpeed),r=0;r<t.keys.length;r++){const e=t.keys[r];let h,l,u;switch(i){case _.ANIMATIONTYPE_FLOAT:a=e.values[0],e.values.length>=2&&(h=e.values[1]),e.values.length>=3&&(l=e.values[2]),e.values.length>=4&&(u=e.values[3]);break;case _.ANIMATIONTYPE_QUATERNION:if(a=n._f.FromArray(e.values),e.values.length>=8){const t=n._f.FromArray(e.values.slice(4,8));t.equals(n._f.Zero())||(h=t)}if(e.values.length>=12){const t=n._f.FromArray(e.values.slice(8,12));t.equals(n._f.Zero())||(l=t)}e.values.length>=13&&(u=e.values[12]);break;case _.ANIMATIONTYPE_MATRIX:a=n.y3.FromArray(e.values),e.values.length>=17&&(u=e.values[16]);break;case _.ANIMATIONTYPE_COLOR3:a=s.Wo.FromArray(e.values),e.values[3]&&(h=s.Wo.FromArray(e.values[3])),e.values[4]&&(l=s.Wo.FromArray(e.values[4])),e.values[5]&&(u=e.values[5]);break;case _.ANIMATIONTYPE_COLOR4:a=s.HE.FromArray(e.values),e.values[4]&&(h=s.HE.FromArray(e.values[4])),e.values[5]&&(l=s.HE.FromArray(e.values[5])),e.values[6]&&(u=s.HE.FromArray(e.values[6]));break;case _.ANIMATIONTYPE_VECTOR3:default:a=n.P.FromArray(e.values),e.values[3]&&(h=n.P.FromArray(e.values[3])),e.values[4]&&(l=n.P.FromArray(e.values[4])),e.values[5]&&(u=e.values[5])}const c={};c.frame=e.frame,c.value=a,null!=h&&(c.inTangent=h),null!=l&&(c.outTangent=l),null!=u&&(c.interpolation=u),o.push(c)}if(e.setKeys(o),t.ranges)for(r=0;r<t.ranges.length;r++)a=t.ranges[r],e.createRange(a.name,a.from,a.to);return e}static AppendSerializedAnimations(t,e){a.p4.AppendSerializedAnimations(t,e)}static ParseFromFileAsync(t,e){return new Promise(((i,n)=>{const s=new d.g;s.addEventListener("readystatechange",(()=>{if(4==s.readyState)if(200==s.status){let e=JSON.parse(s.responseText);if(e.animations&&(e=e.animations),e.length){const t=new Array;for(const i of e)t.push(this.Parse(i));i(t)}else{const n=this.Parse(e);t&&(n.name=t),i(n)}}else n("Unable to load the animation")})),s.open("GET",e),s.send()}))}static ParseFromSnippetAsync(t){return new Promise(((e,i)=>{const n=new d.g;n.addEventListener("readystatechange",(()=>{if(4==n.readyState)if(200==n.status){const i=JSON.parse(JSON.parse(n.responseText).jsonPayload);if(i.animations){const n=JSON.parse(i.animations),s=new Array;for(const e of n.animations){const i=this.Parse(e);i.snippetId=t,s.push(i)}e(s)}else{const n=JSON.parse(i.animation),s=this.Parse(n);s.snippetId=t,e(s)}}else i("Unable to load the snippet "+t)})),n.open("GET",this.SnippetUrl+"/"+t.replace(/#/g,"/")),n.send()}))}}_._UniqueIdGenerator=0,_.AllowMatricesInterpolation=!1,_.AllowMatrixDecomposeForInterpolation=!0,_.SnippetUrl="https://snippet.babylonjs.com",_.ANIMATIONTYPE_FLOAT=0,_.ANIMATIONTYPE_VECTOR3=1,_.ANIMATIONTYPE_QUATERNION=2,_.ANIMATIONTYPE_MATRIX=3,_.ANIMATIONTYPE_COLOR3=4,_.ANIMATIONTYPE_COLOR4=7,_.ANIMATIONTYPE_VECTOR2=5,_.ANIMATIONTYPE_SIZE=6,_.ANIMATIONLOOPMODE_RELATIVE=0,_.ANIMATIONLOOPMODE_CYCLE=1,_.ANIMATIONLOOPMODE_CONSTANT=2,_.CreateFromSnippetAsync=_.ParseFromSnippetAsync,(0,r.H)("BABYLON.Animation",_),u.N._AnimationRangeFactory=(t,e,i)=>new l.X(t,e,i)},80508:(t,e,i)=>{"use strict";i.d(e,{O:()=>n});class n{constructor(t,e,i){this.frame=t,this.action=e,this.onlyOnce=i,this.isDone=!1}_clone(){return new n(this.frame,this.action,this.onlyOnce)}}},4849:(t,e,i)=>{"use strict";i.d(e,{O:()=>h});var n=i(18770),s=i(62897),o=i(15210),a=i(20163);class r{getClassName(){return"TargetedAnimation"}serialize(){const t={};return t.animation=this.animation.serialize(),t.targetId=this.target.id,t}}class h{get from(){return this._from}get to(){return this._to}get isStarted(){return this._isStarted}get isPlaying(){return this._isStarted&&!this._isPaused}get speedRatio(){return this._speedRatio}set speedRatio(t){if(this._speedRatio!==t){this._speedRatio=t;for(let t=0;t<this._animatables.length;t++){this._animatables[t].speedRatio=this._speedRatio}}}get loopAnimation(){return this._loopAnimation}set loopAnimation(t){if(this._loopAnimation!==t){this._loopAnimation=t;for(let t=0;t<this._animatables.length;t++){this._animatables[t].loopAnimation=this._loopAnimation}}}get isAdditive(){return this._isAdditive}set isAdditive(t){if(this._isAdditive!==t){this._isAdditive=t;for(let t=0;t<this._animatables.length;t++){this._animatables[t].isAdditive=this._isAdditive}}}get targetedAnimations(){return this._targetedAnimations}get animatables(){return this._animatables}get children(){return this._targetedAnimations}constructor(t,e=null){this.name=t,this._targetedAnimations=new Array,this._animatables=new Array,this._from=Number.MAX_VALUE,this._to=-Number.MAX_VALUE,this._speedRatio=1,this._loopAnimation=!1,this._isAdditive=!1,this._parentContainer=null,this.onAnimationEndObservable=new s.y$,this.onAnimationLoopObservable=new s.y$,this.onAnimationGroupLoopObservable=new s.y$,this.onAnimationGroupEndObservable=new s.y$,this.onAnimationGroupPauseObservable=new s.y$,this.onAnimationGroupPlayObservable=new s.y$,this.metadata=null,this._animationLoopFlags=[],this._scene=e||o.l.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._scene.addAnimationGroup(this)}addTargetedAnimation(t,e){const i=new r;i.animation=t,i.target=e;const n=t.getKeys();return this._from>n[0].frame&&(this._from=n[0].frame),this._to<n[n.length-1].frame&&(this._to=n[n.length-1].frame),this._targetedAnimations.push(i),i}normalize(t=null,e=null){null==t&&(t=this._from),null==e&&(e=this._to);for(let i=0;i<this._targetedAnimations.length;i++){const n=this._targetedAnimations[i].animation.getKeys(),s=n[0],o=n[n.length-1];if(s.frame>t){const e={frame:t,value:s.value,inTangent:s.inTangent,outTangent:s.outTangent,interpolation:s.interpolation};n.splice(0,0,e)}if(o.frame<e){const t={frame:e,value:o.value,inTangent:o.inTangent,outTangent:o.outTangent,interpolation:o.interpolation};n.push(t)}}return this._from=t,this._to=e,this}_processLoop(t,e,i){t.onAnimationLoop=()=>{this.onAnimationLoopObservable.notifyObservers(e),this._animationLoopFlags[i]||(this._animationLoopFlags[i]=!0,this._animationLoopCount++,this._animationLoopCount===this._targetedAnimations.length&&(this.onAnimationGroupLoopObservable.notifyObservers(this),this._animationLoopCount=0,this._animationLoopFlags.length=0))}}start(t=!1,e=1,i,n,s){if(this._isStarted||0===this._targetedAnimations.length)return this;this._loopAnimation=t,this._animationLoopCount=0,this._animationLoopFlags.length=0;for(let o=0;o<this._targetedAnimations.length;o++){const a=this._targetedAnimations[o],r=this._scene.beginDirectAnimation(a.target,[a.animation],void 0!==i?i:this._from,void 0!==n?n:this._to,t,e,void 0,void 0,void 0!==s?s:this._isAdditive);r.onAnimationEnd=()=>{this.onAnimationEndObservable.notifyObservers(a),this._checkAnimationGroupEnded(r)},this._processLoop(r,a,o),this._animatables.push(r)}return this._speedRatio=e,this._isStarted=!0,this._isPaused=!1,this.onAnimationGroupPlayObservable.notifyObservers(this),this}pause(){if(!this._isStarted)return this;this._isPaused=!0;for(let t=0;t<this._animatables.length;t++){this._animatables[t].pause()}return this.onAnimationGroupPauseObservable.notifyObservers(this),this}play(t){return this.isStarted&&this._animatables.length===this._targetedAnimations.length?(void 0!==t&&(this.loopAnimation=t),this.restart()):(this.stop(),this.start(t,this._speedRatio)),this._isPaused=!1,this}reset(){if(!this._isStarted)return this.play(),this.goToFrame(0),this.stop(),this;for(let t=0;t<this._animatables.length;t++){this._animatables[t].reset()}return this}restart(){if(!this._isStarted)return this;for(let t=0;t<this._animatables.length;t++){this._animatables[t].restart()}return this.onAnimationGroupPlayObservable.notifyObservers(this),this}stop(){if(!this._isStarted)return this;const t=this._animatables.slice();for(let e=0;e<t.length;e++)t[e].stop();return this._isStarted=!1,this}setWeightForAllAnimatables(t){for(let e=0;e<this._animatables.length;e++){this._animatables[e].weight=t}return this}syncAllAnimationsWith(t){for(let e=0;e<this._animatables.length;e++){this._animatables[e].syncWith(t)}return this}goToFrame(t){if(!this._isStarted)return this;for(let e=0;e<this._animatables.length;e++){this._animatables[e].goToFrame(t)}return this}dispose(){this._targetedAnimations.length=0,this._animatables.length=0;const t=this._scene.animationGroups.indexOf(this);if(t>-1&&this._scene.animationGroups.splice(t,1),this._parentContainer){const t=this._parentContainer.animationGroups.indexOf(this);t>-1&&this._parentContainer.animationGroups.splice(t,1),this._parentContainer=null}this.onAnimationEndObservable.clear(),this.onAnimationGroupEndObservable.clear(),this.onAnimationGroupPauseObservable.clear(),this.onAnimationGroupPlayObservable.clear(),this.onAnimationLoopObservable.clear(),this.onAnimationGroupLoopObservable.clear()}_checkAnimationGroupEnded(t){const e=this._animatables.indexOf(t);e>-1&&this._animatables.splice(e,1),0===this._animatables.length&&(this._isStarted=!1,this.onAnimationGroupEndObservable.notifyObservers(this))}clone(t,e,i=!1){const n=new h(t||this.name,this._scene);for(const t of this._targetedAnimations)n.addTargetedAnimation(i?t.animation.clone():t.animation,e?e(t.target):t.target);return n}serialize(){const t={};t.name=this.name,t.from=this.from,t.to=this.to,t.targetedAnimations=[];for(let e=0;e<this.targetedAnimations.length;e++){const i=this.targetedAnimations[e];t.targetedAnimations[e]=i.serialize()}return a.$&&a.$.HasTags(this)&&(t.tags=a.$.GetTags(this)),this.metadata&&(t.metadata=this.metadata),t}static Parse(t,e){const i=new h(t.name,e);for(let s=0;s<t.targetedAnimations.length;s++){const o=t.targetedAnimations[s],a=n.f.Parse(o.animation),r=o.targetId;if("influence"===o.animation.property){const t=e.getMorphTargetById(r);t&&i.addTargetedAnimation(a,t)}else{const t=e.getNodeById(r);null!=t&&i.addTargetedAnimation(a,t)}}return null!==t.from&&null!==t.to&&i.normalize(t.from,t.to),a.$&&a.$.AddTagsTo(i,t.tags),void 0!==t.metadata&&(i.metadata=t.metadata),i}static MakeAnimationAdditive(t,e=0,i,s=!1,o){let a=t;s&&(a=t.clone(o||a.name));const r=a.targetedAnimations;for(let t=0;t<r.length;t++){const s=r[t];n.f.MakeAnimationAdditive(s.animation,e,i)}return a.isAdditive=!0,a}getClassName(){return"AnimationGroup"}toString(t){let e="Name: "+this.name;return e+=", type: "+this.getClassName(),t&&(e+=", from: "+this._from,e+=", to: "+this._to,e+=", isStarted: "+this._isStarted,e+=", speedRatio: "+this._speedRatio,e+=", targetedAnimations length: "+this._targetedAnimations.length,e+=", animatables length: "+this._animatables),e}}},45345:(t,e,i)=>{"use strict";var n;i.d(e,{N:()=>n}),function(t){t[t.NONE=0]="NONE",t[t.STEP=1]="STEP"}(n||(n={}))},4906:(t,e,i)=>{"use strict";i.d(e,{X:()=>n});class n{constructor(t,e,i){this.name=t,this.from=e,this.to=i}clone(){return new n(this.name,this.from,this.to)}}},88916:(t,e,i)=>{"use strict";i.d(e,{EI:()=>a,Kp:()=>n,bi:()=>h,qP:()=>s,ud:()=>o,v:()=>r});i(74742);class n{constructor(){this._easingMode=n.EASINGMODE_EASEIN}setEasingMode(t){const e=Math.min(Math.max(t,0),2);this._easingMode=e}getEasingMode(){return this._easingMode}easeInCore(t){throw new Error("You must implement this method")}ease(t){switch(this._easingMode){case n.EASINGMODE_EASEIN:return this.easeInCore(t);case n.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-t)}return t>=.5?.5*(1-this.easeInCore(2*(1-t)))+.5:.5*this.easeInCore(2*t)}}n.EASINGMODE_EASEIN=0,n.EASINGMODE_EASEOUT=1,n.EASINGMODE_EASEINOUT=2;class s extends n{easeInCore(t){return t=Math.max(0,Math.min(1,t)),1-Math.sqrt(1-t*t)}}class o extends n{constructor(t=1){super(),this.amplitude=t}easeInCore(t){const e=Math.max(0,this.amplitude);return Math.pow(t,3)-t*e*Math.sin(3.141592653589793*t)}}class a extends n{constructor(t=2){super(),this.exponent=t}easeInCore(t){return this.exponent<=0?t:(Math.exp(this.exponent*t)-1)/(Math.exp(this.exponent)-1)}}class r extends n{easeInCore(t){return t*t}}class h extends n{easeInCore(t){return 1-Math.sin(1.5707963267948966*(1-t))}}},96088:(t,e,i)=>{"use strict";i(83534),i(18770);i(88916),i(65174),i(80508),i(4849),i(45345),i(4906),i(58095)},65174:(t,e,i)=>{"use strict";i.d(e,{o:()=>d});var n=i(58095),s=i(15631),o=i(18770),a=i(76144);const r=Object.freeze(new n._f(0,0,0,0)),h=Object.freeze(n.P.Zero()),l=Object.freeze(n.FM.Zero()),u=Object.freeze(a.$.Zero()),c=Object.freeze(s.Wo.Black());class d{get currentFrame(){return this._currentFrame}get weight(){return this._weight}get currentValue(){return this._currentValue}get targetPath(){return this._targetPath}get target(){return this._currentActiveTarget}get isAdditive(){return this._host&&this._host.isAdditive}constructor(t,e,i,s){if(this._events=new Array,this._currentFrame=0,this._originalValue=new Array,this._originalBlendValue=null,this._offsetsCache={},this._highLimitsCache={},this._stopped=!1,this._blendingFactor=0,this._currentValue=null,this._currentActiveTarget=null,this._directTarget=null,this._targetPath="",this._weight=1,this._ratioOffset=0,this._previousDelay=0,this._previousRatio=0,this._targetIsArray=!1,this._animation=e,this._target=t,this._scene=i,this._host=s,this._activeTargets=[],e._runtimeAnimations.push(this),this._animationState={key:0,repeatCount:0,loopMode:this._getCorrectLoopMode()},this._animation.dataType===o.f.ANIMATIONTYPE_MATRIX&&(this._animationState.workValue=n.y3.Zero()),this._keys=this._animation.getKeys(),this._minFrame=this._keys[0].frame,this._maxFrame=this._keys[this._keys.length-1].frame,this._minValue=this._keys[0].value,this._maxValue=this._keys[this._keys.length-1].value,0!==this._minFrame){const t={frame:0,value:this._minValue};this._keys.splice(0,0,t)}if(this._target instanceof Array){let t=0;for(const e of this._target)this._preparePath(e,t),this._getOriginalValues(t),t++;this._targetIsArray=!0}else this._preparePath(this._target),this._getOriginalValues(),this._targetIsArray=!1,this._directTarget=this._activeTargets[0];const a=e.getEvents();a&&a.length>0&&a.forEach((t=>{this._events.push(t._clone())})),this._enableBlending=t&&t.animationPropertiesOverride?t.animationPropertiesOverride.enableBlending:this._animation.enableBlending}_preparePath(t,e=0){const i=this._animation.targetPropertyPath;if(i.length>1){let n=t[i[0]];for(let t=1;t<i.length-1;t++)n=n[i[t]];this._targetPath=i[i.length-1],this._activeTargets[e]=n}else this._targetPath=i[0],this._activeTargets[e]=t}get animation(){return this._animation}reset(t=!1){if(t)if(this._target instanceof Array){let t=0;for(const e of this._target)void 0!==this._originalValue[t]&&this._setValue(e,this._activeTargets[t],this._originalValue[t],-1,t),t++}else void 0!==this._originalValue[0]&&this._setValue(this._target,this._directTarget,this._originalValue[0],-1,0);this._offsetsCache={},this._highLimitsCache={},this._currentFrame=0,this._blendingFactor=0;for(let t=0;t<this._events.length;t++)this._events[t].isDone=!1}isStopped(){return this._stopped}dispose(){const t=this._animation.runtimeAnimations.indexOf(this);t>-1&&this._animation.runtimeAnimations.splice(t,1)}setValue(t,e){if(this._targetIsArray)for(let i=0;i<this._target.length;i++){const n=this._target[i];this._setValue(n,this._activeTargets[i],t,e,i)}else this._setValue(this._target,this._directTarget,t,e,0)}_getOriginalValues(t=0){let e;const i=this._activeTargets[t];e=i.getRestPose&&"_matrix"===this._targetPath?i.getRestPose():i[this._targetPath],e&&e.clone?this._originalValue[t]=e.clone():this._originalValue[t]=e}_setValue(t,e,i,s,a){if(this._currentActiveTarget=e,this._weight=s,this._enableBlending&&this._blendingFactor<=1){if(!this._originalBlendValue){const t=e[this._targetPath];t.clone?this._originalBlendValue=t.clone():this._originalBlendValue=t}this._originalBlendValue.m?o.f.AllowMatrixDecomposeForInterpolation?this._currentValue?n.y3.DecomposeLerpToRef(this._originalBlendValue,i,this._blendingFactor,this._currentValue):this._currentValue=n.y3.DecomposeLerp(this._originalBlendValue,i,this._blendingFactor):this._currentValue?n.y3.LerpToRef(this._originalBlendValue,i,this._blendingFactor,this._currentValue):this._currentValue=n.y3.Lerp(this._originalBlendValue,i,this._blendingFactor):this._currentValue=o.f._UniversalLerp(this._originalBlendValue,i,this._blendingFactor);const s=t&&t.animationPropertiesOverride?t.animationPropertiesOverride.blendingSpeed:this._animation.blendingSpeed;this._blendingFactor+=s}else this._currentValue?this._currentValue.copyFrom?this._currentValue.copyFrom(i):this._currentValue=i:(null==i?void 0:i.clone)?this._currentValue=i.clone():this._currentValue=i;-1!==s?this._scene._registerTargetForLateAnimationBinding(this,this._originalValue[a]):e[this._targetPath]=this._currentValue,t.markAsDirty&&t.markAsDirty(this._animation.targetProperty)}_getCorrectLoopMode(){return this._target&&this._target.animationPropertiesOverride?this._target.animationPropertiesOverride.loopMode:this._animation.loopMode}goToFrame(t){const e=this._animation.getKeys();t<e[0].frame?t=e[0].frame:t>e[e.length-1].frame&&(t=e[e.length-1].frame);const i=this._events;if(i.length)for(let e=0;e<i.length;e++)i[e].onlyOnce||(i[e].isDone=i[e].frame<t);this._currentFrame=t;const n=this._animation._interpolate(t,this._animationState);this.setValue(n,-1)}_prepareForSpeedRatioChange(t){const e=this._previousDelay*(this._animation.framePerSecond*t)/1e3;this._ratioOffset=this._previousRatio-e}animate(t,e,i,n,s,a=-1){const d=this._animation,_=d.targetPropertyPath;if(!_||_.length<1)return this._stopped=!0,!1;let g=!0;(e<this._minFrame||e>this._maxFrame)&&(e=this._minFrame),(i<this._minFrame||i>this._maxFrame)&&(i=this._maxFrame);const p=i-e;let m;const f=t*(d.framePerSecond*s)/1e3+this._ratioOffset;let A,v=0;if(this._previousDelay=t,this._previousRatio=f,!n&&i>=e&&f>=p)g=!1,v=d._getKeyValue(this._maxValue);else if(!n&&e>=i&&f<=p)g=!1,v=d._getKeyValue(this._minValue);else if(this._animationState.loopMode!==o.f.ANIMATIONLOOPMODE_CYCLE){const t=i.toString()+e.toString();if(!this._offsetsCache[t]){this._animationState.repeatCount=0,this._animationState.loopMode=o.f.ANIMATIONLOOPMODE_CYCLE;const n=d._interpolate(e,this._animationState),s=d._interpolate(i,this._animationState);switch(this._animationState.loopMode=this._getCorrectLoopMode(),d.dataType){case o.f.ANIMATIONTYPE_FLOAT:this._offsetsCache[t]=s-n;break;case o.f.ANIMATIONTYPE_QUATERNION:case o.f.ANIMATIONTYPE_VECTOR3:case o.f.ANIMATIONTYPE_VECTOR2:case o.f.ANIMATIONTYPE_SIZE:case o.f.ANIMATIONTYPE_COLOR3:this._offsetsCache[t]=s.subtract(n)}this._highLimitsCache[t]=s}v=this._highLimitsCache[t],m=this._offsetsCache[t]}if(void 0===m)switch(d.dataType){case o.f.ANIMATIONTYPE_FLOAT:m=0;break;case o.f.ANIMATIONTYPE_QUATERNION:m=r;break;case o.f.ANIMATIONTYPE_VECTOR3:m=h;break;case o.f.ANIMATIONTYPE_VECTOR2:m=l;break;case o.f.ANIMATIONTYPE_SIZE:m=u;break;case o.f.ANIMATIONTYPE_COLOR3:m=c}if(this._host&&this._host.syncRoot){const t=this._host.syncRoot;A=e+(i-e)*((t.masterFrame-t.fromFrame)/(t.toFrame-t.fromFrame))}else A=f>0&&e>i||f<0&&e<i?g&&0!==p?i+f%p:e:g&&0!==p?e+f%p:i;const T=this._events;if(s>0&&this.currentFrame>A||s<0&&this.currentFrame<A){this._onLoop();for(let t=0;t<T.length;t++)T[t].onlyOnce||(T[t].isDone=!1);this._animationState.key=s>0?0:d.getKeys().length-1}this._currentFrame=A,this._animationState.repeatCount=0===p?0:f/p>>0,this._animationState.highLimitValue=v,this._animationState.offsetValue=m;const y=d._interpolate(A,this._animationState);if(this.setValue(y,a),T.length)for(let t=0;t<T.length;t++)if(p>0&&A>=T[t].frame&&T[t].frame>=e||p<0&&A<=T[t].frame&&T[t].frame<=e){const e=T[t];e.isDone||(e.onlyOnce&&(T.splice(t,1),t--),e.isDone=!0,e.action(A))}return g||(this._stopped=!0),g}}},35716:(t,e,i)=>{"use strict";var n=i(37290),s=(i(13514),i(15210));var o=i(62897),a=i(84318),r=i(80352);n.D.AudioEngineFactory=(t,e,i)=>new h(t,e,i);class h{get audioContext(){return this._audioContextInitialized?this.unlocked||this._muteButton||this._displayMuteButton():this._initializeAudioContext(),this._audioContext}constructor(t=null,e=null,i=null){if(this._audioContext=null,this._audioContextInitialized=!1,this._muteButton=null,this._audioDestination=null,this.canUseWebAudio=!1,this.WarnedWebAudioUnsupported=!1,this.isMP3supported=!1,this.isOGGsupported=!1,this.unlocked=!0,this.useCustomUnlockedButton=!1,this.onAudioUnlockedObservable=new o.y$,this.onAudioLockedObservable=new o.y$,this._tryToRun=!1,this._onResize=()=>{this._moveButtonToTopLeft()},!(0,r.CG)())return;void 0!==window.AudioContext&&(this.canUseWebAudio=!0);const n=document.createElement("audio");this._hostElement=t,this._audioContext=e,this._audioDestination=i;try{n&&n.canPlayType&&(n.canPlayType('audio/mpeg; codecs="mp3"').replace(/^no$/,"")||n.canPlayType("audio/mp3").replace(/^no$/,""))&&(this.isMP3supported=!0)}catch(t){}try{n&&n.canPlayType&&n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.isOGGsupported=!0)}catch(t){}}lock(){this._triggerSuspendedState()}unlock(){this._triggerRunningState()}_resumeAudioContext(){let t;return void 0!==this._audioContext.resume&&(t=this._audioContext.resume()),t||Promise.resolve()}_initializeAudioContext(){try{this.canUseWebAudio&&(this._audioContext||(this._audioContext=new AudioContext),this.masterGain=this._audioContext.createGain(),this.masterGain.gain.value=1,this._audioDestination||(this._audioDestination=this._audioContext.destination),this.masterGain.connect(this._audioDestination),this._audioContextInitialized=!0,"running"===this._audioContext.state&&this._triggerRunningState())}catch(t){this.canUseWebAudio=!1,a.Y.Error("Web Audio: "+t.message)}}_triggerRunningState(){this._tryToRun||(this._tryToRun=!0,this._resumeAudioContext().then((()=>{this._tryToRun=!1,this._muteButton&&this._hideMuteButton(),this.unlocked=!0,this.onAudioUnlockedObservable.notifyObservers(this)})).catch((()=>{this._tryToRun=!1,this.unlocked=!1})))}_triggerSuspendedState(){this.unlocked=!1,this.onAudioLockedObservable.notifyObservers(this),this._displayMuteButton()}_displayMuteButton(){if(this.useCustomUnlockedButton||this._muteButton)return;this._muteButton=document.createElement("BUTTON"),this._muteButton.className="babylonUnmuteIcon",this._muteButton.id="babylonUnmuteIconBtn",this._muteButton.title="Unmute";const t=".babylonUnmuteIcon { position: absolute; left: 20px; top: 20px; height: 40px; width: 60px; background-color: rgba(51,51,51,0.7); background-image: url("+(window.SVGSVGElement?"data:image/svg+xml;charset=UTF-8,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2239%22%20height%3D%2232%22%20viewBox%3D%220%200%2039%2032%22%3E%3Cpath%20fill%3D%22white%22%20d%3D%22M9.625%2018.938l-0.031%200.016h-4.953q-0.016%200-0.031-0.016v-12.453q0-0.016%200.031-0.016h4.953q0.031%200%200.031%200.016v12.453zM12.125%207.688l8.719-8.703v27.453l-8.719-8.719-0.016-0.047v-9.938zM23.359%207.875l1.406-1.406%204.219%204.203%204.203-4.203%201.422%201.406-4.219%204.219%204.219%204.203-1.484%201.359-4.141-4.156-4.219%204.219-1.406-1.422%204.219-4.203z%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E":"https://cdn.babylonjs.com/Assets/audio.png")+");  background-size: 80%; background-repeat:no-repeat; background-position: center; background-position-y: 4px; border: none; outline: none; transition: transform 0.125s ease-out; cursor: pointer; z-index: 9999; } .babylonUnmuteIcon:hover { transform: scale(1.05) } .babylonUnmuteIcon:active { background-color: rgba(51,51,51,1) }",e=document.createElement("style");e.appendChild(document.createTextNode(t)),document.getElementsByTagName("head")[0].appendChild(e),document.body.appendChild(this._muteButton),this._moveButtonToTopLeft(),this._muteButton.addEventListener("touchend",(()=>{this._triggerRunningState()}),!0),this._muteButton.addEventListener("click",(()=>{this._triggerRunningState()}),!0),window.addEventListener("resize",this._onResize)}_moveButtonToTopLeft(){this._hostElement&&this._muteButton&&(this._muteButton.style.top=this._hostElement.offsetTop+20+"px",this._muteButton.style.left=this._hostElement.offsetLeft+20+"px")}_hideMuteButton(){this._muteButton&&(document.body.removeChild(this._muteButton),this._muteButton=null)}dispose(){this.canUseWebAudio&&this._audioContextInitialized&&(this._connectedAnalyser&&this._audioContext&&(this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser.dispose(),this.masterGain.disconnect(),this.masterGain.connect(this._audioContext.destination),this._connectedAnalyser=null),this.masterGain.gain.value=1),this.WarnedWebAudioUnsupported=!1,this._hideMuteButton(),window.removeEventListener("resize",this._onResize),this.onAudioUnlockedObservable.clear(),this.onAudioLockedObservable.clear()}getGlobalVolume(){return this.canUseWebAudio&&this._audioContextInitialized?this.masterGain.gain.value:-1}setGlobalVolume(t){this.canUseWebAudio&&this._audioContextInitialized&&(this.masterGain.gain.value=t)}connectToAnalyser(t){this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas(),this.canUseWebAudio&&this._audioContextInitialized&&this._audioContext&&(this._connectedAnalyser=t,this.masterGain.disconnect(),this._connectedAnalyser.connectAudioNodes(this.masterGain,this._audioContext.destination))}}var l=i(5007);class u{constructor(t,e={}){this.id=-1,this._isInitialized=!1,(t=t||s.l.LastCreatedScene)&&(this._scene=t,this.soundCollection=new Array,this._options=e,!this._options.mainTrack&&this._scene.soundTracks&&(this._scene.soundTracks.push(this),this.id=this._scene.soundTracks.length-1))}_initializeSoundTrackAudioGraph(){var t;(null===(t=n.D.audioEngine)||void 0===t?void 0:t.canUseWebAudio)&&n.D.audioEngine.audioContext&&(this._outputAudioNode=n.D.audioEngine.audioContext.createGain(),this._outputAudioNode.connect(n.D.audioEngine.masterGain),this._options&&this._options.volume&&(this._outputAudioNode.gain.value=this._options.volume),this._isInitialized=!0)}dispose(){if(n.D.audioEngine&&n.D.audioEngine.canUseWebAudio){for(this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas();this.soundCollection.length;)this.soundCollection[0].dispose();this._outputAudioNode&&this._outputAudioNode.disconnect(),this._outputAudioNode=null}}addSound(t){var e;this._isInitialized||this._initializeSoundTrackAudioGraph(),(null===(e=n.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._outputAudioNode&&t.connectToSoundTrackAudioNode(this._outputAudioNode),t.soundTrackId&&(-1===t.soundTrackId?this._scene.mainSoundTrack.removeSound(t):this._scene.soundTracks&&this._scene.soundTracks[t.soundTrackId].removeSound(t)),this.soundCollection.push(t),t.soundTrackId=this.id}removeSound(t){const e=this.soundCollection.indexOf(t);-1!==e&&this.soundCollection.splice(e,1)}setVolume(t){var e;(null===(e=n.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._outputAudioNode&&(this._outputAudioNode.gain.value=t)}switchPanningModelToHRTF(){var t;if(null===(t=n.D.audioEngine)||void 0===t?void 0:t.canUseWebAudio)for(let t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToHRTF()}switchPanningModelToEqualPower(){var t;if(null===(t=n.D.audioEngine)||void 0===t?void 0:t.canUseWebAudio)for(let t=0;t<this.soundCollection.length;t++)this.soundCollection[t].switchPanningModelToEqualPower()}connectToAnalyser(t){var e;this._connectedAnalyser&&this._connectedAnalyser.stopDebugCanvas(),this._connectedAnalyser=t,(null===(e=n.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._outputAudioNode&&(this._outputAudioNode.disconnect(),this._connectedAnalyser.connectAudioNodes(this._outputAudioNode,n.D.audioEngine.masterGain))}}var c=i(58095),d=i(85627),_=i(65273),g=i(57755),p=i(29945);g.p.AddParser(d.l.NAME_AUDIO,((t,e,i,s)=>{var o;let a,r=[];if(i.sounds=i.sounds||[],void 0!==t.sounds&&null!==t.sounds)for(let h=0,u=t.sounds.length;h<u;h++){const u=t.sounds[h];(null===(o=n.D.audioEngine)||void 0===o?void 0:o.canUseWebAudio)?(u.url||(u.url=u.name),r[u.url]?i.sounds.push(l.$.Parse(u,e,s,r[u.url])):(a=l.$.Parse(u,e,s),r[u.url]=a,i.sounds.push(a))):i.sounds.push(new l.$(u.name,null,e))}r=[]})),Object.defineProperty(_.x.prototype,"mainSoundTrack",{get:function(){let t=this._getComponent(d.l.NAME_AUDIO);return t||(t=new m(this),this._addComponent(t)),this._mainSoundTrack||(this._mainSoundTrack=new u(this,{mainTrack:!0})),this._mainSoundTrack},enumerable:!0,configurable:!0}),_.x.prototype.getSoundByName=function(t){let e;for(e=0;e<this.mainSoundTrack.soundCollection.length;e++)if(this.mainSoundTrack.soundCollection[e].name===t)return this.mainSoundTrack.soundCollection[e];if(this.soundTracks)for(let i=0;i<this.soundTracks.length;i++)for(e=0;e<this.soundTracks[i].soundCollection.length;e++)if(this.soundTracks[i].soundCollection[e].name===t)return this.soundTracks[i].soundCollection[e];return null},Object.defineProperty(_.x.prototype,"audioEnabled",{get:function(){let t=this._getComponent(d.l.NAME_AUDIO);return t||(t=new m(this),this._addComponent(t)),t.audioEnabled},set:function(t){let e=this._getComponent(d.l.NAME_AUDIO);e||(e=new m(this),this._addComponent(e)),t?e.enableAudio():e.disableAudio()},enumerable:!0,configurable:!0}),Object.defineProperty(_.x.prototype,"headphone",{get:function(){let t=this._getComponent(d.l.NAME_AUDIO);return t||(t=new m(this),this._addComponent(t)),t.headphone},set:function(t){let e=this._getComponent(d.l.NAME_AUDIO);e||(e=new m(this),this._addComponent(e)),t?e.switchAudioModeForHeadphones():e.switchAudioModeForNormalSpeakers()},enumerable:!0,configurable:!0}),Object.defineProperty(_.x.prototype,"audioListenerPositionProvider",{get:function(){let t=this._getComponent(d.l.NAME_AUDIO);return t||(t=new m(this),this._addComponent(t)),t.audioListenerPositionProvider},set:function(t){let e=this._getComponent(d.l.NAME_AUDIO);if(e||(e=new m(this),this._addComponent(e)),"function"!=typeof t)throw new Error("The value passed to [Scene.audioListenerPositionProvider] must be a function that returns a Vector3");e.audioListenerPositionProvider=t},enumerable:!0,configurable:!0}),Object.defineProperty(_.x.prototype,"audioListenerRotationProvider",{get:function(){let t=this._getComponent(d.l.NAME_AUDIO);return t||(t=new m(this),this._addComponent(t)),t.audioListenerRotationProvider},set:function(t){let e=this._getComponent(d.l.NAME_AUDIO);if(e||(e=new m(this),this._addComponent(e)),"function"!=typeof t)throw new Error("The value passed to [Scene.audioListenerRotationProvider] must be a function that returns a Vector3");e.audioListenerRotationProvider=t},enumerable:!0,configurable:!0}),Object.defineProperty(_.x.prototype,"audioPositioningRefreshRate",{get:function(){let t=this._getComponent(d.l.NAME_AUDIO);return t||(t=new m(this),this._addComponent(t)),t.audioPositioningRefreshRate},set:function(t){let e=this._getComponent(d.l.NAME_AUDIO);e||(e=new m(this),this._addComponent(e)),e.audioPositioningRefreshRate=t},enumerable:!0,configurable:!0});class m{get audioEnabled(){return this._audioEnabled}get headphone(){return this._headphone}constructor(t){this.name=d.l.NAME_AUDIO,this._audioEnabled=!0,this._headphone=!1,this.audioPositioningRefreshRate=500,this.audioListenerPositionProvider=null,this.audioListenerRotationProvider=null,this._cachedCameraDirection=new c.P,this._cachedCameraPosition=new c.P,this._lastCheck=0,this._invertMatrixTemp=new c.y3,this._cameraDirectionTemp=new c.P,(t=t||s.l.LastCreatedScene)&&(this.scene=t,t.soundTracks=new Array,t.sounds=new Array)}register(){this.scene._afterRenderStage.registerStep(d.l.STEP_AFTERRENDER_AUDIO,this,this._afterRender)}rebuild(){}serialize(t){if(t.sounds=[],this.scene.soundTracks)for(let e=0;e<this.scene.soundTracks.length;e++){const i=this.scene.soundTracks[e];for(let e=0;e<i.soundCollection.length;e++)t.sounds.push(i.soundCollection[e].serialize())}}addFromContainer(t){t.sounds&&t.sounds.forEach((t=>{t.play(),t.autoplay=!0,this.scene.mainSoundTrack.addSound(t)}))}removeFromContainer(t,e=!1){t.sounds&&t.sounds.forEach((t=>{t.stop(),t.autoplay=!1,this.scene.mainSoundTrack.removeSound(t),e&&t.dispose()}))}dispose(){const t=this.scene;if(t._mainSoundTrack&&t.mainSoundTrack.dispose(),t.soundTracks)for(let e=0;e<t.soundTracks.length;e++)t.soundTracks[e].dispose()}disableAudio(){const t=this.scene;let e;for(this._audioEnabled=!1,n.D.audioEngine&&n.D.audioEngine.audioContext&&n.D.audioEngine.audioContext.suspend(),e=0;e<t.mainSoundTrack.soundCollection.length;e++)t.mainSoundTrack.soundCollection[e].pause();if(t.soundTracks)for(e=0;e<t.soundTracks.length;e++)for(let i=0;i<t.soundTracks[e].soundCollection.length;i++)t.soundTracks[e].soundCollection[i].pause()}enableAudio(){const t=this.scene;let e;for(this._audioEnabled=!0,n.D.audioEngine&&n.D.audioEngine.audioContext&&n.D.audioEngine.audioContext.resume(),e=0;e<t.mainSoundTrack.soundCollection.length;e++)t.mainSoundTrack.soundCollection[e].isPaused&&t.mainSoundTrack.soundCollection[e].play();if(t.soundTracks)for(e=0;e<t.soundTracks.length;e++)for(let i=0;i<t.soundTracks[e].soundCollection.length;i++)t.soundTracks[e].soundCollection[i].isPaused&&t.soundTracks[e].soundCollection[i].play()}switchAudioModeForHeadphones(){const t=this.scene;if(this._headphone=!0,t.mainSoundTrack.switchPanningModelToHRTF(),t.soundTracks)for(let e=0;e<t.soundTracks.length;e++)t.soundTracks[e].switchPanningModelToHRTF()}switchAudioModeForNormalSpeakers(){const t=this.scene;if(this._headphone=!1,t.mainSoundTrack.switchPanningModelToEqualPower(),t.soundTracks)for(let e=0;e<t.soundTracks.length;e++)t.soundTracks[e].switchPanningModelToEqualPower()}_afterRender(){const t=p.F.Now;if(this._lastCheck&&t-this._lastCheck<this.audioPositioningRefreshRate)return;this._lastCheck=t;const e=this.scene;if(!this._audioEnabled||!e._mainSoundTrack||!e.soundTracks||0===e._mainSoundTrack.soundCollection.length&&1===e.soundTracks.length)return;const i=n.D.audioEngine;if(i&&i.audioContext){let t,n=e.activeCamera;if(e.activeCameras&&e.activeCameras.length>0&&(n=e.activeCameras[0]),this.audioListenerPositionProvider){const t=this.audioListenerPositionProvider();i.audioContext.listener.setPosition(t.x||0,t.y||0,t.z||0)}else n?this._cachedCameraPosition.equals(n.globalPosition)||(this._cachedCameraPosition.copyFrom(n.globalPosition),i.audioContext.listener.setPosition(n.globalPosition.x,n.globalPosition.y,n.globalPosition.z)):i.audioContext.listener.setPosition(0,0,0);if(this.audioListenerRotationProvider){const t=this.audioListenerRotationProvider();i.audioContext.listener.setOrientation(t.x||0,t.y||0,t.z||0,0,1,0)}else n?(n.rigCameras&&n.rigCameras.length>0&&(n=n.rigCameras[0]),n.getViewMatrix().invertToRef(this._invertMatrixTemp),c.P.TransformNormalToRef(m._CameraDirection,this._invertMatrixTemp,this._cameraDirectionTemp),this._cameraDirectionTemp.normalize(),isNaN(this._cameraDirectionTemp.x)||isNaN(this._cameraDirectionTemp.y)||isNaN(this._cameraDirectionTemp.z)||this._cachedCameraDirection.equals(this._cameraDirectionTemp)||(this._cachedCameraDirection.copyFrom(this._cameraDirectionTemp),i.audioContext.listener.setOrientation(this._cameraDirectionTemp.x,this._cameraDirectionTemp.y,this._cameraDirectionTemp.z,0,1,0))):i.audioContext.listener.setOrientation(0,0,0,0,1,0);for(t=0;t<e.mainSoundTrack.soundCollection.length;t++){const i=e.mainSoundTrack.soundCollection[t];i.useCustomAttenuation&&i.updateDistanceFromListener()}if(e.soundTracks)for(t=0;t<e.soundTracks.length;t++)for(let i=0;i<e.soundTracks[t].soundCollection.length;i++){const n=e.soundTracks[t].soundCollection[i];n.useCustomAttenuation&&n.updateDistanceFromListener()}}}}m._CameraDirection=new c.P(0,0,-1),l.$._SceneComponentInitialization=t=>{let e=t._getComponent(d.l.NAME_AUDIO);e||(e=new m(t),t._addComponent(e))};i(59020)},5007:(t,e,i)=>{"use strict";i.d(e,{$:()=>u});var n=i(13514),s=i(62897),o=i(58095),a=i(37290),r=i(84318),h=i(77851),l=i(15210);class u{get loop(){return this._loop}set loop(t){t!==this._loop&&(this._loop=t,this.updateOptions({loop:t}))}get currentTime(){var t;if(this._htmlAudioElement)return this._htmlAudioElement.currentTime;if((null===(t=a.D.audioEngine)||void 0===t?void 0:t.audioContext)&&(this.isPlaying||this.isPaused)){const t=this.isPaused?0:a.D.audioEngine.audioContext.currentTime-this._startTime;return this._currentTime+t}return 0}get spatialSound(){return this._spatialSound}set spatialSound(t){var e;this._spatialSound=t,this._spatialSound&&(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&a.D.audioEngine.audioContext&&this._createSpatialParameters()}constructor(t,e,i,h=null,c){var d,_,g,p,m;if(this.autoplay=!1,this._loop=!1,this.useCustomAttenuation=!1,this.isPlaying=!1,this.isPaused=!1,this.refDistance=1,this.rolloffFactor=1,this.maxDistance=100,this.distanceModel="linear",this.metadata=null,this.onEndedObservable=new s.y$,this._spatialSound=!1,this._panningModel="equalpower",this._playbackRate=1,this._streaming=!1,this._startTime=0,this._currentTime=0,this._position=o.P.Zero(),this._localDirection=new o.P(1,0,0),this._volume=1,this._isReadyToPlay=!1,this._isDirectional=!1,this._coneInnerAngle=360,this._coneOuterAngle=360,this._coneOuterGain=0,this._isOutputConnected=!1,this._urlType="Unknown",this.name=t,i=i||l.l.LastCreatedScene)if(this._scene=i,u._SceneComponentInitialization(i),this._readyToPlayCallback=h,this._customAttenuationFunction=(t,e,i,n,s)=>e<i?t*(1-e/i):0,c&&(this.autoplay=c.autoplay||!1,this._loop=c.loop||!1,void 0!==c.volume&&(this._volume=c.volume),this._spatialSound=null!==(d=c.spatialSound)&&void 0!==d&&d,this.maxDistance=null!==(_=c.maxDistance)&&void 0!==_?_:100,this.useCustomAttenuation=null!==(g=c.useCustomAttenuation)&&void 0!==g&&g,this.rolloffFactor=c.rolloffFactor||1,this.refDistance=c.refDistance||1,this.distanceModel=c.distanceModel||"linear",this._playbackRate=c.playbackRate||1,this._streaming=null!==(p=c.streaming)&&void 0!==p&&p,this._length=c.length,this._offset=c.offset),(null===(m=a.D.audioEngine)||void 0===m?void 0:m.canUseWebAudio)&&a.D.audioEngine.audioContext){this._soundGain=a.D.audioEngine.audioContext.createGain(),this._soundGain.gain.value=this._volume,this._inputAudioNode=this._soundGain,this._outputAudioNode=this._soundGain,this._spatialSound&&this._createSpatialParameters(),this._scene.mainSoundTrack.addSound(this);let t=!0;if(e)try{"string"==typeof e?this._urlType="String":e instanceof ArrayBuffer?this._urlType="ArrayBuffer":e instanceof HTMLMediaElement?this._urlType="MediaElement":e instanceof MediaStream?this._urlType="MediaStream":e instanceof AudioBuffer?this._urlType="AudioBuffer":Array.isArray(e)&&(this._urlType="Array");let i=[],s=!1;switch(this._urlType){case"MediaElement":this._streaming=!0,this._isReadyToPlay=!0,this._streamingSource=a.D.audioEngine.audioContext.createMediaElementSource(e),this.autoplay&&this.play(0,this._offset,this._length),this._readyToPlayCallback&&this._readyToPlayCallback();break;case"MediaStream":this._streaming=!0,this._isReadyToPlay=!0,this._streamingSource=a.D.audioEngine.audioContext.createMediaStreamSource(e),this.autoplay&&this.play(0,this._offset,this._length),this._readyToPlayCallback&&this._readyToPlayCallback();break;case"ArrayBuffer":e.byteLength>0&&(s=!0,this._soundLoaded(e));break;case"AudioBuffer":this._audioBufferLoaded(e);break;case"String":i.push(e);case"Array":0===i.length&&(i=e);for(let t=0;t<i.length;t++){const e=i[t];if(s=c&&c.skipCodecCheck||-1!==e.indexOf(".mp3",e.length-4)&&a.D.audioEngine.isMP3supported||-1!==e.indexOf(".ogg",e.length-4)&&a.D.audioEngine.isOGGsupported||-1!==e.indexOf(".wav",e.length-4)||-1!==e.indexOf(".m4a",e.length-4)||-1!==e.indexOf(".mp4",e.length-4)||-1!==e.indexOf("blob:"),s){this._streaming?(this._htmlAudioElement=new Audio(e),this._htmlAudioElement.controls=!1,this._htmlAudioElement.loop=this.loop,n.w1.SetCorsBehavior(e,this._htmlAudioElement),this._htmlAudioElement.preload="auto",this._htmlAudioElement.addEventListener("canplaythrough",(()=>{this._isReadyToPlay=!0,this.autoplay&&this.play(0,this._offset,this._length),this._readyToPlayCallback&&this._readyToPlayCallback()})),document.body.appendChild(this._htmlAudioElement),this._htmlAudioElement.load()):this._scene._loadFile(e,(t=>{this._soundLoaded(t)}),void 0,!0,!0,(t=>{t&&r.Y.Error("XHR "+t.status+" error on: "+e+"."),r.Y.Error("Sound creation aborted."),this._scene.mainSoundTrack.removeSound(this)}));break}}break;default:t=!1}t?s||(this._isReadyToPlay=!0,this._readyToPlayCallback&&setTimeout((()=>{this._readyToPlayCallback&&this._readyToPlayCallback()}),1e3)):r.Y.Error("Parameter must be a URL to the sound, an Array of URLs (.mp3 & .ogg) or an ArrayBuffer of the sound.")}catch(t){r.Y.Error("Unexpected error. Sound creation aborted."),this._scene.mainSoundTrack.removeSound(this)}}else this._scene.mainSoundTrack.addSound(this),a.D.audioEngine&&!a.D.audioEngine.WarnedWebAudioUnsupported&&(r.Y.Error("Web Audio is not supported by your browser."),a.D.audioEngine.WarnedWebAudioUnsupported=!0),this._readyToPlayCallback&&setTimeout((()=>{this._readyToPlayCallback&&this._readyToPlayCallback()}),1e3)}dispose(){var t;(null===(t=a.D.audioEngine)||void 0===t?void 0:t.canUseWebAudio)&&(this.isPlaying&&this.stop(),this._isReadyToPlay=!1,-1===this.soundTrackId?this._scene.mainSoundTrack.removeSound(this):this._scene.soundTracks&&this._scene.soundTracks[this.soundTrackId].removeSound(this),this._soundGain&&(this._soundGain.disconnect(),this._soundGain=null),this._soundPanner&&(this._soundPanner.disconnect(),this._soundPanner=null),this._soundSource&&(this._soundSource.disconnect(),this._soundSource=null),this._audioBuffer=null,this._htmlAudioElement&&(this._htmlAudioElement.pause(),this._htmlAudioElement.src="",document.body.removeChild(this._htmlAudioElement)),this._streamingSource&&this._streamingSource.disconnect(),this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._connectedTransformNode=null))}isReady(){return this._isReadyToPlay}getClassName(){return"Sound"}_audioBufferLoaded(t){var e;(null===(e=a.D.audioEngine)||void 0===e?void 0:e.audioContext)&&(this._audioBuffer=t,this._isReadyToPlay=!0,this.autoplay&&this.play(0,this._offset,this._length),this._readyToPlayCallback&&this._readyToPlayCallback())}_soundLoaded(t){var e;(null===(e=a.D.audioEngine)||void 0===e?void 0:e.audioContext)&&a.D.audioEngine.audioContext.decodeAudioData(t,(t=>{this._audioBufferLoaded(t)}),(t=>{r.Y.Error("Error while decoding audio data for: "+this.name+" / Error: "+t)}))}setAudioBuffer(t){var e;(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&(this._audioBuffer=t,this._isReadyToPlay=!0)}updateOptions(t){var e,i,n,s,o,a,r,h,l,u;t&&(this.loop=null!==(e=t.loop)&&void 0!==e?e:this.loop,this.maxDistance=null!==(i=t.maxDistance)&&void 0!==i?i:this.maxDistance,this.useCustomAttenuation=null!==(n=t.useCustomAttenuation)&&void 0!==n?n:this.useCustomAttenuation,this.rolloffFactor=null!==(s=t.rolloffFactor)&&void 0!==s?s:this.rolloffFactor,this.refDistance=null!==(o=t.refDistance)&&void 0!==o?o:this.refDistance,this.distanceModel=null!==(a=t.distanceModel)&&void 0!==a?a:this.distanceModel,this._playbackRate=null!==(r=t.playbackRate)&&void 0!==r?r:this._playbackRate,this._length=null!==(h=t.length)&&void 0!==h?h:void 0,this._setOffset(null!==(l=t.offset)&&void 0!==l?l:void 0),this.setVolume(null!==(u=t.volume)&&void 0!==u?u:this._volume),this._updateSpatialParameters(),this.isPlaying&&(this._streaming&&this._htmlAudioElement?(this._htmlAudioElement.playbackRate=this._playbackRate,this._htmlAudioElement.loop!==this.loop&&(this._htmlAudioElement.loop=this.loop)):this._soundSource&&(this._soundSource.playbackRate.value=this._playbackRate,this._soundSource.loop!==this.loop&&(this._soundSource.loop=this.loop),void 0!==this._offset&&this._soundSource.loopStart!==this._offset&&(this._soundSource.loopStart=this._offset),void 0!==this._length&&this._length!==this._soundSource.loopEnd&&(this._soundSource.loopEnd=(0|this._offset)+this._length))))}_createSpatialParameters(){var t,e;(null===(t=a.D.audioEngine)||void 0===t?void 0:t.canUseWebAudio)&&a.D.audioEngine.audioContext&&(this._scene.headphone&&(this._panningModel="HRTF"),this._soundPanner=null!==(e=this._soundPanner)&&void 0!==e?e:a.D.audioEngine.audioContext.createPanner(),this._soundPanner&&this._outputAudioNode&&(this._updateSpatialParameters(),this._soundPanner.connect(this._outputAudioNode),this._inputAudioNode=this._soundPanner))}_updateSpatialParameters(){this._spatialSound&&this._soundPanner&&(this.useCustomAttenuation?(this._soundPanner.distanceModel="linear",this._soundPanner.maxDistance=Number.MAX_VALUE,this._soundPanner.refDistance=1,this._soundPanner.rolloffFactor=1,this._soundPanner.panningModel=this._panningModel):(this._soundPanner.distanceModel=this.distanceModel,this._soundPanner.maxDistance=this.maxDistance,this._soundPanner.refDistance=this.refDistance,this._soundPanner.rolloffFactor=this.rolloffFactor,this._soundPanner.panningModel=this._panningModel))}switchPanningModelToHRTF(){this._panningModel="HRTF",this._switchPanningModel()}switchPanningModelToEqualPower(){this._panningModel="equalpower",this._switchPanningModel()}_switchPanningModel(){var t;(null===(t=a.D.audioEngine)||void 0===t?void 0:t.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&(this._soundPanner.panningModel=this._panningModel)}connectToSoundTrackAudioNode(t){var e;(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._outputAudioNode&&(this._isOutputConnected&&this._outputAudioNode.disconnect(),this._outputAudioNode.connect(t),this._isOutputConnected=!0)}setDirectionalCone(t,e,i){e<t?r.Y.Error("setDirectionalCone(): outer angle of the cone must be superior or equal to the inner angle."):(this._coneInnerAngle=t,this._coneOuterAngle=e,this._coneOuterGain=i,this._isDirectional=!0,this.isPlaying&&this.loop&&(this.stop(),this.play(0,this._offset,this._length)))}get directionalConeInnerAngle(){return this._coneInnerAngle}set directionalConeInnerAngle(t){var e;if(t!=this._coneInnerAngle){if(this._coneOuterAngle<t)return void r.Y.Error("directionalConeInnerAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneInnerAngle=t,(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle)}}get directionalConeOuterAngle(){return this._coneOuterAngle}set directionalConeOuterAngle(t){var e;if(t!=this._coneOuterAngle){if(t<this._coneInnerAngle)return void r.Y.Error("directionalConeOuterAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneOuterAngle=t,(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&(this._soundPanner.coneOuterAngle=this._coneOuterAngle)}}setPosition(t){var e;t.equals(this._position)||(this._position.copyFrom(t),(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&!isNaN(this._position.x)&&!isNaN(this._position.y)&&!isNaN(this._position.z)&&(this._soundPanner.positionX.value=this._position.x,this._soundPanner.positionY.value=this._position.y,this._soundPanner.positionZ.value=this._position.z))}setLocalDirectionToMesh(t){var e;this._localDirection=t,(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._connectedTransformNode&&this.isPlaying&&this._updateDirection()}_updateDirection(){if(!this._connectedTransformNode||!this._soundPanner)return;const t=this._connectedTransformNode.getWorldMatrix(),e=o.P.TransformNormal(this._localDirection,t);e.normalize(),this._soundPanner.orientationX.value=e.x,this._soundPanner.orientationY.value=e.y,this._soundPanner.orientationZ.value=e.z}updateDistanceFromListener(){var t;if((null===(t=a.D.audioEngine)||void 0===t?void 0:t.canUseWebAudio)&&this._connectedTransformNode&&this.useCustomAttenuation&&this._soundGain&&this._scene.activeCamera){const t=this._connectedTransformNode.getDistanceToCamera(this._scene.activeCamera);this._soundGain.gain.value=this._customAttenuationFunction(this._volume,t,this.maxDistance,this.refDistance,this.rolloffFactor)}}setAttenuationFunction(t){this._customAttenuationFunction=t}play(t,e,i){var n,s,o,h;if(this._isReadyToPlay&&this._scene.audioEnabled&&(null===(n=a.D.audioEngine)||void 0===n?void 0:n.audioContext))try{let n=t?(null===(s=a.D.audioEngine)||void 0===s?void 0:s.audioContext.currentTime)+t:null===(o=a.D.audioEngine)||void 0===o?void 0:o.audioContext.currentTime;if(this._soundSource&&this._streamingSource||this._spatialSound&&this._soundPanner&&(isNaN(this._position.x)||isNaN(this._position.y)||isNaN(this._position.z)||(this._soundPanner.positionX.value=this._position.x,this._soundPanner.positionY.value=this._position.y,this._soundPanner.positionZ.value=this._position.z),this._isDirectional&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle,this._soundPanner.coneOuterAngle=this._coneOuterAngle,this._soundPanner.coneOuterGain=this._coneOuterGain,this._connectedTransformNode?this._updateDirection():this._soundPanner.setOrientation(this._localDirection.x,this._localDirection.y,this._localDirection.z))),this._streaming){if(this._streamingSource||(this._streamingSource=a.D.audioEngine.audioContext.createMediaElementSource(this._htmlAudioElement),this._htmlAudioElement.onended=()=>{this._onended()},this._htmlAudioElement.playbackRate=this._playbackRate),this._streamingSource.disconnect(),this._inputAudioNode&&this._streamingSource.connect(this._inputAudioNode),this._htmlAudioElement){const t=()=>{var e,i;if(null===(e=a.D.audioEngine)||void 0===e?void 0:e.unlocked){const e=this._htmlAudioElement.play();void 0!==e&&e.catch((()=>{var e,i;null===(e=a.D.audioEngine)||void 0===e||e.lock(),(this.loop||this.autoplay)&&(null===(i=a.D.audioEngine)||void 0===i||i.onAudioUnlockedObservable.addOnce((()=>{t()})))}))}else(this.loop||this.autoplay)&&(null===(i=a.D.audioEngine)||void 0===i||i.onAudioUnlockedObservable.addOnce((()=>{t()})))};t()}}else{const s=()=>{var s,o,r,h;if(null===(s=a.D.audioEngine)||void 0===s?void 0:s.audioContext){if(i=i||this._length,void 0!==e&&this._setOffset(e),this._soundSource){const t=this._soundSource;t.onended=()=>{t.disconnect()}}if(this._soundSource=null===(o=a.D.audioEngine)||void 0===o?void 0:o.audioContext.createBufferSource(),this._soundSource&&this._inputAudioNode){this._soundSource.buffer=this._audioBuffer,this._soundSource.connect(this._inputAudioNode),this._soundSource.loop=this.loop,void 0!==e&&(this._soundSource.loopStart=e),void 0!==i&&(this._soundSource.loopEnd=(0|e)+i),this._soundSource.playbackRate.value=this._playbackRate,this._soundSource.onended=()=>{this._onended()},n=t?(null===(r=a.D.audioEngine)||void 0===r?void 0:r.audioContext.currentTime)+t:a.D.audioEngine.audioContext.currentTime;const s=((this.isPaused?this.currentTime:0)+(null!==(h=this._offset)&&void 0!==h?h:0))%this._soundSource.buffer.duration;this._soundSource.start(n,s,this.loop?void 0:i)}}};"suspended"===(null===(h=a.D.audioEngine)||void 0===h?void 0:h.audioContext.state)?setTimeout((()=>{var t;"suspended"===(null===(t=a.D.audioEngine)||void 0===t?void 0:t.audioContext.state)?(a.D.audioEngine.lock(),(this.loop||this.autoplay)&&a.D.audioEngine.onAudioUnlockedObservable.addOnce((()=>{s()}))):s()}),500):s()}this._startTime=n,this.isPlaying=!0,this.isPaused=!1}catch(t){r.Y.Error("Error while trying to play audio: "+this.name+", "+t.message)}}_onended(){this.isPlaying=!1,this._startTime=0,this._currentTime=0,this.onended&&this.onended(),this.onEndedObservable.notifyObservers(this)}stop(t){var e;if(this.isPlaying){if(this._streaming)this._htmlAudioElement?(this._htmlAudioElement.pause(),this._htmlAudioElement.currentTime>0&&(this._htmlAudioElement.currentTime=0)):this._streamingSource.disconnect(),this.isPlaying=!1;else if((null===(e=a.D.audioEngine)||void 0===e?void 0:e.audioContext)&&this._soundSource){const e=t?a.D.audioEngine.audioContext.currentTime+t:void 0;this._soundSource.onended=()=>{this.isPlaying=!1,this.isPaused=!1,this._startTime=0,this._currentTime=0,this._soundSource&&(this._soundSource.onended=()=>{}),this._onended()},this._soundSource.stop(e)}}else this.isPaused&&(this.isPaused=!1,this._startTime=0,this._currentTime=0)}pause(){var t;this.isPlaying&&(this._streaming?(this._htmlAudioElement?this._htmlAudioElement.pause():this._streamingSource.disconnect(),this.isPlaying=!1,this.isPaused=!0):(null===(t=a.D.audioEngine)||void 0===t?void 0:t.audioContext)&&this._soundSource&&(this._soundSource.onended=()=>{},this._soundSource.stop(),this.isPlaying=!1,this.isPaused=!0,this._currentTime+=a.D.audioEngine.audioContext.currentTime-this._startTime))}setVolume(t,e){var i;(null===(i=a.D.audioEngine)||void 0===i?void 0:i.canUseWebAudio)&&this._soundGain&&(e&&a.D.audioEngine.audioContext?(this._soundGain.gain.cancelScheduledValues(a.D.audioEngine.audioContext.currentTime),this._soundGain.gain.setValueAtTime(this._soundGain.gain.value,a.D.audioEngine.audioContext.currentTime),this._soundGain.gain.linearRampToValueAtTime(t,a.D.audioEngine.audioContext.currentTime+e)):this._soundGain.gain.value=t),this._volume=t}setPlaybackRate(t){this._playbackRate=t,this.isPlaying&&(this._streaming&&this._htmlAudioElement?this._htmlAudioElement.playbackRate=this._playbackRate:this._soundSource&&(this._soundSource.playbackRate.value=this._playbackRate))}getPlaybackRate(){return this._playbackRate}getVolume(){return this._volume}attachToMesh(t){this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null),this._connectedTransformNode=t,this._spatialSound||(this._spatialSound=!0,this._createSpatialParameters(),this.isPlaying&&this.loop&&(this.stop(),this.play(0,this._offset,this._length))),this._onRegisterAfterWorldMatrixUpdate(this._connectedTransformNode),this._registerFunc=t=>this._onRegisterAfterWorldMatrixUpdate(t),this._connectedTransformNode.registerAfterWorldMatrixUpdate(this._registerFunc)}detachFromMesh(){this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null,this._connectedTransformNode=null)}_onRegisterAfterWorldMatrixUpdate(t){var e;if(t.getBoundingInfo){const e=t.getBoundingInfo();this.setPosition(e.boundingSphere.centerWorld)}else this.setPosition(t.absolutePosition);(null===(e=a.D.audioEngine)||void 0===e?void 0:e.canUseWebAudio)&&this._isDirectional&&this.isPlaying&&this._updateDirection()}clone(){if(this._streaming)return null;{const t=()=>{this._isReadyToPlay?(i._audioBuffer=this.getAudioBuffer(),i._isReadyToPlay=!0,i.autoplay&&i.play(0,this._offset,this._length)):setTimeout(t,300)},e={autoplay:this.autoplay,loop:this.loop,volume:this._volume,spatialSound:this._spatialSound,maxDistance:this.maxDistance,useCustomAttenuation:this.useCustomAttenuation,rolloffFactor:this.rolloffFactor,refDistance:this.refDistance,distanceModel:this.distanceModel},i=new u(this.name+"_cloned",new ArrayBuffer(0),this._scene,null,e);return this.useCustomAttenuation&&i.setAttenuationFunction(this._customAttenuationFunction),i.setPosition(this._position),i.setPlaybackRate(this._playbackRate),t(),i}}getAudioBuffer(){return this._audioBuffer}getSoundSource(){return this._soundSource}getSoundGain(){return this._soundGain}serialize(){const t={name:this.name,url:this.name,autoplay:this.autoplay,loop:this.loop,volume:this._volume,spatialSound:this._spatialSound,maxDistance:this.maxDistance,rolloffFactor:this.rolloffFactor,refDistance:this.refDistance,distanceModel:this.distanceModel,playbackRate:this._playbackRate,panningModel:this._panningModel,soundTrackId:this.soundTrackId,metadata:this.metadata};return this._spatialSound&&(this._connectedTransformNode&&(t.connectedMeshId=this._connectedTransformNode.id),t.position=this._position.asArray(),t.refDistance=this.refDistance,t.distanceModel=this.distanceModel,t.isDirectional=this._isDirectional,t.localDirectionToMesh=this._localDirection.asArray(),t.coneInnerAngle=this._coneInnerAngle,t.coneOuterAngle=this._coneOuterAngle,t.coneOuterGain=this._coneOuterGain),t}static Parse(t,e,i,n){const s=t.name;let a;a=t.url?i+t.url:i+s;const r={autoplay:t.autoplay,loop:t.loop,volume:t.volume,spatialSound:t.spatialSound,maxDistance:t.maxDistance,rolloffFactor:t.rolloffFactor,refDistance:t.refDistance,distanceModel:t.distanceModel,playbackRate:t.playbackRate};let h;if(n){const t=()=>{n._isReadyToPlay?(h._audioBuffer=n.getAudioBuffer(),h._isReadyToPlay=!0,h.autoplay&&h.play(0,h._offset,h._length)):setTimeout(t,300)};h=new u(s,new ArrayBuffer(0),e,null,r),t()}else h=new u(s,a,e,(()=>{e.removePendingData(h)}),r),e.addPendingData(h);if(t.position){const e=o.P.FromArray(t.position);h.setPosition(e)}if(t.isDirectional&&(h.setDirectionalCone(t.coneInnerAngle||360,t.coneOuterAngle||360,t.coneOuterGain||0),t.localDirectionToMesh)){const e=o.P.FromArray(t.localDirectionToMesh);h.setLocalDirectionToMesh(e)}if(t.connectedMeshId){const i=e.getMeshById(t.connectedMeshId);i&&h.attachToMesh(i)}return t.metadata&&(h.metadata=t.metadata),h}_setOffset(t){this._offset!==t&&(this.isPaused&&(this.stop(),this.isPaused=!1),this._offset=t)}}u._SceneComponentInitialization=t=>{throw(0,h.S)("AudioSceneComponent")}},59020:(t,e,i)=>{"use strict";i.d(e,{s:()=>s});var n=i(84318);class s{constructor(t,e,i){if(this.loop=!1,this._coneInnerAngle=360,this._coneOuterAngle=360,this._volume=1,this.isPlaying=!1,this.isPaused=!1,this._sounds=[],this._weights=[],e.length!==i.length)throw new Error("Sounds length does not equal weights length");this.loop=t,this._weights=i;let n=0;for(const t of i)n+=t;const s=n>0?1/n:0;for(let t=0;t<this._weights.length;t++)this._weights[t]*=s;this._sounds=e;for(const t of this._sounds)t.onEndedObservable.add((()=>{this._onended()}))}get directionalConeInnerAngle(){return this._coneInnerAngle}set directionalConeInnerAngle(t){if(t!==this._coneInnerAngle){if(this._coneOuterAngle<t)return void n.Y.Error("directionalConeInnerAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneInnerAngle=t;for(const e of this._sounds)e.directionalConeInnerAngle=t}}get directionalConeOuterAngle(){return this._coneOuterAngle}set directionalConeOuterAngle(t){if(t!==this._coneOuterAngle){if(t<this._coneInnerAngle)return void n.Y.Error("directionalConeOuterAngle: outer angle of the cone must be superior or equal to the inner angle.");this._coneOuterAngle=t;for(const e of this._sounds)e.directionalConeOuterAngle=t}}get volume(){return this._volume}set volume(t){if(t!==this._volume)for(const e of this._sounds)e.setVolume(t)}_onended(){void 0!==this._currentIndex&&(this._sounds[this._currentIndex].autoplay=!1),this.loop&&this.isPlaying?this.play():this.isPlaying=!1}pause(){this.isPaused=!0,void 0!==this._currentIndex&&this._sounds[this._currentIndex].pause()}stop(){this.isPlaying=!1,void 0!==this._currentIndex&&this._sounds[this._currentIndex].stop()}play(t){if(!this.isPaused){this.stop();const t=Math.random();let e=0;for(let i=0;i<this._weights.length;i++)if(e+=this._weights[i],t<=e){this._currentIndex=i;break}}const e=this._sounds[this._currentIndex];e.isReady()?e.play(0,this.isPaused?void 0:t):e.autoplay=!0,this.isPlaying=!0,this.isPaused=!1}}},82576:(t,e,i)=>{"use strict";var n=i(72433),s=i(96969),o=i(58095),a=i(15210);class r{constructor(t){this._texture=null,this._isEnabled=!0,this.isEnabled=!0,this.time=0,(t=t||a.l.LastCreatedScene)&&(this._scene=t,this.animationParameters=new o.Lt(0,0,0,30))}_markSubMeshesAsAttributesDirty(){for(const t of this._scene.meshes)t.bakedVertexAnimationManager===this&&t._markSubMeshesAsAttributesDirty()}bind(t,e=!1){if(!this._texture||!this._isEnabled)return;const i=this._texture.getSize();t.setFloat2("bakedVertexAnimationTextureSizeInverted",1/i.width,1/i.height),t.setFloat("bakedVertexAnimationTime",this.time),e||t.setVector4("bakedVertexAnimationSettings",this.animationParameters),t.setTexture("bakedVertexAnimationTexture",this._texture)}clone(){const t=new r(this._scene);return this.copyTo(t),t}setAnimationParameters(t,e,i=0,n=30){this.animationParameters=new o.Lt(t,e,i,n)}dispose(t){var e;t&&(null===(e=this._texture)||void 0===e||e.dispose())}getClassName(){return"BakedVertexAnimationManager"}copyTo(t){s.p4.Clone((()=>t),this)}serialize(){return s.p4.Serialize(this)}parse(t,e,i){s.p4.Parse((()=>this),t,e,i)}}(0,n.gn)([(0,s.oU)(),(0,s.wz)("_markSubMeshesAsAttributesDirty")],r.prototype,"texture",void 0),(0,n.gn)([(0,s.qC)(),(0,s.wz)("_markSubMeshesAsAttributesDirty")],r.prototype,"isEnabled",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"animationParameters",void 0),(0,n.gn)([(0,s.qC)()],r.prototype,"time",void 0);i(46807),i(73803),i(29972)},93008:(t,e,i)=>{"use strict";i.d(e,{o:()=>a});var n=i(76324),s=i(29945),o=i(48154);class a{constructor(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this.targetAlpha=null,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}get name(){return"AutoRotation"}set zoomStopsAnimation(t){this._zoomStopsAnimation=t}get zoomStopsAnimation(){return this._zoomStopsAnimation}set idleRotationSpeed(t){this._idleRotationSpeed=t}get idleRotationSpeed(){return this._idleRotationSpeed}set idleRotationWaitTime(t){this._idleRotationWaitTime=t}get idleRotationWaitTime(){return this._idleRotationWaitTime}set idleRotationSpinupTime(t){this._idleRotationSpinupTime=t}get idleRotationSpinupTime(){return this._idleRotationSpinupTime}get rotationInProgress(){return Math.abs(this._cameraRotationSpeed)>0}init(){}attach(t){this._attachedCamera=t;const e=this._attachedCamera.getScene();this._onPrePointerObservableObserver=e.onPrePointerObservable.add((t=>{t.type!==n.kD.POINTERDOWN?t.type===n.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{if(this._reachTargetAlpha())return;const t=s.F.Now;let e=0;null!=this._lastFrameTime&&(e=t-this._lastFrameTime),this._lastFrameTime=t,this._applyUserInteraction();const i=t-this._lastInteractionTime-this._idleRotationWaitTime,n=Math.max(Math.min(i/this._idleRotationSpinupTime,1),0);this._cameraRotationSpeed=this._idleRotationSpeed*n,this._attachedCamera&&(this._attachedCamera.alpha-=this._cameraRotationSpeed*(e/1e3))}))}detach(){if(!this._attachedCamera)return;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}resetLastInteractionTime(t){this._lastInteractionTime=null!=t?t:s.F.Now}_reachTargetAlpha(){return!(!this._attachedCamera||!this.targetAlpha)&&Math.abs(this._attachedCamera.alpha-this.targetAlpha)<o.kn}_userIsZooming(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset}_shouldAnimationStopForInteraction(){if(!this._attachedCamera)return!1;let t=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(t=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?t:this._userIsZooming()}_applyUserInteraction(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=s.F.Now)}_userIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}},97391:(t,e,i)=>{"use strict";i.d(e,{r:()=>o});var n=i(88916),s=i(18770);class o{constructor(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}get name(){return"Bouncing"}get autoTransitionRange(){return this._autoTransitionRange}set autoTransitionRange(t){if(this._autoTransitionRange===t)return;this._autoTransitionRange=t;const e=this._attachedCamera;e&&(t?this._onMeshTargetChangedObserver=e.onMeshTargetChangedObservable.add((t=>{if(!t)return;t.computeWorldMatrix(!0);const e=t.getBoundingInfo().diagonalLength;this.lowerRadiusTransitionRange=.05*e,this.upperRadiusTransitionRange=.05*e})):this._onMeshTargetChangedObserver&&e.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}init(){}attach(t){this._attachedCamera=t,this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{this._attachedCamera&&(this._isRadiusAtLimit(this._attachedCamera.lowerRadiusLimit)&&this._applyBoundRadiusAnimation(this.lowerRadiusTransitionRange),this._isRadiusAtLimit(this._attachedCamera.upperRadiusLimit)&&this._applyBoundRadiusAnimation(this.upperRadiusTransitionRange))}))}detach(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)}_isRadiusAtLimit(t){return!!this._attachedCamera&&(this._attachedCamera.radius===t&&!this._radiusIsAnimating)}_applyBoundRadiusAnimation(t){if(!this._attachedCamera)return;this._radiusBounceTransition||(o.EasingFunction.setEasingMode(o.EasingMode),this._radiusBounceTransition=s.f.CreateAnimation("radius",s.f.ANIMATIONTYPE_FLOAT,60,o.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;const e=s.f.TransitionTo("radius",this._attachedCamera.radius+t,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,(()=>this._clearAnimationLocks()));e&&this._animatables.push(e)}_clearAnimationLocks(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()}}o.EasingFunction=new n.ud(.3),o.EasingMode=n.Kp.EASINGMODE_EASEOUT},81989:(t,e,i)=>{"use strict";i.d(e,{d:()=>l});var n=i(88916),s=i(62897),o=i(76324),a=i(29945),r=i(58095),h=i(18770);class l{constructor(){this.onTargetFramingAnimationEndObservable=new s.y$,this._mode=l.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}get name(){return"Framing"}set mode(t){this._mode=t}get mode(){return this._mode}set radiusScale(t){this._radiusScale=t}get radiusScale(){return this._radiusScale}set positionScale(t){this._positionScale=t}get positionScale(){return this._positionScale}set defaultElevation(t){this._defaultElevation=t}get defaultElevation(){return this._defaultElevation}set elevationReturnTime(t){this._elevationReturnTime=t}get elevationReturnTime(){return this._elevationReturnTime}set elevationReturnWaitTime(t){this._elevationReturnWaitTime=t}get elevationReturnWaitTime(){return this._elevationReturnWaitTime}set zoomStopsAnimation(t){this._zoomStopsAnimation=t}get zoomStopsAnimation(){return this._zoomStopsAnimation}set framingTime(t){this._framingTime=t}get framingTime(){return this._framingTime}init(){}attach(t){this._attachedCamera=t;const e=this._attachedCamera.getScene();l.EasingFunction.setEasingMode(l.EasingMode),this._onPrePointerObservableObserver=e.onPrePointerObservable.add((t=>{t.type!==o.kD.POINTERDOWN?t.type===o.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onMeshTargetChangedObserver=t.onMeshTargetChangedObservable.add((t=>{t&&this.zoomOnMesh(t,void 0,(()=>{this.onTargetFramingAnimationEndObservable.notifyObservers()}))})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((()=>{this._applyUserInteraction(),this._maintainCameraAboveGround()}))}detach(){if(!this._attachedCamera)return;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}zoomOnMesh(t,e=!1,i=null){t.computeWorldMatrix(!0);const n=t.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(n.minimumWorld,n.maximumWorld,e,i)}zoomOnMeshHierarchy(t,e=!1,i=null){t.computeWorldMatrix(!0);const n=t.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(n.min,n.max,e,i)}zoomOnMeshesHierarchy(t,e=!1,i=null){const n=new r.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let e=0;e<t.length;e++){const i=t[e].getHierarchyBoundingVectors(!0);r.P.CheckExtends(i.min,n,s),r.P.CheckExtends(i.max,n,s)}this.zoomOnBoundingInfo(n,s,e,i)}zoomOnBoundingInfo(t,e,i=!1,n=null){let s;if(!this._attachedCamera)return;const o=t.y,a=o+(e.y-o)*this._positionScale,u=e.subtract(t).scale(.5);if(i)s=new r.P(0,a,0);else{const e=t.add(u);s=new r.P(e.x,a,e.z)}this._vectorTransition||(this._vectorTransition=h.f.CreateAnimation("target",h.f.ANIMATIONTYPE_VECTOR3,60,l.EasingFunction)),this._betaIsAnimating=!0;let c=h.f.TransitionTo("target",s,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);c&&this._animatables.push(c);let d=0;if(this._mode===l.FitFrustumSidesMode){const i=this._calculateLowerRadiusFromModelBoundingSphere(t,e);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=u.length()+this._attachedCamera.minZ),d=i}else this._mode===l.IgnoreBoundsSizeMode&&(d=this._calculateLowerRadiusFromModelBoundingSphere(t,e),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){const i=e.subtract(t).length();this._attachedCamera.panningSensibility=5e3/i,this._attachedCamera.wheelPrecision=100/d}this._radiusTransition||(this._radiusTransition=h.f.CreateAnimation("radius",h.f.ANIMATIONTYPE_FLOAT,60,l.EasingFunction)),c=h.f.TransitionTo("radius",d,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,(()=>{this.stopAllAnimations(),n&&n(),this._attachedCamera&&this._attachedCamera.useInputToRestoreState&&this._attachedCamera.storeState()})),c&&this._animatables.push(c)}_calculateLowerRadiusFromModelBoundingSphere(t,e){const i=e.subtract(t).length(),n=this._getFrustumSlope(),s=.5*i*this._radiusScale,o=s*Math.sqrt(1+1/(n.x*n.x)),a=s*Math.sqrt(1+1/(n.y*n.y));let r=Math.max(o,a);const h=this._attachedCamera;return h?(h.lowerRadiusLimit&&this._mode===l.IgnoreBoundsSizeMode&&(r=r<h.lowerRadiusLimit?h.lowerRadiusLimit:r),h.upperRadiusLimit&&(r=r>h.upperRadiusLimit?h.upperRadiusLimit:r),r):0}_maintainCameraAboveGround(){if(this._elevationReturnTime<0)return;const t=a.F.Now-this._lastInteractionTime,e=.5*Math.PI-this._defaultElevation,i=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>i&&t>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=h.f.CreateAnimation("beta",h.f.ANIMATIONTYPE_FLOAT,60,l.EasingFunction));const t=h.f.TransitionTo("beta",e,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,(()=>{this._clearAnimationLocks(),this.stopAllAnimations()}));t&&this._animatables.push(t)}}_getFrustumSlope(){const t=this._attachedCamera;if(!t)return r.FM.Zero();const e=t.getScene().getEngine().getAspectRatio(t),i=Math.tan(t.fov/2),n=i*e;return new r.FM(n,i)}_clearAnimationLocks(){this._betaIsAnimating=!1}_applyUserInteraction(){this.isUserIsMoving&&(this._lastInteractionTime=a.F.Now,this.stopAllAnimations(),this._clearAnimationLocks())}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()}get isUserIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}l.EasingFunction=new n.EI,l.EasingMode=n.Kp.EASINGMODE_EASEINOUT,l.IgnoreBoundsSizeMode=0,l.FitFrustumSidesMode=1},54951:(t,e,i)=>{"use strict";i.d(e,{N:()=>l});var n=i(71419),s=i(65273),o=i(76324),a=i(58095),r=i(62897),h=i(2055);class l{constructor(){this._attachedToElement=!1,this._virtualMeshesInfo={},this._tmpVector=new a.P,this._tmpQuaternion=new a._f,this._dragType={NONE:0,DRAG:1,DRAG_WITH_CONTROLLER:2,NEAR_DRAG:3},this._moving=!1,this._dragging=this._dragType.NONE,this.draggableMeshes=null,this.zDragFactor=3,this.currentDraggingPointerIds=[],this.detachCameraControls=!0,this.onDragStartObservable=new r.y$,this.onDragObservable=new r.y$,this.onDragEndObservable=new r.y$,this.allowMultiPointer=!0}get currentDraggingPointerId(){return void 0!==this.currentDraggingPointerIds[0]?this.currentDraggingPointerIds[0]:-1}set currentDraggingPointerId(t){this.currentDraggingPointerIds[0]=t}get currentDraggingPointerID(){return this.currentDraggingPointerId}set currentDraggingPointerID(t){this.currentDraggingPointerId=t}get name(){return"BaseSixDofDrag"}get isMoving(){return this._moving}init(){}get _pointerCamera(){return this._scene.cameraToUseForPointers?this._scene.cameraToUseForPointers:this._scene.activeCamera}_createVirtualMeshInfo(){const t=new n.x("",l._virtualScene);t.rotationQuaternion=new a._f;const e=new n.x("",l._virtualScene);e.rotationQuaternion=new a._f;const i=new n.x("",l._virtualScene);return i.rotationQuaternion=new a._f,{dragging:!1,moving:!1,dragMesh:t,originMesh:e,pivotMesh:i,startingPivotPosition:new a.P,startingPivotOrientation:new a._f,startingPosition:new a.P,startingOrientation:new a._f,lastOriginPosition:new a.P,lastDragPosition:new a.P}}_resetVirtualMeshesPosition(){for(let t=0;t<this.currentDraggingPointerIds.length;t++)this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].pivotMesh.position.copyFrom(this._ownerNode.getAbsolutePivotPoint()),this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].pivotMesh.rotationQuaternion.copyFrom(this._ownerNode.rotationQuaternion),this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].startingPivotPosition.copyFrom(this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].pivotMesh.position),this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].startingPivotOrientation.copyFrom(this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].pivotMesh.rotationQuaternion),this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].startingPosition.copyFrom(this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].dragMesh.position),this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].startingOrientation.copyFrom(this._virtualMeshesInfo[this.currentDraggingPointerIds[t]].dragMesh.rotationQuaternion)}_pointerUpdate2D(t,e,i){!this._pointerCamera||this._pointerCamera.cameraRigMode!=h.V.RIG_MODE_NONE||this._pointerCamera._isLeftCamera||this._pointerCamera._isRightCamera||(t.origin.copyFrom(this._pointerCamera.globalPosition),i=0);const n=this._virtualMeshesInfo[e],s=a.jp.Vector3[0];t.origin.subtractToRef(n.lastOriginPosition,s),n.lastOriginPosition.copyFrom(t.origin);const o=-a.P.Dot(s,t.direction);n.originMesh.addChild(n.dragMesh),n.originMesh.addChild(n.pivotMesh),this._applyZOffset(n.dragMesh,o,i),this._applyZOffset(n.pivotMesh,o,i),n.originMesh.position.copyFrom(t.origin);const r=a.jp.Vector3[0];t.origin.addToRef(t.direction,r),n.originMesh.lookAt(r),n.originMesh.removeChild(n.dragMesh),n.originMesh.removeChild(n.pivotMesh)}_pointerUpdateXR(t,e,i,n){const s=this._virtualMeshesInfo[i];if(s.originMesh.position.copyFrom(t.position),this._dragging===this._dragType.NEAR_DRAG&&e?s.originMesh.rotationQuaternion.copyFrom(e.rotationQuaternion):s.originMesh.rotationQuaternion.copyFrom(t.rotationQuaternion),s.pivotMesh.computeWorldMatrix(!0),s.dragMesh.computeWorldMatrix(!0),0!==n){const t=a.jp.Vector3[0],e=a.jp.Vector3[1];t.copyFrom(this._pointerCamera.getForwardRay().direction),s.originMesh.position.subtractToRef(s.lastOriginPosition,e),s.lastOriginPosition.copyFrom(s.originMesh.position);const i=e.length();e.normalize();const o=a.jp.Vector3[2],r=a.jp.Vector3[3];s.dragMesh.absolutePosition.subtractToRef(this._pointerCamera.globalPosition,o),s.dragMesh.absolutePosition.subtractToRef(s.originMesh.position,r);const h=r.length();o.normalize(),r.normalize();let l=Math.abs(a.P.Dot(e,r))*a.P.Dot(e,t)*n*i*h;const u=.01;l<0&&u-h>l&&(l=Math.min(u-h,0)),r.scaleInPlace(l),r.addToRef(s.pivotMesh.absolutePosition,this._tmpVector),s.pivotMesh.setAbsolutePosition(this._tmpVector),r.addToRef(s.dragMesh.absolutePosition,this._tmpVector),s.dragMesh.setAbsolutePosition(this._tmpVector)}}attach(t){this._ownerNode=t,this._scene=this._ownerNode.getScene(),l._virtualScene||(l._virtualScene=new s.x(this._scene.getEngine(),{virtual:!0}),l._virtualScene.detachControl());const e=t=>this._ownerNode===t||t.isDescendantOf(this._ownerNode)&&(!this.draggableMeshes||-1!==this.draggableMeshes.indexOf(t));this._pointerObserver=this._scene.onPointerObservable.add((t=>{const i=t.event.pointerId;this._virtualMeshesInfo[i]||(this._virtualMeshesInfo[i]=this._createVirtualMeshInfo());const n=this._virtualMeshesInfo[i],s="xr-near"===t.event.pointerType;if(t.type==o.kD.POINTERDOWN){if(!n.dragging&&t.pickInfo&&t.pickInfo.hit&&t.pickInfo.pickedMesh&&t.pickInfo.pickedPoint&&t.pickInfo.ray&&(!s||t.pickInfo.aimTransform)&&e(t.pickInfo.pickedMesh)){if(!this.allowMultiPointer&&this.currentDraggingPointerIds.length>0)return;!this._pointerCamera||this._pointerCamera.cameraRigMode!==h.V.RIG_MODE_NONE||this._pointerCamera._isLeftCamera||this._pointerCamera._isRightCamera||t.pickInfo.ray.origin.copyFrom(this._pointerCamera.globalPosition),this._ownerNode.computeWorldMatrix(!0);const e=this._virtualMeshesInfo[i];s?(this._dragging=t.pickInfo.originMesh?this._dragType.NEAR_DRAG:this._dragType.DRAG_WITH_CONTROLLER,e.originMesh.position.copyFrom(t.pickInfo.aimTransform.position),this._dragging===this._dragType.NEAR_DRAG&&t.pickInfo.gripTransform?e.originMesh.rotationQuaternion.copyFrom(t.pickInfo.gripTransform.rotationQuaternion):e.originMesh.rotationQuaternion.copyFrom(t.pickInfo.aimTransform.rotationQuaternion)):(this._dragging=this._dragType.DRAG,e.originMesh.position.copyFrom(t.pickInfo.ray.origin)),e.lastOriginPosition.copyFrom(e.originMesh.position),e.dragMesh.position.copyFrom(t.pickInfo.pickedPoint),e.lastDragPosition.copyFrom(t.pickInfo.pickedPoint),e.pivotMesh.position.copyFrom(this._ownerNode.getAbsolutePivotPoint()),e.pivotMesh.rotationQuaternion.copyFrom(this._ownerNode.absoluteRotationQuaternion),e.startingPosition.copyFrom(e.dragMesh.position),e.startingPivotPosition.copyFrom(e.pivotMesh.position),e.startingOrientation.copyFrom(e.dragMesh.rotationQuaternion),e.startingPivotOrientation.copyFrom(e.pivotMesh.rotationQuaternion),s?(e.originMesh.addChild(e.dragMesh),e.originMesh.addChild(e.pivotMesh)):e.originMesh.lookAt(e.dragMesh.position),e.dragging=!0,-1===this.currentDraggingPointerIds.indexOf(i)&&this.currentDraggingPointerIds.push(i),this.detachCameraControls&&this._pointerCamera&&!this._pointerCamera.leftCamera&&(this._pointerCamera.inputs&&this._pointerCamera.inputs.attachedToElement?(this._pointerCamera.detachControl(),this._attachedToElement=!0):this._attachedToElement=!1),this._targetDragStart(e.pivotMesh.position,e.pivotMesh.rotationQuaternion,i),this.onDragStartObservable.notifyObservers({position:e.pivotMesh.position})}}else if(t.type==o.kD.POINTERUP||t.type==o.kD.POINTERDOUBLETAP){const t=this.currentDraggingPointerIds.indexOf(i);n.dragging=!1,-1!==t&&(this.currentDraggingPointerIds.splice(t,1),0===this.currentDraggingPointerIds.length&&(this._moving=!1,this._dragging=this._dragType.NONE,this.detachCameraControls&&this._attachedToElement&&this._pointerCamera&&!this._pointerCamera.leftCamera&&(this._reattachCameraControls(),this._attachedToElement=!1)),n.originMesh.removeChild(n.dragMesh),n.originMesh.removeChild(n.pivotMesh),this._targetDragEnd(i),this.onDragEndObservable.notifyObservers({}))}else if(t.type==o.kD.POINTERMOVE){if(-1!==this.currentDraggingPointerIds.indexOf(i)&&n.dragging&&t.pickInfo&&(t.pickInfo.ray||t.pickInfo.aimTransform)){let e=this.zDragFactor;(this.currentDraggingPointerIds.length>1||t.pickInfo.originMesh)&&(e=0),this._ownerNode.computeWorldMatrix(!0),s?this._pointerUpdateXR(t.pickInfo.aimTransform,t.pickInfo.gripTransform,i,e):this._pointerUpdate2D(t.pickInfo.ray,i,e),this._tmpQuaternion.copyFrom(n.startingPivotOrientation),this._tmpQuaternion.x=-this._tmpQuaternion.x,this._tmpQuaternion.y=-this._tmpQuaternion.y,this._tmpQuaternion.z=-this._tmpQuaternion.z,n.pivotMesh.absoluteRotationQuaternion.multiplyToRef(this._tmpQuaternion,this._tmpQuaternion),n.pivotMesh.absolutePosition.subtractToRef(n.startingPivotPosition,this._tmpVector),this.onDragObservable.notifyObservers({delta:this._tmpVector,position:n.pivotMesh.position,pickInfo:t.pickInfo}),this._targetDrag(this._tmpVector,this._tmpQuaternion,i),n.lastDragPosition.copyFrom(n.dragMesh.absolutePosition),this._moving=!0}}}))}_applyZOffset(t,e,i){t.position.z-=t.position.z<1?e*i:e*i*t.position.z,t.position.z<0&&(t.position.z=0)}_targetDragStart(t,e,i){}_targetDrag(t,e,i){}_targetDragEnd(t){}_reattachCameraControls(){if(this._pointerCamera)if("ArcRotateCamera"===this._pointerCamera.getClassName()){const t=this._pointerCamera;t.attachControl(!t.inputs||t.inputs.noPreventDefault,t._useCtrlForPanning,t._panningMouseButton)}else this._pointerCamera.attachControl(!this._pointerCamera.inputs||this._pointerCamera.inputs.noPreventDefault)}detach(){this._scene&&(this.detachCameraControls&&this._attachedToElement&&this._pointerCamera&&!this._pointerCamera.leftCamera&&(this._reattachCameraControls(),this._attachedToElement=!1),this._scene.onPointerObservable.remove(this._pointerObserver));for(const t in this._virtualMeshesInfo)this._virtualMeshesInfo[t].originMesh.dispose(),this._virtualMeshesInfo[t].dragMesh.dispose();this.onDragEndObservable.clear(),this.onDragObservable.clear(),this.onDragStartObservable.clear()}}},63654:(t,e,i)=>{"use strict";i.d(e,{M:()=>c});var n=i(91243),s=i(65273),o=i(62897),a=i(58095),r=i(76324),h=i(1316),l=i(11337),u=i(46719);class c{get currentDraggingPointerID(){return this.currentDraggingPointerId}set currentDraggingPointerID(t){this.currentDraggingPointerId=t}set enabled(t){t!=this._enabled&&this.onEnabledObservable.notifyObservers(t),this._enabled=t}get enabled(){return this._enabled}get options(){return this._options}set options(t){this._options=t}constructor(t){this._useAlternatePickedPointAboveMaxDragAngleDragSpeed=-1.1,this._activeDragButton=-1,this.maxDragAngle=0,this.dragButtons=[0,1,2],this._useAlternatePickedPointAboveMaxDragAngle=!1,this.currentDraggingPointerId=-1,this.dragging=!1,this.dragDeltaRatio=.2,this.updateDragPlane=!0,this._debugMode=!1,this._moving=!1,this.onDragObservable=new o.y$,this.onDragStartObservable=new o.y$,this.onDragEndObservable=new o.y$,this.onEnabledObservable=new o.y$,this.moveAttached=!0,this._enabled=!0,this.startAndReleaseDragOnPointerEvents=!0,this.detachCameraControls=!0,this.useObjectOrientationForDragging=!0,this.validateDrag=t=>!0,this._tmpVector=new a.P(0,0,0),this._alternatePickedPoint=new a.P(0,0,0),this._worldDragAxis=new a.P(0,0,0),this._targetPosition=new a.P(0,0,0),this._attachedToElement=!1,this._startDragRay=new h.z(new a.P,new a.P),this._lastPointerRay={},this._dragDelta=new a.P,this._pointA=new a.P(0,0,0),this._pointC=new a.P(0,0,0),this._localAxis=new a.P(0,0,0),this._lookAt=new a.P(0,0,0),this._options=t||{};let e=0;if(this._options.dragAxis&&e++,this._options.dragPlaneNormal&&e++,e>1)throw"Multiple drag modes specified in dragBehavior options. Only one expected"}get name(){return"PointerDrag"}init(){}attach(t,e){this._scene=t.getScene(),t.isNearGrabbable=!0,this.attachedNode=t,c._PlaneScene||(this._debugMode?c._PlaneScene=this._scene:(c._PlaneScene=new s.x(this._scene.getEngine(),{virtual:!0}),c._PlaneScene.detachControl(),this._scene.onDisposeObservable.addOnce((()=>{c._PlaneScene.dispose(),c._PlaneScene=null})))),this._dragPlane=(0,u.pT)("pointerDragPlane",{size:this._debugMode?1:1e4,updatable:!1,sideOrientation:n.Kj.DOUBLESIDE},c._PlaneScene),this.lastDragPosition=new a.P(0,0,0);const i=e||(t=>this.attachedNode==t||t.isDescendantOf(this.attachedNode));this._pointerObserver=this._scene.onPointerObservable.add((t=>{if(this.enabled){if(t.type==r.kD.POINTERDOWN)this.startAndReleaseDragOnPointerEvents&&!this.dragging&&t.pickInfo&&t.pickInfo.hit&&t.pickInfo.pickedMesh&&t.pickInfo.pickedPoint&&t.pickInfo.ray&&i(t.pickInfo.pickedMesh)&&-1===this._activeDragButton&&-1!==this.dragButtons.indexOf(t.event.button)&&(this._activeDragButton=t.event.button,this._activePointerInfo=t,this._startDrag(t.event.pointerId,t.pickInfo.ray,t.pickInfo.pickedPoint));else if(t.type==r.kD.POINTERUP)this.startAndReleaseDragOnPointerEvents&&this.currentDraggingPointerId==t.event.pointerId&&this._activeDragButton===t.event.button&&this.releaseDrag();else if(t.type==r.kD.POINTERMOVE){const e=t.event.pointerId;if(this.currentDraggingPointerId===c._AnyMouseId&&e!==c._AnyMouseId){const i=t.event;("mouse"===i.pointerType||!this._scene.getEngine().hostInformation.isMobile&&i instanceof MouseEvent)&&(this._lastPointerRay[this.currentDraggingPointerId]&&(this._lastPointerRay[e]=this._lastPointerRay[this.currentDraggingPointerId],delete this._lastPointerRay[this.currentDraggingPointerId]),this.currentDraggingPointerId=e)}this._lastPointerRay[e]||(this._lastPointerRay[e]=new h.z(new a.P,new a.P)),t.pickInfo&&t.pickInfo.ray&&(this._lastPointerRay[e].origin.copyFrom(t.pickInfo.ray.origin),this._lastPointerRay[e].direction.copyFrom(t.pickInfo.ray.direction),this.currentDraggingPointerId==e&&this.dragging&&this._moveDrag(t.pickInfo.ray))}}else this._attachedToElement&&this.releaseDrag()})),this._beforeRenderObserver=this._scene.onBeforeRenderObservable.add((()=>{if(this._moving&&this.moveAttached){let t=!1;l.m._RemoveAndStorePivotPoint(this.attachedNode),this._targetPosition.subtractToRef(this.attachedNode.absolutePosition,this._tmpVector),this._tmpVector.scaleInPlace(this.dragDeltaRatio),this.attachedNode.getAbsolutePosition().addToRef(this._tmpVector,this._tmpVector),this.validateDrag(this._tmpVector)&&(this.attachedNode.setAbsolutePosition(this._tmpVector),t=!0),l.m._RestorePivotPoint(this.attachedNode),t&&this.attachedNode.computeWorldMatrix()}}))}releaseDrag(){if(this.dragging&&(this.dragging=!1,this.onDragEndObservable.notifyObservers({dragPlanePoint:this.lastDragPosition,pointerId:this.currentDraggingPointerId,pointerInfo:this._activePointerInfo})),this.currentDraggingPointerId=-1,this._activeDragButton=-1,this._activePointerInfo=null,this._moving=!1,this.detachCameraControls&&this._attachedToElement&&this._scene.activeCamera&&!this._scene.activeCamera.leftCamera){if("ArcRotateCamera"===this._scene.activeCamera.getClassName()){const t=this._scene.activeCamera;t.attachControl(!t.inputs||t.inputs.noPreventDefault,t._useCtrlForPanning,t._panningMouseButton)}else this._scene.activeCamera.attachControl(!this._scene.activeCamera.inputs||this._scene.activeCamera.inputs.noPreventDefault);this._attachedToElement=!1}}startDrag(t=c._AnyMouseId,e,i){this._startDrag(t,e,i);let n=this._lastPointerRay[t];t===c._AnyMouseId&&(n=this._lastPointerRay[Object.keys(this._lastPointerRay)[0]]),n&&this._moveDrag(n)}_startDrag(t,e,i){if(!this._scene.activeCamera||this.dragging||!this.attachedNode)return;l.m._RemoveAndStorePivotPoint(this.attachedNode),e?(this._startDragRay.direction.copyFrom(e.direction),this._startDragRay.origin.copyFrom(e.origin)):(this._startDragRay.origin.copyFrom(this._scene.activeCamera.position),this.attachedNode.getWorldMatrix().getTranslationToRef(this._tmpVector),this._tmpVector.subtractToRef(this._scene.activeCamera.position,this._startDragRay.direction)),this._updateDragPlanePosition(this._startDragRay,i||this._tmpVector);const n=this._pickWithRayOnDragPlane(this._startDragRay);n?(this.dragging=!0,this.currentDraggingPointerId=t,this.lastDragPosition.copyFrom(n),this.onDragStartObservable.notifyObservers({dragPlanePoint:n,pointerId:this.currentDraggingPointerId,pointerInfo:this._activePointerInfo}),this._targetPosition.copyFrom(this.attachedNode.getAbsolutePosition()),this.detachCameraControls&&this._scene.activeCamera&&this._scene.activeCamera.inputs&&!this._scene.activeCamera.leftCamera&&(this._scene.activeCamera.inputs.attachedToElement?(this._scene.activeCamera.detachControl(),this._attachedToElement=!0):this._attachedToElement=!1)):this.releaseDrag(),l.m._RestorePivotPoint(this.attachedNode)}_moveDrag(t){this._moving=!0;const e=this._pickWithRayOnDragPlane(t);if(e){l.m._RemoveAndStorePivotPoint(this.attachedNode),this.updateDragPlane&&this._updateDragPlanePosition(t,e);let i=0;this._options.dragAxis?(this.useObjectOrientationForDragging?a.P.TransformCoordinatesToRef(this._options.dragAxis,this.attachedNode.getWorldMatrix().getRotationMatrix(),this._worldDragAxis):this._worldDragAxis.copyFrom(this._options.dragAxis),e.subtractToRef(this.lastDragPosition,this._tmpVector),i=a.P.Dot(this._tmpVector,this._worldDragAxis),this._worldDragAxis.scaleToRef(i,this._dragDelta)):(i=this._dragDelta.length(),e.subtractToRef(this.lastDragPosition,this._dragDelta)),this._targetPosition.addInPlace(this._dragDelta),this.onDragObservable.notifyObservers({dragDistance:i,delta:this._dragDelta,dragPlanePoint:e,dragPlaneNormal:this._dragPlane.forward,pointerId:this.currentDraggingPointerId,pointerInfo:this._activePointerInfo}),this.lastDragPosition.copyFrom(e),l.m._RestorePivotPoint(this.attachedNode)}}_pickWithRayOnDragPlane(t){if(!t)return null;let e=Math.acos(a.P.Dot(this._dragPlane.forward,t.direction));if(e>Math.PI/2&&(e=Math.PI-e),this.maxDragAngle>0&&e>this.maxDragAngle){if(this._useAlternatePickedPointAboveMaxDragAngle){this._tmpVector.copyFrom(t.direction),this.attachedNode.absolutePosition.subtractToRef(t.origin,this._alternatePickedPoint),this._alternatePickedPoint.normalize(),this._alternatePickedPoint.scaleInPlace(this._useAlternatePickedPointAboveMaxDragAngleDragSpeed*a.P.Dot(this._alternatePickedPoint,this._tmpVector)),this._tmpVector.addInPlace(this._alternatePickedPoint);const e=a.P.Dot(this._dragPlane.forward,this._tmpVector);return this._dragPlane.forward.scaleToRef(-e,this._alternatePickedPoint),this._alternatePickedPoint.addInPlace(this._tmpVector),this._alternatePickedPoint.addInPlace(this.attachedNode.absolutePosition),this._alternatePickedPoint}return null}const i=c._PlaneScene.pickWithRay(t,(t=>t==this._dragPlane));return i&&i.hit&&i.pickedMesh&&i.pickedPoint?i.pickedPoint:null}_updateDragPlanePosition(t,e){this._pointA.copyFrom(e),this._options.dragAxis?(this.useObjectOrientationForDragging?a.P.TransformCoordinatesToRef(this._options.dragAxis,this.attachedNode.getWorldMatrix().getRotationMatrix(),this._localAxis):this._localAxis.copyFrom(this._options.dragAxis),t.origin.subtractToRef(this._pointA,this._pointC),this._pointC.normalize(),Math.abs(a.P.Dot(this._localAxis,this._pointC))>.999?Math.abs(a.P.Dot(a.P.UpReadOnly,this._pointC))>.999?this._lookAt.copyFrom(a.P.Right()):this._lookAt.copyFrom(a.P.UpReadOnly):(a.P.CrossToRef(this._localAxis,this._pointC,this._lookAt),a.P.CrossToRef(this._localAxis,this._lookAt,this._lookAt),this._lookAt.normalize()),this._dragPlane.position.copyFrom(this._pointA),this._pointA.addToRef(this._lookAt,this._lookAt),this._dragPlane.lookAt(this._lookAt)):this._options.dragPlaneNormal?(this.useObjectOrientationForDragging?a.P.TransformCoordinatesToRef(this._options.dragPlaneNormal,this.attachedNode.getWorldMatrix().getRotationMatrix(),this._localAxis):this._localAxis.copyFrom(this._options.dragPlaneNormal),this._dragPlane.position.copyFrom(this._pointA),this._pointA.addToRef(this._localAxis,this._lookAt),this._dragPlane.lookAt(this._lookAt)):(this._dragPlane.position.copyFrom(this._pointA),this._dragPlane.lookAt(t.origin)),this._dragPlane.position.copyFrom(this.attachedNode.getAbsolutePosition()),this._dragPlane.computeWorldMatrix(!0)}detach(){this._lastPointerRay={},this.attachedNode&&(this.attachedNode.isNearGrabbable=!1),this._pointerObserver&&this._scene.onPointerObservable.remove(this._pointerObserver),this._beforeRenderObserver&&this._scene.onBeforeRenderObservable.remove(this._beforeRenderObserver),this._dragPlane&&this._dragPlane.dispose(),this.releaseDrag()}}c._AnyMouseId=-2},52597:(t,e,i)=>{"use strict";i.d(e,{K:()=>h});var n=i(58095),s=i(62897),o=i(54951),a=i(30700),r=i(43048);class h extends o.N{constructor(){super(...arguments),this._sceneRenderObserver=null,this._targetPosition=new n.P(0,0,0),this._targetOrientation=new n._f,this._targetScaling=new n.P(1,1,1),this._startingPosition=new n.P(0,0,0),this._startingOrientation=new n._f,this._startingScaling=new n.P(1,1,1),this.onPositionChangedObservable=new s.y$,this.dragDeltaRatio=.2,this.rotateDraggedObject=!0,this.rotateAroundYOnly=!1,this.rotateWithMotionController=!0,this.disableMovement=!1,this.faceCameraOnDragStart=!1}get name(){return"SixDofDrag"}attach(t){super.attach(t),t.isNearGrabbable=!0,this._virtualTransformNode=new a.Y("virtual_sixDof",o.N._virtualScene),this._virtualTransformNode.rotationQuaternion=n._f.Identity(),this._sceneRenderObserver=t.getScene().onBeforeRenderObservable.add((()=>{if(1===this.currentDraggingPointerIds.length&&this._moving&&!this.disableMovement){const e=t.parent;t.setParent(null),t.position.addInPlace(this._targetPosition.subtract(t.position).scale(this.dragDeltaRatio)),this.onPositionChangedObservable.notifyObservers({position:t.absolutePosition}),(!e||e.scaling&&!e.scaling.isNonUniformWithinEpsilon(.001))&&n._f.SlerpToRef(t.rotationQuaternion,this._targetOrientation,this.dragDeltaRatio,t.rotationQuaternion),t.setParent(e)}}))}_getPositionOffsetAround(t,e,i){const s=n.jp.Matrix[0],o=n.jp.Matrix[1],a=n.jp.Matrix[2],r=n.jp.Matrix[3],h=n.jp.Matrix[4];return n.y3.TranslationToRef(t.x,t.y,t.z,s),n.y3.TranslationToRef(-t.x,-t.y,-t.z,o),n.y3.FromQuaternionToRef(i,a),n.y3.ScalingToRef(e,e,e,r),o.multiplyToRef(a,h),h.multiplyToRef(r,h),h.multiplyToRef(s,h),h.getTranslation()}_onePointerPositionUpdated(t,e){n.jp.Vector3[0].setAll(0),this._dragging===this._dragType.DRAG?this.rotateDraggedObject&&(this.rotateAroundYOnly?n._f.RotationYawPitchRollToRef(e.toEulerAngles().y,0,0,n.jp.Quaternion[0]):n.jp.Quaternion[0].copyFrom(e),n.jp.Quaternion[0].multiplyToRef(this._startingOrientation,this._targetOrientation)):(this._dragging===this._dragType.NEAR_DRAG||this._dragging===this._dragType.DRAG_WITH_CONTROLLER&&this.rotateWithMotionController)&&e.multiplyToRef(this._startingOrientation,this._targetOrientation),this._targetPosition.copyFrom(this._startingPosition).addInPlace(t)}_twoPointersPositionUpdated(){const t=this._virtualMeshesInfo[this.currentDraggingPointerIds[0]].startingPosition,e=this._virtualMeshesInfo[this.currentDraggingPointerIds[1]].startingPosition,i=n.jp.Vector3[0];t.addToRef(e,i),i.scaleInPlace(.5);const s=n.jp.Vector3[1];e.subtractToRef(t,s);const o=this._virtualMeshesInfo[this.currentDraggingPointerIds[0]].dragMesh.absolutePosition,a=this._virtualMeshesInfo[this.currentDraggingPointerIds[1]].dragMesh.absolutePosition,r=n.jp.Vector3[2];o.addToRef(a,r),r.scaleInPlace(.5);const h=n.jp.Vector3[3];a.subtractToRef(o,h);const l=h.length()/s.length(),u=r.subtract(i),c=n._f.FromEulerAngles(0,n.P.GetAngleBetweenVectorsOnPlane(s.normalize(),h.normalize(),n.P.UpReadOnly),0),d=this._ownerNode.parent;this._ownerNode.setParent(null);const _=this._getPositionOffsetAround(i.subtract(this._virtualTransformNode.getAbsolutePivotPoint()),l,c);this._virtualTransformNode.rotationQuaternion.multiplyToRef(c,this._ownerNode.rotationQuaternion),this._virtualTransformNode.scaling.scaleToRef(l,this._ownerNode.scaling),this._virtualTransformNode.position.addToRef(u.addInPlace(_),this._ownerNode.position),this.onPositionChangedObservable.notifyObservers({position:this._ownerNode.position}),this._ownerNode.setParent(d)}_targetDragStart(){const t=this.currentDraggingPointerIds.length,e=this._ownerNode.parent;this._ownerNode.rotationQuaternion||(this._ownerNode.rotationQuaternion=n._f.RotationYawPitchRoll(this._ownerNode.rotation.y,this._ownerNode.rotation.x,this._ownerNode.rotation.z));const i=this._ownerNode.getAbsolutePivotPoint();if(this._ownerNode.setParent(null),1===t){if(this._targetPosition.copyFrom(this._ownerNode.position),this._targetOrientation.copyFrom(this._ownerNode.rotationQuaternion),this._targetScaling.copyFrom(this._ownerNode.scaling),this.faceCameraOnDragStart&&this._scene.activeCamera){const t=n.jp.Vector3[0];this._scene.activeCamera.position.subtractToRef(i,t),t.normalize();const e=n.jp.Quaternion[0];this._scene.useRightHandedSystem?n._f.FromLookDirectionRHToRef(t,new n.P(0,1,0),e):n._f.FromLookDirectionLHToRef(t,new n.P(0,1,0),e),e.normalize(),n._f.RotationYawPitchRollToRef(e.toEulerAngles().y,0,0,n.jp.Quaternion[0]),this._targetOrientation.copyFrom(n.jp.Quaternion[0])}this._startingPosition.copyFrom(this._targetPosition),this._startingOrientation.copyFrom(this._targetOrientation),this._startingScaling.copyFrom(this._targetScaling)}else 2===t&&(this._virtualTransformNode.setPivotPoint(new n.P(0,0,0),r.T.LOCAL),this._virtualTransformNode.position.copyFrom(this._ownerNode.position),this._virtualTransformNode.scaling.copyFrom(this._ownerNode.scaling),this._virtualTransformNode.rotationQuaternion.copyFrom(this._ownerNode.rotationQuaternion),this._virtualTransformNode.setPivotPoint(i,r.T.WORLD),this._resetVirtualMeshesPosition());this._ownerNode.setParent(e)}_targetDrag(t,e){1===this.currentDraggingPointerIds.length?this._onePointerPositionUpdated(t,e):2===this.currentDraggingPointerIds.length&&this._twoPointersPositionUpdated()}_targetDragEnd(){if(1===this.currentDraggingPointerIds.length){this._resetVirtualMeshesPosition();const t=this.faceCameraOnDragStart;this.faceCameraOnDragStart=!1,this._targetDragStart(),this.faceCameraOnDragStart=t}}detach(){super.detach(),this._ownerNode&&(this._ownerNode.isNearGrabbable=!1,this._ownerNode.getScene().onBeforeRenderObservable.remove(this._sceneRenderObserver)),this._virtualTransformNode&&this._virtualTransformNode.dispose()}}},45647:(t,e,i)=>{"use strict";i(93008),i(97391),i(81989),i(58095);i(63654);i(52597),i(76324);i(54951),i(72739),i(48154);var n,s,o;i(2914),i(68942),i(13514);!function(t){t[t.ABOVE_FINGER_TIPS=0]="ABOVE_FINGER_TIPS",t[t.RADIAL_SIDE=1]="RADIAL_SIDE",t[t.ULNAR_SIDE=2]="ULNAR_SIDE",t[t.BELOW_WRIST=3]="BELOW_WRIST"}(n||(n={})),function(t){t[t.LOOK_AT_CAMERA=0]="LOOK_AT_CAMERA",t[t.HAND_ROTATION=1]="HAND_ROTATION"}(s||(s={})),function(t){t[t.ALWAYS_VISIBLE=0]="ALWAYS_VISIBLE",t[t.PALM_UP=1]="PALM_UP",t[t.GAZE_FOCUS=2]="GAZE_FOCUS",t[t.PALM_AND_GAZE=3]="PALM_AND_GAZE"}(o||(o={}))}}]);