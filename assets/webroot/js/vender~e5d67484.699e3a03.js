"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[669],{93354:(e,t,s)=>{s.d(t,{$:()=>l});var r=s(58095),i=s(72739),o=s(69314),n=s(48154),a=s(15631);class c{constructor(e,t,s,r){this.name=e,this.worldAxisForNormal=t,this.worldAxisForFileX=s,this.worldAxisForFileY=r}}class l{static ConvertCubeMapTextureToSphericalPolynomial(e){var t;if(!e.isCube)return null;null===(t=e.getScene())||void 0===t||t.getEngine().flushFramebuffer();const s=e.getSize().width,r=e.readPixels(0,void 0,void 0,!1),i=e.readPixels(1,void 0,void 0,!1);let o,n;e.isRenderTarget?(o=e.readPixels(3,void 0,void 0,!1),n=e.readPixels(2,void 0,void 0,!1)):(o=e.readPixels(2,void 0,void 0,!1),n=e.readPixels(3,void 0,void 0,!1));const a=e.readPixels(4,void 0,void 0,!1),c=e.readPixels(5,void 0,void 0,!1),l=e.gammaSpace;let h=0;return 1!=e.textureType&&2!=e.textureType||(h=1),new Promise((e=>{Promise.all([i,r,o,n,a,c]).then((([t,r,i,o,n,a])=>{const c={size:s,right:r,left:t,up:i,down:o,front:n,back:a,format:5,type:h,gammaSpace:l};e(this.ConvertCubeMapToSphericalPolynomial(c))}))}))}static _AreaElement(e,t){return Math.atan2(e*t,Math.sqrt(e*e+t*t+1))}static ConvertCubeMapToSphericalPolynomial(e){const t=new o._;let s=0;const r=2/e.size,c=r,l=.5*r,h=l-1;for(let o=0;o<6;o++){const d=this._FileFaces[o],u=e[d.name];let g=h;const f=5===e.format?4:3;for(let o=0;o<e.size;o++){let p=h;for(let c=0;c<e.size;c++){const h=d.worldAxisForFileX.scale(p).add(d.worldAxisForFileY.scale(g)).add(d.worldAxisForNormal);h.normalize();const m=this._AreaElement(p-l,g-l)-this._AreaElement(p-l,g+l)-this._AreaElement(p+l,g-l)+this._AreaElement(p+l,g+l);let _=u[o*e.size*f+c*f+0],A=u[o*e.size*f+c*f+1],v=u[o*e.size*f+c*f+2];isNaN(_)&&(_=0),isNaN(A)&&(A=0),isNaN(v)&&(v=0),0===e.type&&(_/=255,A/=255,v/=255),e.gammaSpace&&(_=Math.pow(i.R.Clamp(_),n.Nn),A=Math.pow(i.R.Clamp(A),n.Nn),v=Math.pow(i.R.Clamp(v),n.Nn));const C=4096;_=i.R.Clamp(_,0,C),A=i.R.Clamp(A,0,C),v=i.R.Clamp(v,0,C);const T=new a.Wo(_,A,v);t.addLight(h,T,m),s+=m,p+=r}g+=c}}const d=6*(4*Math.PI)/6/s;return t.scaleInPlace(d),t.convertIncidentRadianceToIrradiance(),t.convertIrradianceToLambertianRadiance(),o.i.FromHarmonics(t)}}l._FileFaces=[new c("right",new r.P(1,0,0),new r.P(0,0,-1),new r.P(0,-1,0)),new c("left",new r.P(-1,0,0),new r.P(0,0,1),new r.P(0,-1,0)),new c("up",new r.P(0,1,0),new r.P(1,0,0),new r.P(0,0,1)),new c("down",new r.P(0,-1,0),new r.P(1,0,0),new r.P(0,0,-1)),new c("front",new r.P(0,0,1),new r.P(1,0,0),new r.P(0,-1,0)),new c("back",new r.P(0,0,-1),new r.P(-1,0,0),new r.P(0,-1,0))]},13408:(e,t,s)=>{s.d(t,{s:()=>i});var r=s(19414);class i{static _Ldexp(e,t){return t>1023?e*Math.pow(2,1023)*Math.pow(2,t-1023):t<-1074?e*Math.pow(2,-1074)*Math.pow(2,t+1074):e*Math.pow(2,t)}static _Rgbe2float(e,t,s,r,i,o){i>0?(i=this._Ldexp(1,i-136),e[o+0]=t*i,e[o+1]=s*i,e[o+2]=r*i):(e[o+0]=0,e[o+1]=0,e[o+2]=0)}static _ReadStringLine(e,t){let s="",r="";for(let i=t;i<e.length-t&&(r=String.fromCharCode(e[i]),"\n"!=r);i++)s+=r;return s}static RGBE_ReadHeader(e){let t=0,s=0,r=this._ReadStringLine(e,0);if("#"!=r[0]||"?"!=r[1])throw"Bad HDR Format.";let i=!1,o=!1,n=0;do{n+=r.length+1,r=this._ReadStringLine(e,n),"FORMAT=32-bit_rle_rgbe"==r?o=!0:0==r.length&&(i=!0)}while(!i);if(!o)throw"HDR Bad header format, unsupported FORMAT";n+=r.length+1,r=this._ReadStringLine(e,n);const a=/^-Y (.*) \+X (.*)$/g.exec(r);if(!a||a.length<3)throw"HDR Bad header format, no size";if(s=parseInt(a[2]),t=parseInt(a[1]),s<8||s>32767)throw"HDR Bad header format, unsupported size";return n+=r.length+1,{height:t,width:s,dataPosition:n}}static GetCubeMapTextureData(e,t){const s=new Uint8Array(e),i=this.RGBE_ReadHeader(s),o=this.RGBE_ReadPixels(s,i);return r.B.ConvertPanoramaToCubemap(o,i.width,i.height,t)}static RGBE_ReadPixels(e,t){return this._RGBEReadPixelsRLE(e,t)}static _RGBEReadPixelsRLE(e,t){let s=t.height;const r=t.width;let i,o,n,a,c,l=t.dataPosition,h=0,d=0,u=0;const g=new ArrayBuffer(4*r),f=new Uint8Array(g),p=new ArrayBuffer(t.width*t.height*4*3),m=new Float32Array(p);for(;s>0;){if(i=e[l++],o=e[l++],n=e[l++],a=e[l++],2!=i||2!=o||128&n||t.width<8||t.width>32767)return this._RGBEReadPixelsNOTRLE(e,t);if((n<<8|a)!=r)throw"HDR Bad header format, wrong scan line width";for(h=0,u=0;u<4;u++)for(d=(u+1)*r;h<d;)if(i=e[l++],o=e[l++],i>128){if(c=i-128,0==c||c>d-h)throw"HDR Bad Format, bad scanline data (run)";for(;c-- >0;)f[h++]=o}else{if(c=i,0==c||c>d-h)throw"HDR Bad Format, bad scanline data (non-run)";if(f[h++]=o,--c>0)for(let t=0;t<c;t++)f[h++]=e[l++]}for(u=0;u<r;u++)i=f[u],o=f[u+r],n=f[u+2*r],a=f[u+3*r],this._Rgbe2float(m,i,o,n,a,(t.height-s)*r*3+3*u);s--}return m}static _RGBEReadPixelsNOTRLE(e,t){let s=t.height;const r=t.width;let i,o,n,a,c,l=t.dataPosition;const h=new ArrayBuffer(t.width*t.height*4*3),d=new Float32Array(h);for(;s>0;){for(c=0;c<t.width;c++)i=e[l++],o=e[l++],n=e[l++],a=e[l++],this._Rgbe2float(d,i,o,n,a,(t.height-s)*r*3+3*c);s--}return d}}},19414:(e,t,s)=>{s.d(t,{B:()=>i});var r=s(58095);class i{static ConvertPanoramaToCubemap(e,t,s,r){if(!e)throw"ConvertPanoramaToCubemap: input cannot be null";if(e.length!=t*s*3)throw"ConvertPanoramaToCubemap: input size is wrong";return{front:this.CreateCubemapTexture(r,this.FACE_FRONT,e,t,s),back:this.CreateCubemapTexture(r,this.FACE_BACK,e,t,s),left:this.CreateCubemapTexture(r,this.FACE_LEFT,e,t,s),right:this.CreateCubemapTexture(r,this.FACE_RIGHT,e,t,s),up:this.CreateCubemapTexture(r,this.FACE_UP,e,t,s),down:this.CreateCubemapTexture(r,this.FACE_DOWN,e,t,s),size:r,type:1,format:4,gammaSpace:!1}}static CreateCubemapTexture(e,t,s,r,i){const o=new ArrayBuffer(e*e*4*3),n=new Float32Array(o),a=t[1].subtract(t[0]).scale(1/e),c=t[3].subtract(t[2]).scale(1/e),l=1/e;let h=0;for(let o=0;o<e;o++){let d=t[0],u=t[2];for(let t=0;t<e;t++){const l=u.subtract(d).scale(h).add(d);l.normalize();const g=this.CalcProjectionSpherical(l,s,r,i);n[o*e*3+3*t+0]=g.r,n[o*e*3+3*t+1]=g.g,n[o*e*3+3*t+2]=g.b,d=d.add(a),u=u.add(c)}h+=l}return n}static CalcProjectionSpherical(e,t,s,r){let i=Math.atan2(e.z,e.x);const o=Math.acos(e.y);for(;i<-Math.PI;)i+=2*Math.PI;for(;i>Math.PI;)i-=2*Math.PI;let n=i/Math.PI;const a=o/Math.PI;n=.5*n+.5;let c=Math.round(n*s);c<0?c=0:c>=s&&(c=s-1);let l=Math.round(a*r);l<0?l=0:l>=r&&(l=r-1);const h=r-l-1;return{r:t[h*s*3+3*c+0],g:t[h*s*3+3*c+1],b:t[h*s*3+3*c+2]}}}i.FACE_LEFT=[new r.P(-1,-1,-1),new r.P(1,-1,-1),new r.P(-1,1,-1),new r.P(1,1,-1)],i.FACE_RIGHT=[new r.P(1,-1,1),new r.P(-1,-1,1),new r.P(1,1,1),new r.P(-1,1,1)],i.FACE_FRONT=[new r.P(1,-1,-1),new r.P(1,-1,1),new r.P(1,1,-1),new r.P(1,1,1)],i.FACE_BACK=[new r.P(-1,-1,1),new r.P(-1,-1,-1),new r.P(-1,1,1),new r.P(-1,1,-1)],i.FACE_DOWN=[new r.P(1,1,-1),new r.P(1,1,1),new r.P(-1,1,-1),new r.P(-1,1,1)],i.FACE_UP=[new r.P(-1,-1,-1),new r.P(-1,-1,1),new r.P(1,-1,-1),new r.P(1,-1,1)]},26769:(e,t,s)=>{s.d(t,{q:()=>r});class r{static Eval(e,t){return"true"===(e=e.match(/\([^()]*\)/g)?e.replace(/\([^()]*\)/g,(e=>(e=e.slice(1,e.length-1),r._HandleParenthesisContent(e,t)))):r._HandleParenthesisContent(e,t))||"false"!==e&&r.Eval(e,t)}static _HandleParenthesisContent(e,t){let s;t=t||(e=>"true"===e);const i=e.split("||");for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){let o=r._SimplifyNegation(i[e].trim());const n=o.split("&&");if(n.length>1)for(let e=0;e<n.length;++e){const i=r._SimplifyNegation(n[e].trim());if(s="true"!==i&&"false"!==i?"!"===i[0]?!t(i.substring(1)):t(i):"true"===i,!s){o="false";break}}if(s||"true"===o){s=!0;break}s="true"!==o&&"false"!==o?"!"===o[0]?!t(o.substring(1)):t(o):"true"===o}return s?"true":"false"}static _SimplifyNegation(e){return"!true"===(e=(e=e.replace(/^[\s!]+/,(e=>(e=e.replace(/[\s]/g,(()=>""))).length%2?"!":""))).trim())?e="false":"!false"===e&&(e="true"),e}}},48939:(e,t,s)=>{s.d(t,{B:()=>r,M:()=>o});class r{static BuildArray(e,t){const s=[];for(let r=0;r<e;++r)s.push(t());return s}static BuildTuple(e,t){return r.BuildArray(e,t)}}const i=["push","splice","pop","shift","unshift"];function o(e,t){const s=i.map((s=>function(e,t,s){const r=e[t];if("function"!=typeof r)return null;const i=function(){const r=e.length,o=i.previous.apply(e,arguments);return s(t,r),o};return r.next=i,i.previous=r,e[t]=i,()=>{const s=i.previous;if(!s)return;const r=i.next;r?(s.next=r,r.previous=s):(s.next=void 0,e[t]=s),i.next=void 0,i.previous=void 0}}(e,s,t)));return()=>{s.forEach((e=>{null==e||e()}))}}},10440:(e,t,s)=>{s.d(t,{Sp:()=>y});var r,i=s(63407),o=s(13514),n=s(62897),a=s(73803),c=s(44394),l=s(85790),h=s(87432),d=s(84318),u=s(15210);!function(e){e[e.INIT=0]="INIT",e[e.RUNNING=1]="RUNNING",e[e.DONE=2]="DONE",e[e.ERROR=3]="ERROR"}(r||(r={}));class g{constructor(e){this.name=e,this._isCompleted=!1,this._taskState=r.INIT}get isCompleted(){return this._isCompleted}get taskState(){return this._taskState}get errorObject(){return this._errorObject}_setErrorObject(e,t){this._errorObject||(this._errorObject={message:e,exception:t})}run(e,t,s){this._taskState=r.RUNNING,this.runTask(e,(()=>{this._onDoneCallback(t,s)}),((e,t)=>{this._onErrorCallback(s,e,t)}))}runTask(e,t,s){throw new Error("runTask is not implemented")}reset(){this._taskState=r.INIT}_onErrorCallback(e,t,s){this._taskState=r.ERROR,this._errorObject={message:t,exception:s},this.onError&&this.onError(this,t,s),e()}_onDoneCallback(e,t){try{this._taskState=r.DONE,this._isCompleted=!0,this.onSuccess&&this.onSuccess(this),e()}catch(e){this._onErrorCallback(t,"Task is done, error executing success callback(s)",e)}}}class f{constructor(e,t,s){this.remainingCount=e,this.totalCount=t,this.task=s}}class p extends g{constructor(e,t,s,r,i){super(e),this.name=e,this.meshesNames=t,this.rootUrl=s,this.sceneFilename=r,this.extension=i}runTask(e,t,s){i.n.LoadAssetContainer(this.rootUrl,this.sceneFilename,e,(e=>{this.loadedContainer=e,this.loadedMeshes=e.meshes,this.loadedTransformNodes=e.transformNodes,this.loadedParticleSystems=e.particleSystems,this.loadedSkeletons=e.skeletons,this.loadedAnimationGroups=e.animationGroups,t()}),null,((e,t,r)=>{s(t,r)}),this.extension)}}class m extends g{constructor(e,t,s,r,i){super(e),this.name=e,this.meshesNames=t,this.rootUrl=s,this.sceneFilename=r,this.extension=i}runTask(e,t,s){i.n.ImportMesh(this.meshesNames,this.rootUrl,this.sceneFilename,e,((e,s,r,i,o)=>{this.loadedMeshes=e,this.loadedTransformNodes=o,this.loadedParticleSystems=s,this.loadedSkeletons=r,this.loadedAnimationGroups=i,t()}),null,((e,t,r)=>{s(t,r)}),this.extension)}}class _ extends g{constructor(e,t){super(e),this.name=e,this.url=t}runTask(e,t,s){e._loadFile(this.url,(e=>{this.text=e,t()}),void 0,!1,!1,((e,t)=>{e&&s(e.status+" "+e.statusText,t)}))}}class A extends g{constructor(e,t){super(e),this.name=e,this.url=t}runTask(e,t,s){e._loadFile(this.url,(e=>{this.data=e,t()}),void 0,!0,!0,((e,t)=>{e&&s(e.status+" "+e.statusText,t)}))}}class v extends g{constructor(e,t){super(e),this.name=e,this.url=t}runTask(e,t,s){const r=new Image;o.w1.SetCorsBehavior(this.url,r),r.onload=()=>{this.image=r,t()},r.onerror=e=>{s("Error loading image",e)},r.src=this.url}}class C extends g{constructor(e,t,s,r=!0,i=a.x.TRILINEAR_SAMPLINGMODE){super(e),this.name=e,this.url=t,this.noMipmap=s,this.invertY=r,this.samplingMode=i}runTask(e,t,s){this.texture=new a.x(this.url,e,this.noMipmap,this.invertY,this.samplingMode,(()=>{t()}),((e,t)=>{s(e,t)}))}}class T extends g{constructor(e,t,s,r,i,o){super(e),this.name=e,this.url=t,this.extensions=s,this.noMipmap=r,this.files=i,this.prefiltered=o}runTask(e,t,s){this.texture=new c.B(this.url,e,this.extensions,this.noMipmap,this.files,(()=>{t()}),((e,t)=>{s(e,t)}),void 0,this.prefiltered)}}class w extends g{constructor(e,t,s,r=!1,i=!0,o=!1,n=!1){super(e),this.name=e,this.url=t,this.size=s,this.noMipmap=r,this.generateHarmonics=i,this.gammaSpace=o,this.reserved=n}runTask(e,t,s){this.texture=new l.e(this.url,e,this.size,this.noMipmap,this.generateHarmonics,this.gammaSpace,this.reserved,(()=>{t()}),((e,t)=>{s(e,t)}))}}class b extends g{constructor(e,t,s,r=!1,i=!0){super(e),this.name=e,this.url=t,this.size=s,this.noMipmap=r,this.gammaSpace=i}runTask(e,t,s){this.texture=new h._(this.url,e,this.size,this.noMipmap,this.gammaSpace,(()=>{t()}),((e,t)=>{s(e,t)}))}}class y{constructor(e){this._isLoading=!1,this._tasks=new Array,this._waitingTasksCount=0,this._totalTasksCount=0,this.onTaskSuccessObservable=new n.y$,this.onTaskErrorObservable=new n.y$,this.onTasksDoneObservable=new n.y$,this.onProgressObservable=new n.y$,this.useDefaultLoadingScreen=!0,this.autoHideLoadingUI=!0,this._scene=e||u.l.LastCreatedScene}addContainerTask(e,t,s,r,i){const o=new p(e,t,s,r,i);return this._tasks.push(o),o}addMeshTask(e,t,s,r,i){const o=new m(e,t,s,r,i);return this._tasks.push(o),o}addTextFileTask(e,t){const s=new _(e,t);return this._tasks.push(s),s}addBinaryFileTask(e,t){const s=new A(e,t);return this._tasks.push(s),s}addImageTask(e,t){const s=new v(e,t);return this._tasks.push(s),s}addTextureTask(e,t,s,r,i=a.x.TRILINEAR_SAMPLINGMODE){const o=new C(e,t,s,r,i);return this._tasks.push(o),o}addCubeTextureTask(e,t,s,r,i,o){const n=new T(e,t,s,r,i,o);return this._tasks.push(n),n}addHDRCubeTextureTask(e,t,s,r=!1,i=!0,o=!1,n=!1){const a=new w(e,t,s,r,i,o,n);return this._tasks.push(a),a}addEquiRectangularCubeTextureAssetTask(e,t,s,r=!1,i=!0){const o=new b(e,t,s,r,i);return this._tasks.push(o),o}removeTask(e){const t=this._tasks.indexOf(e);t>-1&&this._tasks.splice(t,1)}_decreaseWaitingTasksCount(e){this._waitingTasksCount--;try{this.onProgress&&this.onProgress(this._waitingTasksCount,this._totalTasksCount,e),this.onProgressObservable.notifyObservers(new f(this._waitingTasksCount,this._totalTasksCount,e))}catch(e){d.Y.Error("Error running progress callbacks.")}if(0===this._waitingTasksCount){try{const e=this._tasks.slice();this.onFinish&&this.onFinish(e);for(const t of e)if(t.taskState===r.DONE){const e=this._tasks.indexOf(t);e>-1&&this._tasks.splice(e,1)}this.onTasksDoneObservable.notifyObservers(this._tasks)}catch(e){d.Y.Error("Error running tasks-done callbacks.")}this._isLoading=!1,this.autoHideLoadingUI&&this._scene.getEngine().hideLoadingUI()}}_runTask(e){const t=(t,s)=>{e._setErrorObject(t,s),this.onTaskError?this.onTaskError(e):e.onError||d.Y.Error(this._formatTaskErrorMessage(e)),this.onTaskErrorObservable.notifyObservers(e),this._decreaseWaitingTasksCount(e)};e.run(this._scene,(()=>{try{this.onTaskSuccess&&this.onTaskSuccess(e),this.onTaskSuccessObservable.notifyObservers(e),this._decreaseWaitingTasksCount(e)}catch(e){t("Error executing task success callbacks",e)}}),t)}_formatTaskErrorMessage(e){let t="Unable to complete task "+e.name;return e.errorObject.message&&(t+=`: ${e.errorObject.message}`),e.errorObject.exception&&(t+=`: ${e.errorObject.exception}`),t}reset(){return this._isLoading=!1,this._tasks=new Array,this}load(){if(this._isLoading)return this;if(this._isLoading=!0,this._waitingTasksCount=this._tasks.length,this._totalTasksCount=this._tasks.length,0===this._waitingTasksCount)return this._isLoading=!1,this.onFinish&&this.onFinish(this._tasks),this.onTasksDoneObservable.notifyObservers(this._tasks),this;this.useDefaultLoadingScreen&&this._scene.getEngine().displayLoadingUI();for(let e=0;e<this._tasks.length;e++){const t=this._tasks[e];t.taskState===r.INIT&&this._runTask(t)}return this}loadAsync(){return new Promise(((e,t)=>{this._isLoading?e():(this.onTasksDoneObservable.addOnce((s=>{s&&s.length?t(s):e()})),this.load())}))}}},21004:(e,t,s)=>{s.d(t,{nG:()=>f,rz:()=>u});var r,i=s(13514),o=s(73803),n=s(59157),a=s(72739);!function(e){e[e.cTFETC1=0]="cTFETC1",e[e.cTFETC2=1]="cTFETC2",e[e.cTFBC1=2]="cTFBC1",e[e.cTFBC3=3]="cTFBC3",e[e.cTFBC4=4]="cTFBC4",e[e.cTFBC5=5]="cTFBC5",e[e.cTFBC7=6]="cTFBC7",e[e.cTFPVRTC1_4_RGB=8]="cTFPVRTC1_4_RGB",e[e.cTFPVRTC1_4_RGBA=9]="cTFPVRTC1_4_RGBA",e[e.cTFASTC_4x4=10]="cTFASTC_4x4",e[e.cTFATC_RGB=11]="cTFATC_RGB",e[e.cTFATC_RGBA_INTERPOLATED_ALPHA=12]="cTFATC_RGBA_INTERPOLATED_ALPHA",e[e.cTFRGBA32=13]="cTFRGBA32",e[e.cTFRGB565=14]="cTFRGB565",e[e.cTFBGR565=15]="cTFBGR565",e[e.cTFRGBA4444=16]="cTFRGBA4444",e[e.cTFFXT1_RGB=17]="cTFFXT1_RGB",e[e.cTFPVRTC2_4_RGB=18]="cTFPVRTC2_4_RGB",e[e.cTFPVRTC2_4_RGBA=19]="cTFPVRTC2_4_RGBA",e[e.cTFETC2_EAC_R11=20]="cTFETC2_EAC_R11",e[e.cTFETC2_EAC_RG11=21]="cTFETC2_EAC_RG11"}(r||(r={}));const c={JSModuleURL:"https://cdn.babylonjs.com/basisTranscoder/1/basis_transcoder.js",WasmModuleURL:"https://cdn.babylonjs.com/basisTranscoder/1/basis_transcoder.wasm"};let l=null,h=null,d=0;const u=(e,t)=>{const s=e instanceof ArrayBuffer?new Uint8Array(e):e;return new Promise(((e,r)=>{(l||(l=new Promise(((e,t)=>{h?e(h):i.w1.LoadFileAsync(c.WasmModuleURL).then((s=>{if("function"!=typeof URL)return t("Basis transcoder requires an environment with a URL constructor");const r=URL.createObjectURL(new Blob([`(${m})()`],{type:"application/javascript"}));h=new Worker(r);const i=s=>{"init"===s.data.action?(h.removeEventListener("message",i),e(h)):"error"===s.data.action&&t(s.data.error||"error initializing worker")};h.addEventListener("message",i),h.postMessage({action:"init",url:c.JSModuleURL,wasmBinary:s})})).catch(t)}))),l).then((()=>{const i=d++,o=t=>{"transcode"===t.data.action&&t.data.id===i&&(h.removeEventListener("message",o),t.data.success?e(t.data):r("Transcode is not supported on this device"))};h.addEventListener("message",o);const n=new Uint8Array(s.byteLength);n.set(new Uint8Array(s.buffer,s.byteOffset,s.byteLength)),h.postMessage({action:"transcode",id:i,imageData:n,config:t,ignoreSupportedFormats:false},[n.buffer])}),(e=>{r(e)}))}))},g=(e,t)=>{var s,r;let i=null===(s=t._gl)||void 0===s?void 0:s.TEXTURE_2D;e.isCube&&(i=null===(r=t._gl)||void 0===r?void 0:r.TEXTURE_CUBE_MAP),t._bindTextureDirectly(i,e,!0)},f=(e,t)=>{const s=e.getEngine();for(let c=0;c<t.fileInfo.images.length;c++){const l=t.fileInfo.images[c].levels[0];if(e._invertVScale=e.invertY,-1===t.format||t.format===r.cTFRGB565)if(e.type=10,e.format=4,!s._features.basisNeedsPOT||a.R.Log2(l.width)%1==0&&a.R.Log2(l.height)%1==0)e._invertVScale=!e.invertY,e.width=l.width+3&-4,e.height=l.height+3&-4,e.samplingMode=2,g(e,s),s._uploadDataToTextureDirectly(e,new Uint16Array(l.transcodedPixels.buffer),c,0,4,!0);else{const t=new n.l(s,n.S.Temp);e._invertVScale=e.invertY,t.type=10,t.format=4,t.width=l.width+3&-4,t.height=l.height+3&-4,g(t,s),s._uploadDataToTextureDirectly(t,new Uint16Array(l.transcodedPixels.buffer),c,0,4,!0),s._rescaleTexture(t,e,s.scenes[0],s._getInternalFormat(4),(()=>{s._releaseTexture(t),g(e,s)}))}else{e.width=l.width,e.height=l.height,e.generateMipMaps=t.fileInfo.images[c].levels.length>1;const r=p.GetInternalFormatFromBasisFormat(t.format,s);e.format=r,g(e,s),t.fileInfo.images[c].levels.forEach(((t,i)=>{s._uploadCompressedDataToTextureDirectly(e,r,t.width,t.height,t.transcodedPixels,c,i)})),!s._features.basisNeedsPOT||a.R.Log2(e.width)%1==0&&a.R.Log2(e.height)%1==0||(i.w1.Warn("Loaded .basis texture width and height are not a power of two. Texture wrapping will be set to Texture.CLAMP_ADDRESSMODE as other modes are not supported with non power of two dimensions in webGL 1."),e._cachedWrapU=o.x.CLAMP_ADDRESSMODE,e._cachedWrapV=o.x.CLAMP_ADDRESSMODE)}}},p={JSModuleURL:c.JSModuleURL,WasmModuleURL:c.WasmModuleURL,GetInternalFormatFromBasisFormat:(e,t)=>{let s;switch(e){case r.cTFETC1:s=36196;break;case r.cTFBC1:s=33776;break;case r.cTFBC4:s=33779;break;case r.cTFASTC_4x4:s=37808;break;case r.cTFETC2:s=37496;break;case r.cTFBC7:s=36492}if(void 0===s)throw"The chosen Basis transcoder format is not currently supported";return s},TranscodeAsync:u,LoadTextureFromTranscodeResult:f};function m(){const e=0,t=1,s=2,r=3,i=6,o=8,n=9,a=10,c=14;let l=null;function h(e,t,s,r,i){const o=e.getImageTranscodedSizeInBytes(t,s,r);let n=new Uint8Array(o);if(!e.transcodeImage(n,t,s,r,1,0))return null;if(i){n=function(e,t,s,r){const i=new Uint16Array(4),o=new Uint16Array(s*r),n=s/4,a=r/4;for(let r=0;r<a;r++)for(let a=0;a<n;a++){const c=t+8*(r*n+a);i[0]=e[c]|e[c+1]<<8,i[1]=e[c+2]|e[c+3]<<8,i[2]=(2*(31&i[0])+1*(31&i[1]))/3|(2*(2016&i[0])+1*(2016&i[1]))/3&2016|(2*(63488&i[0])+1*(63488&i[1]))/3&63488,i[3]=(2*(31&i[1])+1*(31&i[0]))/3|(2*(2016&i[1])+1*(2016&i[0]))/3&2016|(2*(63488&i[1])+1*(63488&i[0]))/3&63488;for(let t=0;t<4;t++){const n=e[c+4+t];let l=(4*r+t)*s+4*a;o[l++]=i[3&n],o[l++]=i[n>>2&3],o[l++]=i[n>>4&3],o[l++]=i[n>>6&3]}}return o}(n,0,e.getImageWidth(t,s)+3&-4,e.getImageHeight(t,s)+3&-4)}return n}onmessage=d=>{if("init"===d.data.action){if(!l){try{importScripts(d.data.url)}catch(e){postMessage({action:"error",error:e})}l=BASIS({wasmBinary:d.data.wasmBinary})}null!==l&&l.then((e=>{BASIS=e,e.initializeBasis(),postMessage({action:"init"})}))}else if("transcode"===d.data.action){const l=d.data.config,u=d.data.imageData,g=new BASIS.BasisFile(u),f=function(e){const t=e.getHasAlpha(),s=e.getNumImages(),r=[];for(let t=0;t<s;t++){const s={levels:[]},i=e.getNumLevels(t);for(let r=0;r<i;r++){const i={width:e.getImageWidth(t,r),height:e.getImageHeight(t,r)};s.levels.push(i)}r.push(s)}return{hasAlpha:t,images:r}}(g);let p=d.data.ignoreSupportedFormats?null:function(l,h){let d=null;l.supportedCompressionFormats&&(d=l.supportedCompressionFormats.astc?a:l.supportedCompressionFormats.bc7?i:l.supportedCompressionFormats.s3tc?h.hasAlpha?r:s:l.supportedCompressionFormats.pvrtc?h.hasAlpha?n:o:l.supportedCompressionFormats.etc2?t:l.supportedCompressionFormats.etc1?e:c);return d}(d.data.config,f),m=!1;null===p&&(m=!0,p=f.hasAlpha?r:s);let _=!0;g.startTranscoding()||(_=!1);const A=[];for(let e=0;e<f.images.length&&_;e++){const t=f.images[e];if(void 0===l.loadSingleImage||l.loadSingleImage===e){let s=t.levels.length;!1===l.loadMipmapLevels&&(s=1);for(let r=0;r<s;r++){const s=t.levels[r],i=h(g,e,r,p,m);if(!i){_=!1;break}s.transcodedPixels=i,A.push(s.transcodedPixels.buffer)}}}g.close(),g.delete(),m&&(p=-1),_?postMessage({action:"transcode",success:_,id:d.data.id,fileInfo:f,format:p},A):postMessage({action:"transcode",success:_,id:d.data.id})}}}Object.defineProperty(p,"JSModuleURL",{get:function(){return c.JSModuleURL},set:function(e){c.JSModuleURL=e}}),Object.defineProperty(p,"WasmModuleURL",{get:function(){return c.WasmModuleURL},set:function(e){c.WasmModuleURL=e}})},73556:(e,t,s)=>{s.d(t,{$:()=>a});var r=s(73803),i=s(95718),o=s(13514);let n=0;const a=e=>{if(!e.environmentBRDFTexture){const t=e.useDelayedTextureLoading;e.useDelayedTextureLoading=!1;const s=e._blockEntityCollection;e._blockEntityCollection=!1;const a=r.x.CreateFromBase64String("data:image/png;base64,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","EnvironmentBRDFTexture"+n++,e,!0,!1,r.x.BILINEAR_SAMPLINGMODE);e._blockEntityCollection=s;const c=e.getEngine().getLoadedTexturesCache(),l=c.indexOf(a.getInternalTexture());-1!==l&&c.splice(l,1),a.isRGBD=!0,a.wrapU=r.x.CLAMP_ADDRESSMODE,a.wrapV=r.x.CLAMP_ADDRESSMODE,e.environmentBRDFTexture=a,e.useDelayedTextureLoading=t,i.r.ExpandRGBDTexture(a);const h=e.getEngine().onContextRestoredObservable.add((()=>{a.isRGBD=!0;const e=()=>{a.isReady()?i.r.ExpandRGBDTexture(a):o.w1.SetImmediate(e)};e()}));e.onDisposeObservable.add((()=>{e.getEngine().onContextRestoredObservable.remove(h)}))}return e.environmentBRDFTexture}},31259:(e,t,s)=>{function r(e,t,s,r){let i=r,o=0,n="";for(;i<s.length;){const r=s.charAt(i);if(n)r===n?'"'===n||"'"===n?"\\"!==s.charAt(i-1)&&(n=""):n="":"*/"===n&&"*"===r&&i+1<s.length&&("/"===s.charAt(i+1)&&(n=""),""===n&&i++);else switch(r){case e:o++;break;case t:o--;break;case'"':case"'":case"`":n=r;break;case"/":if(i+1<s.length){const e=s.charAt(i+1);"/"===e?n="\n":"*"===e&&(n="*/")}}if(i++,0===o)break}return 0===o?i-1:-1}function i(e,t){for(;t<e.length;){const s=e[t];if(" "!==s&&"\n"!==s&&"\r"!==s&&"\t"!==s&&"\n"!==s&&"\xa0"!==s)break;t++}return t}function o(e){const t=e.charCodeAt(0);return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||95==t}function n(e){let t=0,s="",r=!1;const i=[];for(;t<e.length;){const o=e.charAt(t);if(s)o===s?'"'===s||"'"===s?("\\"!==e.charAt(t-1)&&(s=""),i.push(o)):(s="",r=!1):"*/"===s&&"*"===o&&t+1<e.length?("/"===e.charAt(t+1)&&(s=""),""===s&&(r=!1,t++)):r||i.push(o);else{switch(o){case'"':case"'":case"`":s=o;break;case"/":if(t+1<e.length){const i=e.charAt(t+1);"/"===i?(s="\n",r=!0):"*"===i&&(s="*/",r=!0)}}r||i.push(o)}t++}return i.join("")}function a(e,t,s){for(;t>=0&&e.charAt(t)!==s;)t--;return t}function c(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}s.d(t,{AW:()=>c,Kt:()=>n,Pm:()=>i,uA:()=>o,vt:()=>r,wm:()=>a})},97046:(e,t,s)=>{s.d(t,{p:()=>o});var r,i=s(77232);s(17041);!function(e){e[e.None=0]="None",e[e.ToLinearSpace=1]="ToLinearSpace",e[e.ToGammaSpace=2]="ToGammaSpace"}(r||(r={}));class o{_textureIsInternal(e){return void 0===e.getInternalTexture}constructor(e,t=!1){this._engine=e,this._isDepthTexture=t,this._renderer=new i.I(e),this._effectWrapper=new i.H({engine:e,name:"CopyTextureToTexture",fragmentShader:"copyTextureToTexture",useShaderStore:!0,uniformNames:["conversion"],samplerNames:["textureSampler"],defines:t?["#define DEPTH_TEXTURE"]:[]}),this._effectWrapper.onApplyObservable.add((()=>{t&&(e.setState(!1),e.setDepthBuffer(!0),e.depthCullingState.depthMask=!0,e.depthCullingState.depthFunc=519),this._textureIsInternal(this._source)?this._effectWrapper.effect._bindTexture("textureSampler",this._source):this._effectWrapper.effect.setTexture("textureSampler",this._source),this._effectWrapper.effect.setFloat("conversion",this._conversion)}))}isReady(){return this._effectWrapper.effect.isReady()}copy(e,t,s=r.None){if(!this.isReady())return!1;this._source=e,this._conversion=s;const i=this._engine.depthCullingState.depthFunc;return this._renderer.render(this._effectWrapper,t),this._isDepthTexture&&i&&(this._engine.depthCullingState.depthFunc=i),!0}dispose(){this._effectWrapper.dispose(),this._renderer.dispose()}}},50679:(e,t,s)=>{function r(e,t,s=!1){const r=t.width,i=t.height;if(e instanceof Float32Array){let t=e.byteLength/e.BYTES_PER_ELEMENT;const s=new Uint8Array(t);for(;--t>=0;){let r=e[t];r<0?r=0:r>1&&(r=1),s[t]=255*r}e=s}const o=document.createElement("canvas");o.width=r,o.height=i;const n=o.getContext("2d");if(!n)return null;const a=n.createImageData(r,i);if(a.data.set(e),n.putImageData(a,0,0),s){const e=document.createElement("canvas");e.width=r,e.height=i;const t=e.getContext("2d");return t?(t.translate(0,i),t.scale(1,-1),t.drawImage(o,0,0),e.toDataURL("image/png")):null}return o.toDataURL("image/png")}function i(e,t=0,s=0){const i=e.getInternalTexture();if(!i)return null;const o=e._readPixelsSync(t,s);return o?r(o,e.getSize(),i.invertY):null}async function o(e,t=0,s=0){const i=e.getInternalTexture();if(!i)return null;const o=await e.readPixels(t,s);return o?r(o,e.getSize(),i.invertY):null}s.d(t,{Jj:()=>o,_u:()=>i})},24539:(e,t,s)=>{function r(e,t,s){try{const r=e.next();r.done?t(r):r.value?r.value.then((()=>{r.value=void 0,t(r)}),s):t(r)}catch(e){s(e)}}function i(e=25){let t;return(s,i,o)=>{const n=performance.now();void 0===t||n-t>e?(t=n,setTimeout((()=>{r(s,i,o)}),0)):r(s,i,o)}}function o(e,t,s,r,i){const o=()=>{let n;const a=e=>{e.done?s(e.value):void 0===n?n=!0:o()};do{n=void 0,i&&i.aborted?r(new Error("Aborted")):t(e,a,r),void 0===n&&(n=!1)}while(n)};o()}function n(e,t){let s;return o(e,r,(e=>s=e),(e=>{throw e}),t),s}function a(e,t,s){return new Promise(((r,i)=>{o(e,t,r,i,s)}))}function c(e,t){return(...s)=>n(e(...s),t)}s.d(t,{KO:()=>i,WP:()=>r,s3:()=>n,sM:()=>a,vp:()=>c})},21879:(e,t,s)=>{s.d(t,{d:()=>i});var r=s(29972);class i{constructor(e){this.byteOffset=0,this.buffer=e}loadAsync(e){return this.buffer.readAsync(this.byteOffset,e).then((e=>{this._dataView=new DataView(e.buffer,e.byteOffset,e.byteLength),this._dataByteOffset=0}))}readUint32(){const e=this._dataView.getUint32(this._dataByteOffset,!0);return this._dataByteOffset+=4,this.byteOffset+=4,e}readUint8Array(e){const t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._dataByteOffset,e);return this._dataByteOffset+=e,this.byteOffset+=e,t}readString(e){return(0,r.fJ)(this.readUint8Array(e))}skipBytes(e){this._dataByteOffset+=e,this.byteOffset+=e}}},88910:(e,t,s)=>{s.d(t,{N:()=>A});var r=s(72739),i=s(69314),o=s(59157),n=s(84318),a=s(93354),c=s(39126),l=s(61159),h=s(80949);s(90052);const d=131072,u=131072;function g(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}const f=g("DXT1"),p=g("DXT3"),m=g("DXT5"),_=g("DX10");class A{static GetDDSInfo(e){const t=new Int32Array(e.buffer,e.byteOffset,31),s=new Int32Array(e.buffer,e.byteOffset,35);let r=1;t[2]&d&&(r=Math.max(1,t[7]));const i=t[21],o=i===_?s[32]:0;let n=0;switch(i){case 113:n=2;break;case 116:n=1;break;case _:if(10===o){n=2;break}if(2===o){n=1;break}}return{width:t[4],height:t[3],mipmapCount:r,isFourCC:4==(4&t[20]),isRGB:64==(64&t[20]),isLuminance:(t[20]&u)===u,isCube:512==(512&t[28]),isCompressed:i===f||i===p||i===m,dxgiFormat:o,textureType:n}}static _GetHalfFloatAsFloatRGBAArrayBuffer(e,t,s,r,i,o){const n=new Float32Array(r),a=new Uint16Array(i,s);let c=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const r=4*(t+s*e);n[c]=(0,h.qZ)(a[r]),n[c+1]=(0,h.qZ)(a[r+1]),n[c+2]=(0,h.qZ)(a[r+2]),A.StoreLODInAlphaChannel?n[c+3]=o:n[c+3]=(0,h.qZ)(a[r+3]),c+=4}return n}static _GetHalfFloatRGBAArrayBuffer(e,t,s,r,i,o){if(A.StoreLODInAlphaChannel){const n=new Uint16Array(r),a=new Uint16Array(i,s);let c=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const r=4*(t+s*e);n[c]=a[r],n[c+1]=a[r+1],n[c+2]=a[r+2],n[c+3]=(0,h.ay)(o),c+=4}return n}return new Uint16Array(i,s,r)}static _GetFloatRGBAArrayBuffer(e,t,s,r,i,o){if(A.StoreLODInAlphaChannel){const n=new Float32Array(r),a=new Float32Array(i,s);let c=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const r=4*(t+s*e);n[c]=a[r],n[c+1]=a[r+1],n[c+2]=a[r+2],n[c+3]=o,c+=4}return n}return new Float32Array(i,s,r)}static _GetFloatAsHalfFloatRGBAArrayBuffer(e,t,s,r,i,o){const n=new Uint16Array(r),a=new Float32Array(i,s);let c=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++)n[c]=(0,h.ay)(a[c]),n[c+1]=(0,h.ay)(a[c+1]),n[c+2]=(0,h.ay)(a[c+2]),A.StoreLODInAlphaChannel?n[c+3]=(0,h.ay)(o):n[c+3]=(0,h.ay)(a[c+3]),c+=4;return n}static _GetFloatAsUIntRGBAArrayBuffer(e,t,s,i,o,n){const a=new Uint8Array(i),c=new Float32Array(o,s);let l=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const i=4*(t+s*e);a[l]=255*r.R.Clamp(c[i]),a[l+1]=255*r.R.Clamp(c[i+1]),a[l+2]=255*r.R.Clamp(c[i+2]),A.StoreLODInAlphaChannel?a[l+3]=n:a[l+3]=255*r.R.Clamp(c[i+3]),l+=4}return a}static _GetHalfFloatAsUIntRGBAArrayBuffer(e,t,s,i,o,n){const a=new Uint8Array(i),c=new Uint16Array(o,s);let l=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const i=4*(t+s*e);a[l]=255*r.R.Clamp((0,h.qZ)(c[i])),a[l+1]=255*r.R.Clamp((0,h.qZ)(c[i+1])),a[l+2]=255*r.R.Clamp((0,h.qZ)(c[i+2])),A.StoreLODInAlphaChannel?a[l+3]=n:a[l+3]=255*r.R.Clamp((0,h.qZ)(c[i+3])),l+=4}return a}static _GetRGBAArrayBuffer(e,t,s,r,i,o,n,a,c){const l=new Uint8Array(r),h=new Uint8Array(i,s);let d=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const r=4*(t+s*e);l[d]=h[r+o],l[d+1]=h[r+n],l[d+2]=h[r+a],l[d+3]=h[r+c],d+=4}return l}static _ExtractLongWordOrder(e){return 0===e||255===e||-16777216===e?0:1+A._ExtractLongWordOrder(e>>8)}static _GetRGBArrayBuffer(e,t,s,r,i,o,n,a){const c=new Uint8Array(r),l=new Uint8Array(i,s);let h=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const r=3*(t+s*e);c[h]=l[r+o],c[h+1]=l[r+n],c[h+2]=l[r+a],h+=3}return c}static _GetLuminanceArrayBuffer(e,t,s,r,i){const o=new Uint8Array(r),n=new Uint8Array(i,s);let a=0;for(let s=0;s<t;s++)for(let t=0;t<e;t++){const r=t+s*e;o[a]=n[r],a++}return o}static UploadDDSLevels(e,t,s,r,i,o,c=-1,l,h=!0){let u=null;r.sphericalPolynomial&&(u=new Array);const g=!!e.getCaps().s3tc;t.generateMipMaps=i;const v=new Int32Array(s.buffer,s.byteOffset,31);let C,T,w,b,y,P,x,E=0,B=0,R=1;if(542327876!==v[0])return void n.Y.Error("Invalid magic number in DDS header");if(!r.isFourCC&&!r.isRGB&&!r.isLuminance)return void n.Y.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(r.isCompressed&&!g)return void n.Y.Error("Compressed textures are not supported on this platform.");let S=v[22];b=v[1]+4;let D=!1;if(r.isFourCC)switch(C=v[21],C){case f:R=8,B=33777;break;case p:R=16,B=33778;break;case m:R=16,B=33779;break;case 113:D=!0,S=64;break;case 116:D=!0,S=128;break;case _:{b+=20;let e=!1;switch(r.dxgiFormat){case 10:D=!0,S=64,e=!0;break;case 2:D=!0,S=128,e=!0;break;case 88:r.isRGB=!0,r.isFourCC=!1,S=32,e=!0}if(e)break}default:return void console.error("Unsupported FourCC code:",(F=C,String.fromCharCode(255&F,F>>8&255,F>>16&255,F>>24&255)))}var F;const I=A._ExtractLongWordOrder(v[23]),L=A._ExtractLongWordOrder(v[24]),U=A._ExtractLongWordOrder(v[25]),M=A._ExtractLongWordOrder(v[26]);D&&(B=e._getRGBABufferInternalSizedFormat(r.textureType)),P=1,v[2]&d&&!1!==i&&(P=Math.max(1,v[7]));const k=l||0,O=e.getCaps();for(let i=k;i<o;i++){for(T=v[4],w=v[3],x=0;x<P;++x){if(-1===c||c===x){const o=-1===c?x:0;if(!r.isCompressed&&r.isFourCC){t.format=5,E=T*w*4;let r=null;if(e._badOS||e._badDesktopOS||!O.textureHalfFloat&&!O.textureFloat)128===S?(r=A._GetFloatAsUIntRGBAArrayBuffer(T,w,s.byteOffset+b,E,s.buffer,o),u&&0==o&&u.push(A._GetFloatRGBAArrayBuffer(T,w,s.byteOffset+b,E,s.buffer,o))):64===S&&(r=A._GetHalfFloatAsUIntRGBAArrayBuffer(T,w,s.byteOffset+b,E,s.buffer,o),u&&0==o&&u.push(A._GetHalfFloatAsFloatRGBAArrayBuffer(T,w,s.byteOffset+b,E,s.buffer,o))),t.type=0;else{const e=O.textureFloat&&(h&&O.textureFloatLinearFiltering||!h),i=O.textureHalfFloat&&(h&&O.textureHalfFloatLinearFiltering||!h),n=(128===S||64===S&&!i)&&e?1:(64===S||128===S&&!e)&&i?2:0;let a,c=null;if(128===S)switch(n){case 1:a=A._GetFloatRGBAArrayBuffer,c=null;break;case 2:a=A._GetFloatAsHalfFloatRGBAArrayBuffer,c=A._GetFloatRGBAArrayBuffer;break;case 0:a=A._GetFloatAsUIntRGBAArrayBuffer,c=A._GetFloatRGBAArrayBuffer}else switch(n){case 1:a=A._GetHalfFloatAsFloatRGBAArrayBuffer,c=null;break;case 2:a=A._GetHalfFloatRGBAArrayBuffer,c=A._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:a=A._GetHalfFloatAsUIntRGBAArrayBuffer,c=A._GetHalfFloatAsFloatRGBAArrayBuffer}t.type=n,r=a(T,w,s.byteOffset+b,E,s.buffer,o),u&&0==o&&u.push(c?c(T,w,s.byteOffset+b,E,s.buffer,o):r)}r&&e._uploadDataToTextureDirectly(t,r,i,o)}else if(r.isRGB)t.type=0,24===S?(t.format=4,E=T*w*3,y=A._GetRGBArrayBuffer(T,w,s.byteOffset+b,E,s.buffer,I,L,U),e._uploadDataToTextureDirectly(t,y,i,o)):(t.format=5,E=T*w*4,y=A._GetRGBAArrayBuffer(T,w,s.byteOffset+b,E,s.buffer,I,L,U,M),e._uploadDataToTextureDirectly(t,y,i,o));else if(r.isLuminance){const r=e._getUnpackAlignement(),n=T;E=Math.floor((T+r-1)/r)*r*(w-1)+n,y=A._GetLuminanceArrayBuffer(T,w,s.byteOffset+b,E,s.buffer),t.format=1,t.type=0,e._uploadDataToTextureDirectly(t,y,i,o)}else E=Math.max(4,T)/4*Math.max(4,w)/4*R,y=new Uint8Array(s.buffer,s.byteOffset+b,E),t.type=0,e._uploadCompressedDataToTextureDirectly(t,B,T,w,y,i,o)}b+=S?T*w*(S/8):E,T*=.5,w*=.5,T=Math.max(1,T),w=Math.max(1,w)}if(void 0!==l)break}u&&u.length>0?r.sphericalPolynomial=a.$.ConvertCubeMapToSphericalPolynomial({size:v[4],right:u[0],left:u[1],up:u[2],down:u[3],front:u[4],back:u[5],format:5,type:1,gammaSpace:!1}):r.sphericalPolynomial=void 0}}A.StoreLODInAlphaChannel=!1,l.B.prototype.createPrefilteredCubeTexture=function(e,t,s,a,l=null,h=null,d,u=null,g=!0){return this.createCubeTexture(e,t,null,!1,(e=>{if(!e)return void(l&&l(null));const h=e.texture;if(g?e.info.sphericalPolynomial&&(h._sphericalPolynomial=e.info.sphericalPolynomial):h._sphericalPolynomial=new i.i,h._source=o.S.CubePrefiltered,this.getCaps().textureLOD)return void(l&&l(h));const d=this._gl,u=e.width;if(!u)return;const f=[];for(let i=0;i<3;i++){const l=1-i/2,g=a,p=r.R.Log2(u)*s+a,m=g+(p-g)*l,_=Math.round(Math.min(Math.max(m,0),p)),v=new o.l(this,o.S.Temp);if(v.type=h.type,v.format=h.format,v.width=Math.pow(2,Math.max(r.R.Log2(u)-_,0)),v.height=v.width,v.isCube=!0,v._cachedWrapU=0,v._cachedWrapV=0,this._bindTextureDirectly(d.TEXTURE_CUBE_MAP,v,!0),v.samplingMode=2,d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),e.isDDS){const t=e.info,s=e.data;this._unpackFlipY(t.isCompressed),A.UploadDDSLevels(this,v,s,t,!0,6,_)}else n.Y.Warn("DDS is the only prefiltered cube map supported so far.");this._bindTextureDirectly(d.TEXTURE_CUBE_MAP,null);const C=new c.V(t);C._isCube=!0,C._texture=v,v.isReady=!0,f.push(C)}h._lodTextureHigh=f[2],h._lodTextureMid=f[1],h._lodTextureLow=f[0],l&&l(h)}),h,d,u,g,s,a)}},96969:(e,t,s)=>{s.d(t,{G6:()=>E,N$:()=>C,QC:()=>_,RR:()=>v,VE:()=>P,XX:()=>T,hd:()=>A,mv:()=>b,n9:()=>p,oQ:()=>y,oU:()=>f,p4:()=>x,qC:()=>g,qQ:()=>m,rX:()=>w,wz:()=>u});var r=s(20163),i=s(58095),o=s(77851),n=s(15631);const a={},c={},l=function(e,t,s){const i=e();r.$&&r.$.AddTagsTo(i,t.tags);const o=h(i);for(const e in o){const r=o[e],n=t[e],a=r.type;if(null!=n&&("uniqueId"!==e||x.AllowLoadingUniqueId))switch(a){case 0:case 6:case 11:i[e]=n;break;case 1:i[e]=s||n.isRenderTarget?n:n.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:i[e]=s?n:n.clone()}}return i};function h(e){const t=e.getClassName();if(c[t])return c[t];c[t]={};const s=c[t];let r=e,i=t;for(;i;){const e=a[i];for(const t in e)s[t]=e[t];let t,o=!1;do{if(t=Object.getPrototypeOf(r),!t.getClassName){o=!0;break}if(t.getClassName()!==i)break;r=t}while(t);if(o)break;i=t.getClassName(),r=t}return s}function d(e,t){return(s,r)=>{const i=function(e){const t=e.getClassName();return a[t]||(a[t]={}),a[t]}(s);i[r]||(i[r]={type:e,sourceName:t})}}function u(e,t=null){return function(e,t=null){return(s,r)=>{const i=t||"_"+r;Object.defineProperty(s,r,{get:function(){return this[i]},set:function(t){"function"==typeof this.equals&&this.equals(t)||this[i]!==t&&(this[i]=t,s[e].apply(this))},enumerable:!0,configurable:!0})}}(e,t)}function g(e){return d(0,e)}function f(e){return d(1,e)}function p(e){return d(2,e)}function m(e){return d(3,e)}function _(e){return d(4,e)}function A(e){return d(5,e)}function v(e){return d(6,e)}function C(e){return d(7,e)}function T(e){return d(8,e)}function w(e){return d(9,e)}function b(e){return d(10,e)}function y(e){return d(12,e)}function P(e){return d(11,e)}class x{static AppendSerializedAnimations(e,t){if(e.animations){t.animations=[];for(let s=0;s<e.animations.length;s++){const r=e.animations[s];t.animations.push(r.serialize())}}}static Serialize(e,t){t||(t={}),r.$&&(t.tags=r.$.GetTags(e));const s=h(e);for(const r in s){const i=s[r],o=i.sourceName||r,n=i.type,a=e[r];if(null!=a&&("uniqueId"!==r||x.AllowLoadingUniqueId))switch(n){case 0:t[o]=a;break;case 1:case 3:case 7:case 9:t[o]=a.serialize();break;case 2:case 4:case 5:case 8:case 10:case 12:t[o]=a.asArray();break;case 6:case 11:t[o]=a.id}}return t}static Parse(e,t,s,o=null){const a=e();o||(o=""),r.$&&r.$.AddTagsTo(a,t.tags);const c=h(a);for(const e in c){const r=c[e],l=t[r.sourceName||e],h=r.type;if(null!=l&&("uniqueId"!==e||x.AllowLoadingUniqueId)){const t=a;switch(h){case 0:t[e]=l;break;case 1:s&&(t[e]=x._TextureParser(l,s,o));break;case 2:t[e]=n.Wo.FromArray(l);break;case 3:t[e]=x._FresnelParametersParser(l);break;case 4:t[e]=i.FM.FromArray(l);break;case 5:t[e]=i.P.FromArray(l);break;case 6:s&&(t[e]=s.getLastMeshById(l));break;case 7:t[e]=x._ColorCurvesParser(l);break;case 8:t[e]=n.HE.FromArray(l);break;case 9:t[e]=x._ImageProcessingConfigurationParser(l);break;case 10:t[e]=i._f.FromArray(l);break;case 11:s&&(t[e]=s.getCameraById(l));break;case 12:t[e]=i.y3.FromArray(l)}}}return a}static Clone(e,t){return l(e,t,!1)}static Instanciate(e,t){return l(e,t,!0)}}function E(e,t,s,r){const i=s.value;s.value=(...s)=>{let o=i;if("undefined"!=typeof _native&&_native[t]){const e=_native[t];o=r?(...t)=>r(...t)?e(...t):i(...t):e}return e[t]=o,o(...s)}}x.AllowLoadingUniqueId=!1,x._ImageProcessingConfigurationParser=e=>{throw(0,o.S)("ImageProcessingConfiguration")},x._FresnelParametersParser=e=>{throw(0,o.S)("FresnelParameters")},x._ColorCurvesParser=e=>{throw(0,o.S)("ColorCurves")},x._TextureParser=(e,t,s)=>{throw(0,o.S)("Texture")},E.filter=function(e){return(t,s,r)=>E(t,s,r,e)}},1101:(e,t,s)=>{s.d(t,{j:()=>o});var r=s(84318);const i=(e,t)=>e?e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&"SubMesh"===e.getClassName()?e.clone(t):e.clone?e.clone():null:null;class o{static DeepCopy(e,t,s,o){const n=function(e){const t=[];do{Object.getOwnPropertyNames(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)}))}while(e=Object.getPrototypeOf(e));return t}(e);for(const a of n){if("_"===a[0]&&(!o||-1===o.indexOf(a)))continue;if(a.endsWith("Observable"))continue;if(s&&-1!==s.indexOf(a))continue;const n=e[a],c=typeof n;if("function"!==c)try{if("object"===c)if(n instanceof Array){if(t[a]=[],n.length>0)if("object"==typeof n[0])for(let e=0;e<n.length;e++){const s=i(n[e],t);-1===t[a].indexOf(s)&&t[a].push(s)}else t[a]=n.slice(0)}else t[a]=i(n,t);else t[a]=n}catch(e){r.Y.Warn(e.message)}}}}},94138:(e,t,s)=>{s.d(t,{B:()=>r});class r{get resolve(){return this._resolve}get reject(){return this._reject}constructor(){this.promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}}},39521:(e,t,s)=>{s.d(t,{j:()=>o});var r=s(42585),i=s(88114);class o extends i.d{get depthRenderer(){return this._depthRenderer}constructor(e){super(e)}setDepthRenderer(e=null,t=2,s=!0){const i=this._camera.getScene();this._depthRenderer&&(delete i._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),this._depthRenderer=null),null===e&&(i._depthRenderer||(i._depthRenderer={}),(e=this._depthRenderer=new r.g(i,t,this._camera,!1,1)).enabled=!1,this._depthRendererId="minmax"+this._camera.id,i._depthRenderer[this._depthRendererId]=e),super.setSourceTexture(e.getDepthMap(),!0,t,s)}setSourceTexture(e,t,s=2,r=!0){super.setSourceTexture(e,t,s,r)}activate(){this._depthRenderer&&(this._depthRenderer.enabled=!0),super.activate()}deactivate(){super.deactivate(),this._depthRenderer&&(this._depthRenderer.enabled=!1)}dispose(e=!0){if(super.dispose(e),this._depthRenderer&&e){const e=this._depthRenderer.getDepthMap().getScene();e&&delete e._depthRenderer[this._depthRendererId],this._depthRenderer.dispose(),this._depthRenderer=null}}}},77851:(e,t,s)=>{function r(e){return`${e} needs to be imported before as it contains a side-effect required by your code.`}s.d(t,{S:()=>r})},80352:(e,t,s)=>{function r(){return"undefined"!=typeof window}function i(){return"undefined"!=typeof navigator}function o(){return"undefined"!=typeof document}function n(e){let t="",s=e.firstChild;for(;s;)3===s.nodeType&&(t+=s.textContent),s=s.nextSibling;return t}s.d(t,{CG:()=>r,MZ:()=>a,n5:()=>o,up:()=>i,v:()=>n});const a={IsWindowObjectExist:r,IsNavigatorAvailable:i,IsDocumentAvailable:o,GetDOMTextContent:n}},74802:(e,t,s)=>{s.d(t,{B:()=>a});var r=s(61159),i=s(77232),o=s(13514),n=s(38731);class a{static _CreateDumpRenderer(){if(!a._DumpToolsEngine){const e=document.createElement("canvas"),t=new r.B(e,!1,{preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1});t.getCaps().parallelShaderCompile=void 0;const s=new i.I(t),o=new i.H({engine:t,name:n.T.name,fragmentShader:n.T.shader,samplerNames:["textureSampler"]});a._DumpToolsEngine={canvas:e,engine:t,renderer:s,wrapper:o}}return a._DumpToolsEngine}static async DumpFramebuffer(e,t,s,r,i="image/png",o){const n=await s.readPixels(0,0,e,t),c=new Uint8Array(n.buffer);a.DumpData(e,t,c,r,i,o,!0)}static DumpDataAsync(e,t,s,r="image/png",i,o=!1,n=!1,c){return new Promise((l=>{a.DumpData(e,t,s,(e=>l(e)),r,i,o,n,c)}))}static DumpData(e,t,s,r,i="image/png",n,c=!1,l=!1,h){const d=a._CreateDumpRenderer();if(d.engine.setSize(e,t,!0),s instanceof Float32Array){const e=new Uint8Array(s.length);let t=s.length;for(;t--;){const r=s[t];e[t]=r<0?0:r>1?1:Math.round(255*r)}s=e}const u=d.engine.createRawTexture(s,e,t,5,!1,!c,1);d.renderer.setViewport(),d.renderer.applyEffectWrapper(d.wrapper),d.wrapper.effect._bindTexture("textureSampler",u),d.renderer.draw(),l?o.w1.ToBlob(d.canvas,(e=>{const t=new FileReader;t.onload=e=>{const t=e.target.result;r&&r(t)},t.readAsArrayBuffer(e)}),i,h):o.w1.EncodeScreenshotCanvasData(d.canvas,r,i,n,h),u.dispose()}static Dispose(){a._DumpToolsEngine&&(a._DumpToolsEngine.wrapper.dispose(),a._DumpToolsEngine.renderer.dispose(),a._DumpToolsEngine.engine.dispose()),a._DumpToolsEngine=null}}o.w1.DumpData=a.DumpData,o.w1.DumpDataAsync=a.DumpDataAsync,o.w1.DumpFramebuffer=a.DumpFramebuffer},71892:(e,t,s)=>{s.d(t,{Do:()=>p,Lf:()=>C,Ro:()=>m,qC:()=>v,qJ:()=>g});var r=s(13514),i=s(58095),o=s(72739),n=s(69314),a=s(59157),c=s(39126),l=(s(65273),s(16142)),h=s(84318);s(95718),s(74500),s(5382),s(7023),s(18917),s(87866),s(74802);const d="image/png",u=[134,22,135,150,246,214,150,54];function g(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let s=0;for(let e=0;e<u.length;e++)if(t.getUint8(s++)!==u[e])return h.Y.Error("Not a babylon environment map"),null;let r="",i=0;for(;i=t.getUint8(s++);)r+=String.fromCharCode(i);let o=JSON.parse(r);return o=f(o),o.specular&&(o.specular.specularDataPosition=s,o.specular.lodGenerationScale=o.specular.lodGenerationScale||.8),o}function f(e){if(e.version>2)throw new Error(`Unsupported babylon environment map version "${e.version}". Latest supported version is "2".`);return 2===e.version?e:e={...e,version:2,imageType:d}}function p(e,t){const s=(t=f(t)).specular;let r=o.R.Log2(t.width);if(r=Math.round(r)+1,s.mipmaps.length!==6*r)throw new Error(`Unsupported specular mipmaps number "${s.mipmaps.length}"`);const i=new Array(r);for(let t=0;t<r;t++){i[t]=new Array(6);for(let r=0;r<6;r++){const o=s.mipmaps[6*t+r];i[t][r]=new Uint8Array(e.buffer,e.byteOffset+s.specularDataPosition+o.position,o.length)}}return i}function m(e,t,s){const r=(s=f(s)).specular;if(!r)return Promise.resolve();e._lodGenerationScale=r.lodGenerationScale;return A(e,p(t,s),s.imageType)}function _(e,t,s,r,i,o,n,a,c,l,h){return new Promise(((d,u)=>{if(s){const s=t.createTexture(null,!0,!0,null,1,null,(e=>{u(e)}),e);r.getEffect().executeWhenCompiled((()=>{r.externalTextureSamplerBinding=!0,r.onApply=r=>{r._bindTexture("textureSampler",s),r.setFloat2("scale",1,t._features.needsInvertingBitmap&&e instanceof ImageBitmap?-1:1)},t.scenes.length&&(t.scenes[0].postProcessManager.directRender([r],l,!0,o,n),t.restoreDefaultFramebuffer(),s.dispose(),URL.revokeObjectURL(i),d())}))}else{if(t._uploadImageToTexture(h,e,o,n),a){const s=c[n];s&&t._uploadImageToTexture(s._texture,e,o,0)}d()}}))}function A(e,t,s="image/png"){if(!r.w1.IsExponentOfTwo(e.width))throw new Error("Texture size must be a power of two");const i=o.R.ILog2(e.width)+1,n=e.getEngine();let h=!1,d=!1,u=null,g=null,f=null;const p=n.getCaps();if(e.format=5,e.type=0,e.generateMipMaps=!0,e._cachedAnisotropicFilteringLevel=null,n.updateTextureSamplingMode(3,e),p.textureLOD?n._features.supportRenderAndCopyToLodForFloatTextures?p.textureHalfFloatRender&&p.textureHalfFloatLinearFiltering?(h=!0,e.type=2):p.textureFloatRender&&p.textureFloatLinearFiltering&&(h=!0,e.type=1):h=!1:(h=!1,d=!0,f={}),h)u=new l.D("rgbdDecode","rgbdDecode",null,null,1,null,3,n,!1,void 0,e.type,void 0,null,!1),e._isRGBD=!1,e.invertY=!1,g=n.createRenderTargetCubeTexture(e.width,{generateDepthBuffer:!1,generateMipMaps:!0,generateStencilBuffer:!1,samplingMode:3,type:e.type,format:5});else if(e._isRGBD=!0,e.invertY=!0,d){const t=3,s=e._lodGenerationScale,r=e._lodGenerationOffset;for(let o=0;o<t;o++){const l=(i-1)*s+r,h=r+(l-r)*(1-o/(t-1)),d=Math.round(Math.min(Math.max(h,0),l)),u=new a.l(n,a.S.Temp);u.isCube=!0,u.invertY=!0,u.generateMipMaps=!1,n.updateTextureSamplingMode(2,u);const g=new c.V(null);switch(g._isCube=!0,g._texture=u,f[d]=g,o){case 0:e._lodTextureLow=g;break;case 1:e._lodTextureMid=g;break;case 2:e._lodTextureHigh=g}}}const m=[];for(let r=0;r<t.length;r++)for(let i=0;i<6;i++){const o=t[r][i],a=new Blob([o],{type:s}),c=URL.createObjectURL(a);let l;if("undefined"==typeof Image||n._features.forceBitmapOverHTMLImageElement)l=n.createImageBitmap(a,{premultiplyAlpha:"none"}).then((t=>_(t,n,h,u,c,i,r,d,f,g,e)));else{const t=new Image;t.src=c,l=new Promise(((s,o)=>{t.onload=()=>{_(t,n,h,u,c,i,r,d,f,g,e).then((()=>s())).catch((e=>{o(e)}))},t.onerror=e=>{o(e)}}))}m.push(l)}if(t.length<i){let s;const r=Math.pow(2,i-1-t.length),o=r*r*4;switch(e.type){case 0:s=new Uint8Array(o);break;case 2:s=new Uint16Array(o);break;case 1:s=new Float32Array(o)}for(let r=t.length;r<i;r++)for(let t=0;t<6;t++)n._uploadArrayBufferViewToTexture(e,s,t,r)}return Promise.all(m).then((()=>{g&&(n._releaseTexture(e),g._swapAndDie(e)),u&&u.dispose(),d&&(e._lodTextureHigh&&e._lodTextureHigh._texture&&(e._lodTextureHigh._texture.isReady=!0),e._lodTextureMid&&e._lodTextureMid._texture&&(e._lodTextureMid._texture.isReady=!0),e._lodTextureLow&&e._lodTextureLow._texture&&(e._lodTextureLow._texture.isReady=!0))}))}function v(e,t){const s=(t=f(t)).irradiance;if(!s)return;const r=new n.i;i.P.FromArrayToRef(s.x,0,r.x),i.P.FromArrayToRef(s.y,0,r.y),i.P.FromArrayToRef(s.z,0,r.z),i.P.FromArrayToRef(s.xx,0,r.xx),i.P.FromArrayToRef(s.yy,0,r.yy),i.P.FromArrayToRef(s.zz,0,r.zz),i.P.FromArrayToRef(s.yz,0,r.yz),i.P.FromArrayToRef(s.zx,0,r.zx),i.P.FromArrayToRef(s.xy,0,r.xy),e._sphericalPolynomial=r}function C(e,t,s,r,i){const o=A(e.getEngine().createRawCubeTexture(null,e.width,e.format,e.type,e.generateMipMaps,e.invertY,e.samplingMode,e._compression),t).then((()=>e));return e.onRebuildCallback=e=>({proxy:o,isReady:!0,isAsync:!0}),e._source=a.S.CubeRawRGBD,e._bufferViewArrayArray=t,e._lodGenerationScale=r,e._lodGenerationOffset=i,e._sphericalPolynomial=s,A(e,t).then((()=>(e.isReady=!0,e)))}},46223:(e,t,s)=>{s.d(t,{GU:()=>r,LH:()=>o,SM:()=>i});class r extends Error{}r._setPrototypeOf=Object.setPrototypeOf||((e,t)=>(e.__proto__=t,e));const i={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class o extends r{constructor(e,t,s){super(e),this.errorCode=t,this.innerError=s,this.name="RuntimeError",r._setPrototypeOf(this,o.prototype)}}},79245:(e,t,s)=>{s.d(t,{$K:()=>R,$M:()=>T,FV:()=>P,Ip:()=>b,VL:()=>E,eh:()=>m,r6:()=>w,rN:()=>v,vP:()=>y});var r=s(51912),i=s(80352),o=s(62897),n=s(64436),a=s(42874),c=s(46223),l=s(29972),h=s(91153),d=s(61159),u=s(15210),g=s(84318),f=s(44335);const p=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class m extends c.LH{constructor(e,t){super(e,c.SM.LoadFileError),this.name="LoadFileError",c.GU._setPrototypeOf(this,m.prototype),t instanceof r.g?this.request=t:this.file=t}}class _ extends c.LH{constructor(e,t){super(e,c.SM.RequestFileError),this.request=t,this.name="RequestFileError",c.GU._setPrototypeOf(this,_.prototype)}}class A extends c.LH{constructor(e,t){super(e,c.SM.ReadFileError),this.file=t,this.name="ReadFileError",c.GU._setPrototypeOf(this,A.prototype)}}const v={DefaultRetryStrategy:a.b.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:e=>e},C=e=>e=e.replace(/#/gm,"%23"),T=(e,t)=>{if((!e||0!==e.indexOf("data:"))&&v.CorsBehavior)if("string"==typeof v.CorsBehavior||v.CorsBehavior instanceof String)t.crossOrigin=v.CorsBehavior;else{const s=v.CorsBehavior(e);s&&(t.crossOrigin=s)}},w=(e,t,s,r,i="",o)=>{var a;let c,h=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob&&"undefined"!=typeof URL?(c=URL.createObjectURL(new Blob([e],{type:i})),h=!0):c=`data:${i};base64,`+(0,l.Gh)(e):e instanceof Blob?(c=URL.createObjectURL(e),h=!0):(c=C(e),c=v.PreprocessUrl(e));const d=u.l.LastCreatedEngine,g=t=>{if(s){const r=c||e.toString();s(`Error while trying to load image: ${0===r.indexOf("http")||r.length<=128?r:r.slice(0,128)+"..."}`,t)}};if("undefined"==typeof Image||null!==(a=null==d?void 0:d._features.forceBitmapOverHTMLImageElement)&&void 0!==a&&a)return y(c,(r=>{d.createImageBitmap(new Blob([r],{type:i}),{premultiplyAlpha:"none",...o}).then((e=>{t(e),h&&URL.revokeObjectURL(c)})).catch((t=>{s&&s("Error while trying to load image: "+e,t)}))}),void 0,r||void 0,!0,((e,t)=>{g(t)})),null;const f=new Image;T(c,f);const p=[],m=()=>{p.forEach((e=>{e.target.removeEventListener(e.name,e.handler)})),p.length=0};p.push({target:f,name:"load",handler:()=>{m(),t(f),h&&f.src&&URL.revokeObjectURL(f.src)}}),p.push({target:f,name:"error",handler:e=>{m(),g(e),h&&f.src&&URL.revokeObjectURL(f.src)}}),p.push({target:document,name:"securitypolicyviolation",handler:e=>{m();const t=new Error(`CSP violation of policy ${e.effectiveDirective} ${e.blockedURI}. Current policy is ${e.originalPolicy}`);u.l.UseFallbackTexture=!1,g(t),h&&f.src&&URL.revokeObjectURL(f.src),f.src=""}}),p.forEach((e=>{e.target.addEventListener(e.name,e.handler)}));const _="blob:"===c.substring(0,5),A="data:"===c.substring(0,5),w=()=>{_||A?f.src=c:y(c,((e,t,s)=>{const r=new Blob([e],{type:!i&&s?s:i}),o=URL.createObjectURL(r);h=!0,f.src=o}),void 0,r||void 0,!0,((e,t)=>{g(t)}))},b=()=>{r&&r.loadImage(c,f)};if(!_&&!A&&r&&r.enableTexturesOffline)r.open(b,w);else{if(-1!==c.indexOf("file:")){const e=decodeURIComponent(c.substring(5).toLowerCase());if(n.X.FilesToLoad[e]&&"undefined"!=typeof URL){try{let t;try{t=URL.createObjectURL(n.X.FilesToLoad[e])}catch(s){t=URL.createObjectURL(n.X.FilesToLoad[e])}f.src=t,h=!0}catch(e){f.src=""}return f}}w()}return f},b=(e,t,s,r,i)=>{const n=new FileReader,a={onCompleteObservable:new o.y$,abort:()=>n.abort()};return n.onloadend=()=>a.onCompleteObservable.notifyObservers(a),i&&(n.onerror=()=>{i(new A(`Unable to read ${e.name}`,e))}),n.onload=e=>{t(e.target.result)},s&&(n.onprogress=s),r?n.readAsArrayBuffer(e):n.readAsText(e),a},y=(e,t,s,r,i,a,c)=>{if(e.name)return b(e,t,s,i,a?e=>{a(void 0,e)}:void 0);const l=e;if(-1!==l.indexOf("file:")){let e=decodeURIComponent(l.substring(5).toLowerCase());0===e.indexOf("./")&&(e=e.substring(2));const r=n.X.FilesToLoad[e];if(r)return b(r,t,s,i,a?e=>a(void 0,new m(e.message,e.file)):void 0)}const{match:h,type:d}=B(l);if(h){const e={onCompleteObservable:new o.y$,abort:()=>()=>{}};try{const e=i?R(l):S(l);t(e,void 0,d)}catch(e){a?a(void 0,e):g.Y.Error(e.message||"Failed to parse the Data URL")}return f.Q.SetImmediate((()=>{e.onCompleteObservable.notifyObservers(e)})),e}return P(l,((e,s)=>{t(e,null==s?void 0:s.responseURL,null==s?void 0:s.getResponseHeader("content-type"))}),s,r,i,a?e=>{a(e.request,new m(e.message,e.request))}:void 0,c)},P=(e,t,s,n,a,c,l)=>{e=C(e),e=v.PreprocessUrl(e);const h=v.BaseUrl+e;let d=!1;const u={onCompleteObservable:new o.y$,abort:()=>d=!0},f=()=>{let e,o=new r.g,n=null;const f=()=>{o&&(s&&o.removeEventListener("progress",s),e&&o.removeEventListener("readystatechange",e),o.removeEventListener("loadend",p))};let p=()=>{f(),u.onCompleteObservable.notifyObservers(u),u.onCompleteObservable.clear(),s=void 0,e=null,p=null,c=void 0,l=void 0,t=void 0};u.abort=()=>{d=!0,p&&p(),o&&o.readyState!==(XMLHttpRequest.DONE||4)&&o.abort(),null!==n&&(clearTimeout(n),n=null),o=null};const m=e=>{const t=e.message||"Unknown error";c&&o?c(new _(t,o)):g.Y.Error(t)},A=u=>{if(o){if(o.open("GET",h),l)try{l(o)}catch(e){return void m(e)}a&&(o.responseType="arraybuffer"),s&&o.addEventListener("progress",s),p&&o.addEventListener("loadend",p),e=()=>{if(!d&&o&&o.readyState===(XMLHttpRequest.DONE||4)){if(e&&o.removeEventListener("readystatechange",e),o.status>=200&&o.status<300||0===o.status&&(!(0,i.CG)()||x())){try{t&&t(a?o.response:o.responseText,o)}catch(e){m(e)}return}const s=v.DefaultRetryStrategy;if(s){const e=s(h,o,u);if(-1!==e)return f(),o=new r.g,void(n=setTimeout((()=>A(u+1)),e))}const l=new _("Error status: "+o.status+" "+o.statusText+" - Unable to load "+h,o);c&&c(l)}},o.addEventListener("readystatechange",e),o.send()}};A(0)};if(n&&n.enableSceneOffline){const r=e=>{e&&e.status>400?c&&c(e):f()},i=()=>{n&&n.loadFile(v.BaseUrl+e,(e=>{!d&&t&&t(e),u.onCompleteObservable.notifyObservers(u)}),s?e=>{!d&&s&&s(e)}:void 0,r,a)};n.open(i,r)}else f();return u},x=()=>"undefined"!=typeof location&&"file:"===location.protocol,E=e=>p.test(e),B=e=>{const t=p.exec(e);if(null===t||0===t.length)return{match:!1,type:""};return{match:!0,type:t[0].replace("data:","").replace("base64,","")}};function R(e){return(0,l.HQ)(e.split(",")[1])}const S=e=>(0,l.rP)(e.split(",")[1]);let D;d.B._FileToolsLoadImage=w,d.B._FileToolsLoadFile=y,h.L._FileToolsLoadFile=y;((e,t,s,r,i,o,n,a,c,l)=>{D={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:t,DefaultRetryStrategy:s.DefaultRetryStrategy,BaseUrl:s.BaseUrl,CorsBehavior:s.CorsBehavior,PreprocessUrl:s.PreprocessUrl,IsBase64DataUrl:r,IsFileURL:i,LoadFile:o,LoadImage:n,ReadFile:a,RequestFile:c,SetCorsBehavior:l},Object.defineProperty(D,"DefaultRetryStrategy",{get:function(){return s.DefaultRetryStrategy},set:function(e){s.DefaultRetryStrategy=e}}),Object.defineProperty(D,"BaseUrl",{get:function(){return s.BaseUrl},set:function(e){s.BaseUrl=e}}),Object.defineProperty(D,"PreprocessUrl",{get:function(){return s.PreprocessUrl},set:function(e){s.PreprocessUrl=e}}),Object.defineProperty(D,"CorsBehavior",{get:function(){return s.CorsBehavior},set:function(e){s.CorsBehavior=e}})})(R,S,v,E,x,y,w,b,P,T)},92839:(e,t,s)=>{s.d(t,{P:()=>n});var r=s(63407),i=s(84318),o=s(64436);class n{static get FilesToLoad(){return o.X.FilesToLoad}constructor(e,t,s,i,o,n,a,c,l){this.onProcessFileCallback=()=>!0,this.loadAsync=(e,t)=>r.n.LoadAsync("file:",e,this._engine,t),this._engine=e,this._currentScene=t,this._sceneLoadedCallback=s,this._progressCallback=i,this._additionalRenderLoopLogicCallback=o,this._textureLoadingCallback=n,this._startingProcessingFilesCallback=a,this._onReloadCallback=c,this._errorCallback=l}monitorElementForDragNDrop(e){e&&(this._elementToMonitor=e,this._dragEnterHandler=e=>{this._drag(e)},this._dragOverHandler=e=>{this._drag(e)},this._dropHandler=e=>{this._drop(e)},this._elementToMonitor.addEventListener("dragenter",this._dragEnterHandler,!1),this._elementToMonitor.addEventListener("dragover",this._dragOverHandler,!1),this._elementToMonitor.addEventListener("drop",this._dropHandler,!1))}get filesToLoad(){return this._filesToLoad}dispose(){this._elementToMonitor&&(this._elementToMonitor.removeEventListener("dragenter",this._dragEnterHandler),this._elementToMonitor.removeEventListener("dragover",this._dragOverHandler),this._elementToMonitor.removeEventListener("drop",this._dropHandler))}_renderFunction(){if(this._additionalRenderLoopLogicCallback&&this._additionalRenderLoopLogicCallback(),this._currentScene){if(this._textureLoadingCallback){const e=this._currentScene.getWaitingItemsCount();e>0&&this._textureLoadingCallback(e)}this._currentScene.render()}}_drag(e){e.stopPropagation(),e.preventDefault()}_drop(e){e.stopPropagation(),e.preventDefault(),this.loadFiles(e)}_traverseFolder(e,t,s,r){const i=e.createReader(),o=e.fullPath.replace(/^\//,"").replace(/(.+?)\/?$/,"$1/");i.readEntries((e=>{s.count+=e.length;for(const i of e)i.isFile?i.file((e=>{e.correctName=o+e.name,t.push(e),0==--s.count&&r()})):i.isDirectory&&this._traverseFolder(i,t,s,r);0==--s.count&&r()}))}_processFiles(e){for(let t=0;t<e.length;t++){const s=e[t].correctName.toLowerCase(),i=s.split(".").pop();this.onProcessFileCallback(e[t],s,i,(e=>this._sceneFileToLoad=e))&&(r.n.IsPluginForExtensionAvailable("."+i)&&(this._sceneFileToLoad=e[t]),n.FilesToLoad[s]=e[t])}}loadFiles(e){if(e&&e.dataTransfer&&e.dataTransfer.files&&(this._filesToLoad=e.dataTransfer.files),e&&e.target&&e.target.files&&(this._filesToLoad=e.target.files),this._filesToLoad&&0!==this._filesToLoad.length&&(this._startingProcessingFilesCallback&&this._startingProcessingFilesCallback(this._filesToLoad),this._filesToLoad&&this._filesToLoad.length>0)){const t=new Array,s=[],r=e.dataTransfer?e.dataTransfer.items:null;for(let e=0;e<this._filesToLoad.length;e++){const i=this._filesToLoad[e],o=i.name.toLowerCase();let n;if(i.correctName=o,r){const t=r[e];t.getAsEntry?n=t.getAsEntry():t.webkitGetAsEntry&&(n=t.webkitGetAsEntry())}n&&n.isDirectory?s.push(n):t.push(i)}if(0===s.length)this._processFiles(t),this._processReload();else{const e={count:s.length};for(const r of s)this._traverseFolder(r,t,e,(()=>{this._processFiles(t),0===e.count&&this._processReload()}))}}}_processReload(){this._onReloadCallback?this._onReloadCallback(this._sceneFileToLoad):this.reload()}reload(){this._sceneFileToLoad?(this._currentScene&&(i.Y.errorsCount>0&&i.Y.ClearLogCache(),this._engine.stopRenderLoop()),r.n.ShowLoadingScreen=!1,this._engine.displayLoadingUI(),this.loadAsync(this._sceneFileToLoad,this._progressCallback).then((e=>{this._currentScene&&this._currentScene.dispose(),this._currentScene=e,this._sceneLoadedCallback&&this._sceneLoadedCallback(this._sceneFileToLoad,this._currentScene),this._currentScene.executeWhenReady((()=>{this._engine.hideLoadingUI(),this._engine.runRenderLoop((()=>{this._renderFunction()}))}))})).catch((e=>{this._engine.hideLoadingUI(),this._errorCallback&&this._errorCallback(this._sceneFileToLoad,this._currentScene,e.message)}))):i.Y.Error("Please provide a valid .babylon file.")}}},64436:(e,t,s)=>{s.d(t,{X:()=>r});class r{}r.FilesToLoad={}},4359:(e,t,s)=>{s.d(t,{b3:()=>n,bK:()=>i,cw:()=>o,fR:()=>a});var r=s(15631);class i{constructor(e,t,s){this.gradient=e,this.color1=t,this.color2=s}getColorToRef(e){this.color2?r.HE.LerpToRef(this.color1,this.color2,Math.random(),e):e.copyFrom(this.color1)}}class o{constructor(e,t){this.gradient=e,this.color=t}}class n{constructor(e,t,s){this.gradient=e,this.factor1=t,this.factor2=s}getFactor(){return void 0===this.factor2||this.factor2===this.factor1?this.factor1:this.factor1+(this.factor2-this.factor1)*Math.random()}}class a{static GetCurrentGradient(e,t,s){if(t[0].gradient>e)return void s(t[0],t[0],1);for(let r=0;r<t.length-1;r++){const i=t[r],o=t[r+1];if(e>=i.gradient&&e<=o.gradient){return void s(i,o,(e-i.gradient)/(o.gradient-i.gradient))}}const r=t.length-1;s(t[r],t[r],1)}}},54007:(e,t,s)=>{function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}s.d(t,{f:()=>r})},23626:(e,t,s)=>{s(26769),s(10440),s(21004),s(88910);var r=s(96969),i=(s(94138),s(71892),s(58095));s(92839),s(93354),s(13408),s(19414),s(88552);var o=s(62897);o.y$.prototype.notifyObserversWithPromise=async function(e,t=-1,s,r,i){let o=Promise.resolve(e);if(!this.observers.length)return o;const n=this._eventState;return n.mask=t,n.target=s,n.currentTarget=r,n.skipNextObservers=!1,n.userInfo=i,this.observers.forEach((s=>{n.skipNextObservers||s._willBeUnregistered||s.mask&t&&(o=s.scope?o.then((t=>(n.lastReturnValue=t,s.callback.apply(s.scope,[e,n])))):o.then((t=>(n.lastReturnValue=t,s.callback(e,n)))),s.unregisterOnNextCall&&this._deferUnregister(s))})),await o,e};s(31700),s(15210);var n=s(91243);class a{getDescription(){return""}apply(e,t){return!0}constructor(e=0){this.priority=e}}class c extends a{constructor(){super(...arguments),this._canBeMerged=e=>{if(!(e instanceof n.Kj))return!1;const t=e;return!t.isDisposed()&&(!(!t.isVisible||!t.isEnabled())&&(!(t.instances.length>0)&&(!t.skeleton&&!t.hasLODLevels)))}}static get UpdateSelectionTree(){return c._UpdateSelectionTree}static set UpdateSelectionTree(e){c._UpdateSelectionTree=e}getDescription(){return"Merging similar meshes together"}apply(e,t,s){const r=e.meshes.slice(0);let i=r.length;for(let e=0;e<i;e++){const t=new Array,s=r[e];if(this._canBeMerged(s)){t.push(s);for(let o=e+1;o<i;o++){const e=r[o];this._canBeMerged(e)&&(e.material===s.material&&e.checkCollisions===s.checkCollisions&&(t.push(e),i--,r.splice(o,1),o--))}t.length<2||n.Kj.MergeMeshes(t,void 0,!0)}}const o=e;return o.createOrUpdateSelectionOctree&&(null!=s?s&&o.createOrUpdateSelectionOctree():c.UpdateSelectionTree&&o.createOrUpdateSelectionOctree()),!0}}c._UpdateSelectionTree=!1;var l=s(91855),h=s(73803);let d=[];const u=(e,t)=>{e.doNotSerialize||(t.vertexData.push(e.serializeVerticeData()),d[e.id]=!0)},g=(e,t)=>{const s={},r=e._geometry;return r&&(e.getScene().getGeometryById(r.id)||u(r,t.geometries)),e.serialize&&e.serialize(s),s};class f{static ClearCache(){d=[]}static Serialize(e){return f._Serialize(e)}static _Serialize(e,t=!0){const s={};if(t&&!e.getEngine()._features.supportSyncTextureRead&&h.x.ForceSerializeBuffers&&console.warn("The serialization object may not contain the proper base64 encoded texture data! You should use the SerializeAsync method instead."),f.ClearCache(),s.useDelayedTextureLoading=e.useDelayedTextureLoading,s.autoClear=e.autoClear,s.clearColor=e.clearColor.asArray(),s.ambientColor=e.ambientColor.asArray(),s.gravity=e.gravity.asArray(),s.collisionsEnabled=e.collisionsEnabled,s.useRightHandedSystem=e.useRightHandedSystem,e.fogMode&&0!==e.fogMode&&(s.fogMode=e.fogMode,s.fogColor=e.fogColor.asArray(),s.fogStart=e.fogStart,s.fogEnd=e.fogEnd,s.fogDensity=e.fogDensity),e.isPhysicsEnabled()){const t=e.getPhysicsEngine();t&&(s.physicsEnabled=!0,s.physicsGravity=t.gravity.asArray(),s.physicsEngine=t.getPhysicsPluginName())}e.metadata&&(s.metadata=e.metadata),s.morphTargetManagers=[];for(const t of e.meshes){const e=t.morphTargetManager;e&&s.morphTargetManagers.push(e.serialize())}let i,o,a;for(s.lights=[],i=0;i<e.lights.length;i++)o=e.lights[i],o.doNotSerialize||s.lights.push(o.serialize());for(s.cameras=[],i=0;i<e.cameras.length;i++){const t=e.cameras[i];t.doNotSerialize||s.cameras.push(t.serialize())}if(e.activeCamera&&(s.activeCameraID=e.activeCamera.id),r.p4.AppendSerializedAnimations(e,s),e.animationGroups&&e.animationGroups.length>0){s.animationGroups=[];for(let t=0;t<e.animationGroups.length;t++){const r=e.animationGroups[t];s.animationGroups.push(r.serialize())}}if(e.reflectionProbes&&e.reflectionProbes.length>0)for(s.reflectionProbes=[],i=0;i<e.reflectionProbes.length;i++){const t=e.reflectionProbes[i];s.reflectionProbes.push(t.serialize())}for(s.materials=[],s.multiMaterials=[],i=0;i<e.materials.length;i++)a=e.materials[i],a.doNotSerialize||s.materials.push(a.serialize());for(s.multiMaterials=[],i=0;i<e.multiMaterials.length;i++){const t=e.multiMaterials[i];s.multiMaterials.push(t.serialize())}for(e.environmentTexture&&(e.environmentTexture._files?s.environmentTexture=e.environmentTexture.serialize():(s.environmentTexture=e.environmentTexture.name,s.environmentTextureRotationY=e.environmentTexture.rotationY)),s.environmentIntensity=e.environmentIntensity,s.skeletons=[],i=0;i<e.skeletons.length;i++){const t=e.skeletons[i];t.doNotSerialize||s.skeletons.push(t.serialize())}for(s.transformNodes=[],i=0;i<e.transformNodes.length;i++)e.transformNodes[i].doNotSerialize||s.transformNodes.push(e.transformNodes[i].serialize());s.geometries={},s.geometries.boxes=[],s.geometries.spheres=[],s.geometries.cylinders=[],s.geometries.toruses=[],s.geometries.grounds=[],s.geometries.planes=[],s.geometries.torusKnots=[],s.geometries.vertexData=[],d=[];const c=e.getGeometries();for(i=0;i<c.length;i++){const e=c[i];e.isReady()&&u(e,s.geometries)}for(s.meshes=[],i=0;i<e.meshes.length;i++){const t=e.meshes[i];if(t instanceof n.Kj){const e=t;e.doNotSerialize||1!==e.delayLoadState&&0!==e.delayLoadState||s.meshes.push(g(e,s))}}for(s.particleSystems=[],i=0;i<e.particleSystems.length;i++)s.particleSystems.push(e.particleSystems[i].serialize(!1));for(s.postProcesses=[],i=0;i<e.postProcesses.length;i++)s.postProcesses.push(e.postProcesses[i].serialize());e.actionManager&&(s.actions=e.actionManager.serialize("scene"));for(const t of e._serializableComponents)t.serialize(s);return s}static SerializeAsync(e){const t=f._Serialize(e,!1),s=[];return this._CollectPromises(t,s),Promise.all(s).then((()=>t))}static _CollectPromises(e,t){if(Array.isArray(e))for(let s=0;s<e.length;++s){const r=e[s];r instanceof Promise?t.push(r.then((t=>e[s]=t))):(r instanceof Object||Array.isArray(r))&&this._CollectPromises(r,t)}else if(e instanceof Object)for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];r instanceof Promise?t.push(r.then((t=>e[s]=t))):(r instanceof Object||Array.isArray(r))&&this._CollectPromises(r,t)}}static SerializeMesh(e,t=!1,s=!1){const r={};if(f.ClearCache(),e=e instanceof Array?e:[e],t||s)for(let r=0;r<e.length;++r)s&&e[r].getDescendants().forEach((t=>{t instanceof n.Kj&&e.indexOf(t)<0&&!t.doNotSerialize&&e.push(t)})),t&&e[r].parent&&e.indexOf(e[r].parent)<0&&!e[r].parent.doNotSerialize&&e.push(e[r].parent);return e.forEach((e=>{((e,t)=>{if(1===e.delayLoadState||0===e.delayLoadState){const s=s=>{t.materials=t.materials||[],e.material&&!t.materials.some((t=>t.id===e.material.id))&&t.materials.push(s.serialize())};if(e.material&&!e.material.doNotSerialize)if(e.material instanceof l.G){if(t.multiMaterials=t.multiMaterials||[],!t.multiMaterials.some((t=>t.id===e.material.id))){t.multiMaterials.push(e.material.serialize());for(const t of e.material.subMaterials)t&&s(t)}}else s(e.material);else e.material||s(e.getScene().defaultMaterial);const r=e._geometry;r&&(t.geometries||(t.geometries={},t.geometries.boxes=[],t.geometries.spheres=[],t.geometries.cylinders=[],t.geometries.toruses=[],t.geometries.grounds=[],t.geometries.planes=[],t.geometries.torusKnots=[],t.geometries.vertexData=[]),u(r,t.geometries)),e.skeleton&&!e.skeleton.doNotSerialize&&(t.skeletons=t.skeletons||[],t.skeletons.push(e.skeleton.serialize())),t.meshes=t.meshes||[],t.meshes.push(g(e,t))}})(e,r)})),r}}s(7788),s(45008),s(20163),s(80949),s(76755);var p=s(13514);class m{static IsSupported(e){const t=e.getRenderingCanvas();return!!t&&"function"==typeof t.captureStream}get isRecording(){return!!this._canvas&&this._canvas.isRecording}constructor(e,t={}){if(!m.IsSupported(e))throw"Your browser does not support recording so far.";const s=e.getRenderingCanvas();if(!s)throw"The babylon engine must have a canvas to be recorded";this._canvas=s,this._canvas.isRecording=!1,this._options={...m._DefaultOptions,...t};const r=this._canvas.captureStream(this._options.fps);if(this._options.audioTracks)for(const e of this._options.audioTracks)r.addTrack(e);this._mediaRecorder=new MediaRecorder(r,{mimeType:this._options.mimeType}),this._mediaRecorder.ondataavailable=this._handleDataAvailable.bind(this),this._mediaRecorder.onerror=this._handleError.bind(this),this._mediaRecorder.onstop=this._handleStop.bind(this)}stopRecording(){this._canvas&&this._mediaRecorder&&this.isRecording&&(this._canvas.isRecording=!1,this._mediaRecorder.stop())}startRecording(e="babylonjs.webm",t=7){if(!this._canvas||!this._mediaRecorder)throw"Recorder has already been disposed";if(this.isRecording)throw"Recording already in progress";return t>0&&setTimeout((()=>{this.stopRecording()}),1e3*t),this._fileName=e,this._recordedChunks=[],this._resolve=null,this._reject=null,this._canvas.isRecording=!0,this._mediaRecorder.start(this._options.recordChunckSize),new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}dispose(){this._canvas=null,this._mediaRecorder=null,this._recordedChunks=[],this._fileName=null,this._resolve=null,this._reject=null}_handleDataAvailable(e){e.data.size>0&&this._recordedChunks.push(e.data)}_handleError(e){if(this.stopRecording(),!this._reject)throw new e.error;this._reject(e.error)}_handleStop(){this.stopRecording();const e=new Blob(this._recordedChunks);this._resolve&&this._resolve(e),window.URL.createObjectURL(e),this._fileName&&p.w1.Download(e,this._fileName)}}m._DefaultOptions={mimeType:"video/webm",fps:25,recordChunckSize:3e3};s(59711),s(11758);var _,A=s(84318),v=(s(48620),s(64436),s(1101),s(11337),s(29945));s(77118),s(51912);!function(e){e[e.Checkbox=0]="Checkbox",e[e.Slider=1]="Slider",e[e.Vector3=2]="Vector3",e[e.Quaternion=3]="Quaternion",e[e.Color3=4]="Color3",e[e.String=5]="String",e[e.Button=6]="Button",e[e.Options=7]="Options",e[e.Tab=8]="Tab",e[e.FileButton=9]="FileButton",e[e.Vector2=10]="Vector2"}(_||(_={}));s(73556),s(95718),s(4359),s(82577),s(42874),s(79245),s(29972),s(21879),s(88114),s(39521);class C{static _GetStorage(){try{return localStorage.setItem("test",""),localStorage.removeItem("test"),localStorage}catch(e){const t={};return{getItem:e=>{const s=t[e];return void 0===s?null:s},setItem:(e,s)=>{t[e]=s}}}}static ReadString(e,t){const s=this._Storage.getItem(e);return null!==s?s:t}static WriteString(e,t){this._Storage.setItem(e,t)}static ReadBoolean(e,t){const s=this._Storage.getItem(e);return null!==s?"true"===s:t}static WriteBoolean(e,t){this._Storage.setItem(e,t?"true":"false")}static ReadNumber(e,t){const s=this._Storage.getItem(e);return null!==s?parseFloat(s):t}static WriteNumber(e,t){this._Storage.setItem(e,t.toString())}}C._Storage=C._GetStorage();s(43812),s(2055),s(52106),s(98163),s(30700),s(22672),s(27398),s(89982),s(16142);var T;s(53669);!function(e){class t{serialize(){const e={},t=new Array(this._characterToIdx.size);return this._characterToIdx.forEach(((e,s)=>{t[e]=s})),e.characters=t,e.insertionCosts=this._insertionCosts,e.deletionCosts=this._deletionCosts,e.substitutionCosts=this._substitutionCosts,JSON.stringify(e)}static Deserialize(e){const s=JSON.parse(e),r=new t(s.characters);return r._insertionCosts=s.insertionCosts,r._deletionCosts=s.deletionCosts,r._substitutionCosts=s.substitutionCosts,r}constructor(e,t=null,s=null,r=null){let i;t=null!=t?t:()=>1,s=null!=s?s:()=>1,r=null!=r?r:(e,t)=>e===t?0:1,this._characterToIdx=new Map,this._insertionCosts=new Array(e.length),this._deletionCosts=new Array(e.length),this._substitutionCosts=new Array(e.length);for(let o=0;o<e.length;++o){i=e[o],this._characterToIdx.set(i,o),this._insertionCosts[o]=t(i),this._deletionCosts[o]=s(i),this._substitutionCosts[o]=new Array(e.length);for(let t=o;t<e.length;++t)this._substitutionCosts[o][t]=r(i,e[t])}}getCharacterIdx(e){return this._characterToIdx.get(e)}getInsertionCost(e){return this._insertionCosts[e]}getDeletionCost(e){return this._deletionCosts[e]}getSubstitutionCost(e,t){const s=Math.min(e,t),r=Math.max(e,t);return this._substitutionCosts[s][r]}}e.Alphabet=t;class s{serialize(){return JSON.stringify(this._characters)}static Deserialize(e,t){const r=new s([],t);return r._characters=JSON.parse(e),r}constructor(e,t){if(e.length>s._MAX_SEQUENCE_LENGTH)throw new Error("Sequences longer than "+s._MAX_SEQUENCE_LENGTH+" not supported.");this._alphabet=t,this._characters=e.map((e=>this._alphabet.getCharacterIdx(e)))}distance(e){return s._Distance(this,e)}static _Distance(e,t){const r=e._alphabet;if(r!==t._alphabet)throw new Error("Cannot Levenshtein compare Sequences built from different alphabets.");const i=e._characters,o=t._characters,n=i.length,a=o.length,c=s._CostMatrix;c[0][0]=0;for(let e=0;e<n;++e)c[e+1][0]=c[e][0]+r.getInsertionCost(i[e]);for(let e=0;e<a;++e)c[0][e+1]=c[0][e]+r.getInsertionCost(o[e]);for(let e=0;e<n;++e)for(let t=0;t<a;++t)s._InsertionCost=c[e+1][t]+r.getInsertionCost(o[t]),s._DeletionCost=c[e][t+1]+r.getDeletionCost(i[e]),s._SubstitutionCost=c[e][t]+r.getSubstitutionCost(i[e],o[t]),c[e+1][t+1]=Math.min(s._InsertionCost,s._DeletionCost,s._SubstitutionCost);return c[n][a]}}s._MAX_SEQUENCE_LENGTH=256,s._CostMatrix=[...Array(s._MAX_SEQUENCE_LENGTH+1)].map((()=>new Array(s._MAX_SEQUENCE_LENGTH+1))),e.Sequence=s}(T||(T={}));class w{serialize(){return JSON.stringify(this)}static Deserialize(e){const t=JSON.parse(e),s=new w(t._segmentLength);return s._points=t._points.map((e=>new i.P(e._x,e._y,e._z))),s}constructor(e=.01){this._points=[],this._segmentLength=e}getLength(){return this._points.length*this._segmentLength}add(e){let t=this._points.length;if(0===t)this._points.push(e.clone());else{const s=()=>this._segmentLength/i.P.Distance(this._points[t-1],e);for(let r=s();r<=1;r=s()){const s=this._points[t-1].scale(1-r);e.scaleAndAddToRef(r,s),this._points.push(s),++t}}}resampleAtTargetResolution(e){const t=new w(this.getLength()/e);return this._points.forEach((e=>{t.add(e)})),t}tokenize(e){const t=[],s=new i.P;for(let r=2;r<this._points.length;++r)w._TransformSegmentDirToRef(this._points[r-2],this._points[r-1],this._points[r],s)&&t.push(w._TokenizeSegment(s,e));return t}static _TransformSegmentDirToRef(e,t,s,r){return t.subtractToRef(e,w._ForwardDir),w._ForwardDir.normalize(),t.scaleToRef(-1,w._InverseFromVec),w._InverseFromVec.normalize(),!(Math.abs(i.P.Dot(w._ForwardDir,w._InverseFromVec))>.98)&&(i.P.CrossToRef(w._ForwardDir,w._InverseFromVec,w._UpDir),w._UpDir.normalize(),i.y3.LookAtLHToRef(e,t,w._UpDir,w._LookMatrix),s.subtractToRef(t,w._FromToVec),w._FromToVec.normalize(),i.P.TransformNormalToRef(w._FromToVec,w._LookMatrix,r),!0)}static _TokenizeSegment(e,t){w._BestMatch=0,w._Score=i.P.Dot(e,t[0]),w._BestScore=w._Score;for(let s=1;s<t.length;++s)w._Score=i.P.Dot(e,t[s]),w._Score>w._BestScore&&(w._BestMatch=s,w._BestScore=w._Score);return w._BestMatch}}w._ForwardDir=new i.P,w._InverseFromVec=new i.P,w._UpDir=new i.P,w._FromToVec=new i.P,w._LookMatrix=new i.y3;class b{serialize(){return JSON.stringify(this._sequences.map((e=>e.serialize())))}static Deserialize(e,t){const s=new b;return s._sequences=JSON.parse(e).map((e=>T.Sequence.Deserialize(e,t))),s}static CreateFromTrajectory(e,t,s){return b.CreateFromTokenizationPyramid(b._GetTokenizationPyramid(e,t),s)}static CreateFromTokenizationPyramid(e,t){const s=new b;return s._sequences=e.map((e=>new T.Sequence(e,t))),s}constructor(){this._sequences=[]}static _GetTokenizationPyramid(e,t,s=b._FINEST_DESCRIPTOR_RESOLUTION){const r=[];for(let i=s;i>4;i=Math.floor(i/2))r.push(e.resampleAtTargetResolution(i).tokenize(t.chars));return r}distance(e){let t,s=0;for(let r=0;r<this._sequences.length;++r)t=Math.pow(2,r),s+=t*this._sequences[r].distance(e._sequences[r]);return s}}b._FINEST_DESCRIPTOR_RESOLUTION=32;class y{serialize(){const e={};return e.descriptors=this._descriptors.map((e=>e.serialize())),e.centroidIdx=this._centroidIdx,e.averageDistance=this._averageDistance,JSON.stringify(e)}static Deserialize(e,t){const s=JSON.parse(e),r=new y;return r._descriptors=s.descriptors.map((e=>b.Deserialize(e,t))),r._centroidIdx=s.centroidIdx,r._averageDistance=s.averageDistance,r}constructor(e=[]){this._descriptors=e,this._centroidIdx=-1,this._averageDistance=0,this._refreshDescription()}add(e){this._descriptors.push(e),this._refreshDescription()}getMatchCost(e){return e.distance(this._descriptors[this._centroidIdx])/this._averageDistance}getMatchMinimumDistance(e){return Math.min(...this._descriptors.map((t=>t.distance(e))))}_refreshDescription(){let e;this._centroidIdx=-1;const t=this._descriptors.map((t=>(e=0,this._descriptors.forEach((s=>{e+=t.distance(s)})),e)));for(let e=0;e<t.length;++e)(this._centroidIdx<0||t[e]<t[this._centroidIdx])&&(this._centroidIdx=e);this._averageDistance=0,this._descriptors.forEach((e=>{this._averageDistance+=e.distance(this._descriptors[this._centroidIdx])})),this._descriptors.length>0&&(this._averageDistance=Math.max(this._averageDistance/this._descriptors.length,y._MIN_AVERAGE_DISTANCE))}}y._MIN_AVERAGE_DISTANCE=1;s(16433),s(50679);class P{constructor(e,t,s){this._scene=e,A.Y.Log(`[Reflector] Connecting to ws://${t}:${s}`),this._webSocket=new WebSocket(`ws://${t}:${s}`),this._webSocket.onmessage=e=>{const t=e.data;if(t.startsWith(P._SERVER_PREFIX)){const e=t.substr(P._SERVER_PREFIX.length);return A.Y.Log(`[Reflector] Received server message: ${e.substr(0,64)}`),void this._handleServerMessage(e)}A.Y.Log(`[Reflector] Received client message: ${t.substr(0,64)}`),this._handleClientMessage()},this._webSocket.onclose=e=>{A.Y.Log(`[Reflector] Disconnected ${e.code} ${e.reason}`)}}close(){this._webSocket.close()}_handleServerMessage(e){if("connected"===e)f.SerializeAsync(this._scene).then((e=>{this._webSocket.send(`load|${JSON.stringify(e)}`)}))}_handleClientMessage(){}}P._SERVER_PREFIX="$$";s(80352);class x{constructor(e){this._view=new Float32Array(e),this._itemLength=0}get itemLength(){return this._itemLength}at(e){return e<0||e>=this._itemLength?NaN:this._view[e]}subarray(e,t){return e>=t||e<0?new Float32Array(0):(t>this._itemLength&&(t=this._itemLength),this._view.subarray(e,t))}push(e){this._view[this._itemLength]=e,this._itemLength++,this._itemLength>=this._view.length&&this._growArray()}_growArray(){const e=Math.floor(1.5*this._view.length),t=new Float32Array(e);t.set(this._view),this._view=t}}const E=1800,B="timestamp",R="numPoints",S=/\r/g;class D{static get SliceDataOffset(){return 2}static get NumberOfPointsOffset(){return 1}constructor(e,t){this._scene=e,this._collectDataAtFrame=()=>{const e=v.F.Now-this._startingTimestamp,t=this.datasets.ids.length,s=this.datasets.startingIndices.itemLength;let r=0;if(s>0){const e=this.datasets.startingIndices.at(s-1);r=e+this.datasets.data.at(e+D.NumberOfPointsOffset)+D.SliceDataOffset}if(this.datasets.startingIndices.push(r),this.datasets.data.push(e),this.datasets.data.push(t),this.datasets.ids.forEach((e=>{const t=this._strategies.get(e);t&&this.datasets.data.push(t.getData())})),this.datasetObservable.hasObservers()){const s=[e,t];for(let e=0;e<t;e++)s.push(this.datasets.data.at(r+D.SliceDataOffset+e));this.datasetObservable.notifyObservers(s)}},this.datasets={ids:[],data:new x(E),startingIndices:new x(E)},this._strategies=new Map,this._datasetMeta=new Map,this._eventRestoreSet=new Set,this._customEventObservable=new o.y$,this.datasetObservable=new o.y$,this.metadataObservable=new o.y$((e=>e.callback(this._datasetMeta,new o.he(0)))),t&&this.addCollectionStrategies(...t)}registerEvent(e,t,s){var r;if(this._strategies.has(e)&&!t)return;this._strategies.has(e)&&t&&(null===(r=this._strategies.get(e))||void 0===r||r.dispose(),this._strategies.delete(e));const i={name:e};return this._eventRestoreSet.add(e),this.addCollectionStrategies({strategyCallback:t=>{let s=0,r=0;const i=t.onAfterRenderObservable.add((()=>{r=s,s=0})),o=this._customEventObservable.add((t=>{e===t.name&&(void 0!==t.value?s=t.value:s++)}));return{id:e,getData:()=>r,dispose:()=>{t.onAfterRenderObservable.remove(i),this._customEventObservable.remove(o)}}},category:s}),i}sendEvent(e){this._customEventObservable.notifyObservers(e)}_restoreStringEvents(){this._eventRestoreSet.size!==this._customEventObservable.observers.length&&this._eventRestoreSet.forEach((e=>{this.registerEvent(e,!0)}))}addCollectionStrategies(...e){for(let{strategyCallback:t,category:s,hidden:r}of e){const e=t(this._scene);this._strategies.has(e.id)?e.dispose():(this.datasets.ids.push(e.id),s&&(s=s.replace(new RegExp("@","g"),"")),this._datasetMeta.set(e.id,{color:this._getHexColorFromId(e.id),category:s,hidden:r}),this._strategies.set(e.id,e))}this.metadataObservable.notifyObservers(this._datasetMeta)}_getHexColorFromId(e){let t=0;for(let s=0;s<e.length;s++)t=e.charCodeAt(s)+((t<<5)-t);let s="#";for(let e=0;e<24;e+=8){s+=("0"+(t>>e&255).toString(16)).substr(-2)}return s}getCurrentSlice(){const e=[v.F.Now-this._startingTimestamp,this.datasets.ids.length];this.datasets.ids.forEach((t=>{const s=this._strategies.get(t);s&&this.datasetObservable.hasObservers()&&e.push(s.getData())})),this.datasetObservable.hasObservers()&&this.datasetObservable.notifyObservers(e)}updateMetadata(e,t,s){const r=this._datasetMeta.get(e);r&&(r[t]=s,this.metadataObservable.notifyObservers(this._datasetMeta))}clear(e){this.datasets.data=new x(E),this.datasets.ids.length=0,this.datasets.startingIndices=new x(E),this._datasetMeta.clear(),this._strategies.forEach((e=>e.dispose())),this._strategies.clear(),e||this._eventRestoreSet.clear(),this._hasLoadedData=!1}get hasLoadedData(){return this._hasLoadedData}loadFromFileData(e,t){const s=e.replace(S,"").split("\n").map((e=>e.split(",").filter((e=>e.length>0)))).filter((e=>e.length>0)),r=D.NumberOfPointsOffset;if(s.length<2)return!1;const i={ids:[],data:new x(E),startingIndices:new x(E)},[o,...n]=s;if(o.length<2||o[0]!==B||o[r]!==R)return!1;const a=new Map;for(let e=D.SliceDataOffset;e<o.length;e++){const[t,s]=o[e].split("@");i.ids.push(t),a.set(t,s)}let c=0;for(const e of n){if(e.length<2)return!1;const t=parseFloat(e[0]),s=parseInt(e[r]);if(isNaN(s)||isNaN(t))return!1;if(i.data.push(t),i.data.push(s),s+D.SliceDataOffset!==e.length)return!1;for(let t=D.SliceDataOffset;t<e.length;t++){const s=parseFloat(e[t]);if(isNaN(s))return!1;i.data.push(s)}i.startingIndices.push(c),c+=e.length}if(this.datasets.ids=i.ids,this.datasets.data=i.data,this.datasets.startingIndices=i.startingIndices,t||this._datasetMeta.clear(),this._strategies.forEach((e=>e.dispose())),this._strategies.clear(),!t)for(const e of this.datasets.ids){const t=a.get(e);this._datasetMeta.set(e,{category:t,color:this._getHexColorFromId(e)})}return this.metadataObservable.notifyObservers(this._datasetMeta),this._hasLoadedData=!0,!0}exportDataToCsv(){let e="";e+="timestamp,numPoints";for(let t=0;t<this.datasets.ids.length;t++)if(e+=`,${this.datasets.ids[t]}`,this._datasetMeta){const s=this._datasetMeta.get(this.datasets.ids[t]);(null==s?void 0:s.category)&&(e+=`@${s.category}`)}e+="\n";for(let t=0;t<this.datasets.startingIndices.itemLength;t++){const s=this.datasets.startingIndices.at(t),r=this.datasets.data.at(s),i=this.datasets.data.at(s+D.NumberOfPointsOffset);e+=`${r},${i}`;for(let t=0;t<i;t++)e+=`,${this.datasets.data.at(s+D.SliceDataOffset+t)}`;for(let t=0;t<this.datasets.ids.length-i;t++)e+=",";e+="\n"}const t=`${(new Date).toISOString()}-perfdata.csv`;p.w1.Download(new Blob([e],{type:"text/csv"}),t)}start(e){e?void 0===this._startingTimestamp&&(this._startingTimestamp=v.F.Now):(this.datasets.data=new x(E),this.datasets.startingIndices=new x(E),this._startingTimestamp=v.F.Now),this._scene.onAfterRenderObservable.add(this._collectDataAtFrame),this._restoreStringEvents(),this._isStarted=!0}stop(){this._scene.onAfterRenderObservable.removeCallback(this._collectDataAtFrame),this._isStarted=!1}get isStarted(){return this._isStarted}dispose(){this._scene.onAfterRenderObservable.removeCallback(this._collectDataAtFrame),this._datasetMeta.clear(),this._strategies.forEach((e=>{e.dispose()})),this.datasetObservable.clear(),this.metadataObservable.clear(),this._isStarted=!1,this.datasets=null}}s(97164),s(93525);s(65273).x.prototype.getPerfCollector=function(){return this._perfCollector||(this._perfCollector=new D(this)),this._perfCollector};var F=s(24539);s(54007),s(46223);o.y$.prototype.runCoroutineAsync=function(e){if(!this._coroutineScheduler){const e=function(e){const t=new Array,s=new Array,r=new Array,i=e.add((()=>{const e=t.length;for(let i=0;i<e;i++)(0,F.WP)(t.shift(),s.shift(),r.shift())}));return{scheduler:(e,i,o)=>{t.push(e),s.push(i),r.push(o)},dispose:()=>{e.remove(i)}}}(this);this._coroutineScheduler=e.scheduler,this._coroutineSchedulerDispose=e.dispose}return(0,F.sM)(e,this._coroutineScheduler)},o.y$.prototype.cancelAllCoroutines=function(){this._coroutineSchedulerDispose&&this._coroutineSchedulerDispose(),this._coroutineScheduler=void 0,this._coroutineSchedulerDispose=void 0};s(97046),s(74802)},35890:(e,t,s)=>{s.d(t,{K:()=>o});var r=s(84318),i=s(48620);class o{static Instantiate(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];const t=(0,i.q)(e);if(t)return t;r.Y.Warn(e+" not found, you may have missed an import.");const s=e.split(".");let o=window||this;for(let e=0,t=s.length;e<t;e++)o=o[s[e]];return"function"!=typeof o?null:o}}o.RegisteredExternalClasses={}},88552:(e,t,s)=>{s.d(t,{k:()=>i});var r=s(84318);class i{constructor(e,t){if(this.data=e,this.isInvalid=!1,!i.IsValid(e))return this.isInvalid=!0,void r.Y.Error("texture missing KTX identifier");const s=Uint32Array.BYTES_PER_ELEMENT,o=new DataView(this.data.buffer,this.data.byteOffset+12,13*s),n=67305985===o.getUint32(0,!0);this.glType=o.getUint32(1*s,n),this.glTypeSize=o.getUint32(2*s,n),this.glFormat=o.getUint32(3*s,n),this.glInternalFormat=o.getUint32(4*s,n),this.glBaseInternalFormat=o.getUint32(5*s,n),this.pixelWidth=o.getUint32(6*s,n),this.pixelHeight=o.getUint32(7*s,n),this.pixelDepth=o.getUint32(8*s,n),this.numberOfArrayElements=o.getUint32(9*s,n),this.numberOfFaces=o.getUint32(10*s,n),this.numberOfMipmapLevels=o.getUint32(11*s,n),this.bytesOfKeyValueData=o.getUint32(12*s,n),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===t?this.loadType=i.COMPRESSED_2D:r.Y.Error("number of faces expected"+t+", but found "+this.numberOfFaces):r.Y.Error("texture arrays not currently supported"):r.Y.Error("only 2D textures currently supported")):r.Y.Error("only compressed formats currently supported")}uploadLevels(e,t){switch(this.loadType){case i.COMPRESSED_2D:this._upload2DCompressedLevels(e,t);case i.TEX_2D:case i.COMPRESSED_3D:case i.TEX_3D:}}_upload2DCompressedLevels(e,t){let s=i.HEADER_LEN+this.bytesOfKeyValueData,r=this.pixelWidth,o=this.pixelHeight;const n=t?this.numberOfMipmapLevels:1;for(let t=0;t<n;t++){const i=new Int32Array(this.data.buffer,this.data.byteOffset+s,1)[0];s+=4;for(let n=0;n<this.numberOfFaces;n++){const a=new Uint8Array(this.data.buffer,this.data.byteOffset+s,i);e.getEngine()._uploadCompressedDataToTextureDirectly(e,e.format,r,o,a,n,t),s+=i,s+=3-(i+3)%4}r=Math.max(1,.5*r),o=Math.max(1,.5*o)}}static IsValid(e){if(e.byteLength>=12){const t=new Uint8Array(e.buffer,e.byteOffset,12);if(171===t[0]&&75===t[1]&&84===t[2]&&88===t[3]&&32===t[4]&&49===t[5]&&49===t[6]&&187===t[7]&&13===t[8]&&10===t[9]&&26===t[10]&&10===t[11])return!0}return!1}}i.HEADER_LEN=64,i.COMPRESSED_2D=0,i.COMPRESSED_3D=1,i.TEX_2D=2,i.TEX_3D=3},53669:(e,t,s)=>{s.d(t,{Z:()=>c});var r=s(11758),i=s(13514),o=s(26080);function n(e){return e?i.w1.GetAbsoluteUrl(e):null}function a(e){null!==e.wasmUASTCToASTC&&(KTX2DECODER.LiteTranscoder_UASTC_ASTC.WasmModuleURL=e.wasmUASTCToASTC),null!==e.wasmUASTCToBC7&&(KTX2DECODER.LiteTranscoder_UASTC_BC7.WasmModuleURL=e.wasmUASTCToBC7),null!==e.wasmUASTCToRGBA_UNORM&&(KTX2DECODER.LiteTranscoder_UASTC_RGBA_UNORM.WasmModuleURL=e.wasmUASTCToRGBA_UNORM),null!==e.wasmUASTCToRGBA_SRGB&&(KTX2DECODER.LiteTranscoder_UASTC_RGBA_SRGB.WasmModuleURL=e.wasmUASTCToRGBA_SRGB),null!==e.wasmUASTCToR8_UNORM&&(KTX2DECODER.LiteTranscoder_UASTC_R8_UNORM.WasmModuleURL=e.wasmUASTCToR8_UNORM),null!==e.wasmUASTCToRG8_UNORM&&(KTX2DECODER.LiteTranscoder_UASTC_RG8_UNORM.WasmModuleURL=e.wasmUASTCToRG8_UNORM),null!==e.jsMSCTranscoder&&(KTX2DECODER.MSCTranscoder.JSModuleURL=e.jsMSCTranscoder),null!==e.wasmMSCTranscoder&&(KTX2DECODER.MSCTranscoder.WasmModuleURL=e.wasmMSCTranscoder),null!==e.wasmZSTDDecoder&&(KTX2DECODER.ZSTDDecoder.WasmModuleURL=e.wasmZSTDDecoder)}class c{static GetDefaultNumWorkers(){return"object"==typeof navigator&&navigator.hardwareConcurrency?Math.min(Math.floor(.5*navigator.hardwareConcurrency),4):1}static _Initialize(e){if(c._WorkerPoolPromise||c._DecoderModulePromise)return;const t={jsDecoderModule:i.w1.GetAbsoluteUrl(this.URLConfig.jsDecoderModule),wasmUASTCToASTC:n(this.URLConfig.wasmUASTCToASTC),wasmUASTCToBC7:n(this.URLConfig.wasmUASTCToBC7),wasmUASTCToRGBA_UNORM:n(this.URLConfig.wasmUASTCToRGBA_UNORM),wasmUASTCToRGBA_SRGB:n(this.URLConfig.wasmUASTCToRGBA_SRGB),wasmUASTCToR8_UNORM:n(this.URLConfig.wasmUASTCToR8_UNORM),wasmUASTCToRG8_UNORM:n(this.URLConfig.wasmUASTCToRG8_UNORM),jsMSCTranscoder:n(this.URLConfig.jsMSCTranscoder),wasmMSCTranscoder:n(this.URLConfig.wasmMSCTranscoder),wasmZSTDDecoder:n(this.URLConfig.wasmZSTDDecoder)};e&&"function"==typeof Worker&&"undefined"!=typeof URL?c._WorkerPoolPromise=new Promise((s=>{const i=`${a}(${l})()`,o=URL.createObjectURL(new Blob([i],{type:"application/javascript"}));s(new r.v(e,(()=>new Promise(((e,s)=>{const r=new Worker(o),i=e=>{r.removeEventListener("error",i),r.removeEventListener("message",n),s(e)},n=t=>{"init"===t.data.action&&(r.removeEventListener("error",i),r.removeEventListener("message",n),e(r))};r.addEventListener("error",i),r.addEventListener("message",n),r.postMessage({action:"init",urls:t})})))))})):"undefined"==typeof KTX2DECODER?c._DecoderModulePromise=i.w1.LoadScriptAsync(t.jsDecoderModule).then((()=>(KTX2DECODER.MSCTranscoder.UseFromWorkerThread=!1,KTX2DECODER.WASMMemoryManager.LoadBinariesFromCurrentThread=!0,a(t),new KTX2DECODER.KTX2Decoder))):(KTX2DECODER.MSCTranscoder.UseFromWorkerThread=!1,KTX2DECODER.WASMMemoryManager.LoadBinariesFromCurrentThread=!0,c._DecoderModulePromise=Promise.resolve(new KTX2DECODER.KTX2Decoder))}constructor(e,t=c.DefaultNumWorkers){this._engine=e,c._Initialize(t)}uploadAsync(e,t,s){const r=this._engine.getCaps(),i={astc:!!r.astc,bptc:!!r.bptc,s3tc:!!r.s3tc,pvrtc:!!r.pvrtc,etc2:!!r.etc2,etc1:!!r.etc1};if(c._WorkerPoolPromise)return c._WorkerPoolPromise.then((r=>new Promise(((o,n)=>{r.push(((r,a)=>{const l=e=>{r.removeEventListener("error",l),r.removeEventListener("message",h),n(e),a()},h=e=>{if("decoded"===e.data.action){if(r.removeEventListener("error",l),r.removeEventListener("message",h),e.data.success)try{this._createTexture(e.data.decodedData,t,s),o()}catch(e){n({message:e})}else n({message:e.data.msg});a()}};r.addEventListener("error",l),r.addEventListener("message",h),c.DefaultDecoderOptions.isDirty&&r.postMessage({action:"setDefaultDecoderOptions",options:c.DefaultDecoderOptions._getKTX2DecoderOptions()});const d=new Uint8Array(e.byteLength);d.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),r.postMessage({action:"decode",data:d,caps:i,options:s},[d.buffer])}))}))));if(c._DecoderModulePromise)return c._DecoderModulePromise.then((s=>new Promise(((i,o)=>{s.decode(e,r).then((e=>{this._createTexture(e,t),i()})).catch((e=>{o({message:e})}))}))));throw new Error("KTX2 decoder module is not available")}_createTexture(e,t,s){this._engine._bindTextureDirectly(3553,t),s&&(s.transcodedFormat=e.transcodedFormat,s.isInGammaSpace=e.isInGammaSpace,s.hasAlpha=e.hasAlpha,s.transcoderName=e.transcoderName);let r=!0;switch(e.transcodedFormat){case 32856:t.type=0,t.format=5;break;case 33321:t.type=0,t.format=6;break;case 33323:t.type=0,t.format=7;break;default:t.format=e.transcodedFormat,r=!1}if(t._gammaSpace=e.isInGammaSpace,t.generateMipMaps=e.mipmaps.length>1,e.errors)throw new Error("KTX2 container - could not transcode the data. "+e.errors);for(let s=0;s<e.mipmaps.length;++s){const i=e.mipmaps[s];if(!i||!i.data)throw new Error("KTX2 container - could not transcode one of the image");r?(t.width=i.width,t.height=i.height,this._engine._uploadDataToTextureDirectly(t,i.data,0,s,void 0,!0)):this._engine._uploadCompressedDataToTextureDirectly(t,e.transcodedFormat,i.width,i.height,i.data,0,s)}t._extension=".ktx2",t.width=e.mipmaps[0].width,t.height=e.mipmaps[0].height,t.isReady=!0,this._engine._bindTextureDirectly(3553,null)}static IsValid(e){if(e.byteLength>=12){const t=new Uint8Array(e.buffer,e.byteOffset,12);if(171===t[0]&&75===t[1]&&84===t[2]&&88===t[3]&&32===t[4]&&50===t[5]&&48===t[6]&&187===t[7]&&13===t[8]&&10===t[9]&&26===t[10]&&10===t[11])return!0}return!1}}function l(){let e;onmessage=t=>{if(t.data)switch(t.data.action){case"init":{const s=t.data.urls;importScripts(s.jsDecoderModule),a(s),e=new KTX2DECODER.KTX2Decoder,postMessage({action:"init"});break}case"setDefaultDecoderOptions":KTX2DECODER.KTX2Decoder.DefaultDecoderOptions=t.data.options;break;case"decode":e.decode(t.data.data,t.data.caps,t.data.options).then((e=>{const t=[];for(let s=0;s<e.mipmaps.length;++s){const r=e.mipmaps[s];r&&r.data&&t.push(r.data.buffer)}postMessage({action:"decoded",success:!0,decodedData:e},t)})).catch((e=>{postMessage({action:"decoded",success:!1,msg:e})}))}}}c.URLConfig={jsDecoderModule:"https://preview.babylonjs.com/babylon.ktx2Decoder.js",wasmUASTCToASTC:null,wasmUASTCToBC7:null,wasmUASTCToRGBA_UNORM:null,wasmUASTCToRGBA_SRGB:null,wasmUASTCToR8_UNORM:null,wasmUASTCToRG8_UNORM:null,jsMSCTranscoder:null,wasmMSCTranscoder:null,wasmZSTDDecoder:null},c.DefaultNumWorkers=c.GetDefaultNumWorkers(),c.DefaultDecoderOptions=new class{constructor(){this._isDirty=!0,this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC=!0,this._ktx2DecoderOptions={}}get isDirty(){return this._isDirty}get useRGBAIfASTCBC7NotAvailableWhenUASTC(){return this._useRGBAIfASTCBC7NotAvailableWhenUASTC}set useRGBAIfASTCBC7NotAvailableWhenUASTC(e){this._useRGBAIfASTCBC7NotAvailableWhenUASTC!==e&&(this._useRGBAIfASTCBC7NotAvailableWhenUASTC=e,this._isDirty=!0)}get useRGBAIfOnlyBC1BC3AvailableWhenUASTC(){return this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC}set useRGBAIfOnlyBC1BC3AvailableWhenUASTC(e){this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC!==e&&(this._useRGBAIfOnlyBC1BC3AvailableWhenUASTC=e,this._isDirty=!0)}get forceRGBA(){return this._forceRGBA}set forceRGBA(e){this._forceRGBA!==e&&(this._forceRGBA=e,this._isDirty=!0)}get forceR8(){return this._forceR8}set forceR8(e){this._forceR8!==e&&(this._forceR8=e,this._isDirty=!0)}get forceRG8(){return this._forceRG8}set forceRG8(e){this._forceRG8!==e&&(this._forceRG8=e,this._isDirty=!0)}get bypassTranscoders(){return this._bypassTranscoders}set bypassTranscoders(e){this._bypassTranscoders!==e&&(this._bypassTranscoders=e,this._isDirty=!0)}_getKTX2DecoderOptions(){if(!this._isDirty)return this._ktx2DecoderOptions;this._isDirty=!1;const e={useRGBAIfASTCBC7NotAvailableWhenUASTC:this._useRGBAIfASTCBC7NotAvailableWhenUASTC,forceRGBA:this._forceRGBA,forceR8:this._forceR8,forceRG8:this._forceRG8,bypassTranscoders:this._bypassTranscoders};return this.useRGBAIfOnlyBC1BC3AvailableWhenUASTC&&(e.transcodeFormatDecisionTree={UASTC:{transcodeFormat:[o.zE.BC1_RGB,o.zE.BC3_RGBA],yes:{transcodeFormat:o.zE.RGBA32,engineFormat:o.v.RGBA8Format,roundToMultiple4:!1}}}),this._ktx2DecoderOptions=e,e}}},84318:(e,t,s)=>{s.d(t,{Y:()=>r});class r{static _CheckLimit(e,t){let s=r._LogLimitOutputs[e];return s?s.current++:(s={limit:t,current:1},r._LogLimitOutputs[e]=s),s.current<=s.limit}static _GenerateLimitMessage(e,t=1){var s;const i=r._LogLimitOutputs[e];if(!i||!r.MessageLimitReached)return;const o=this._Levels[t];i.current===i.limit&&r[o.name](r.MessageLimitReached.replace(/%LIMIT%/g,""+i.limit).replace(/%TYPE%/g,null!==(s=o.name)&&void 0!==s?s:""))}static _AddLogEntry(e){r._LogCache=e+r._LogCache,r.OnNewCacheEntry&&r.OnNewCacheEntry(e)}static _FormatMessage(e){const t=e=>e<10?"0"+e:""+e,s=new Date;return"["+t(s.getHours())+":"+t(s.getMinutes())+":"+t(s.getSeconds())+"]: "+e}static _LogDisabled(e,t){}static _LogEnabled(e=1,t,s){if(void 0!==s&&!r._CheckLimit(t,s))return;const i=r._FormatMessage(t),o=this._Levels[e];o.logFunc&&o.logFunc("BJS - "+i);const n=`<div style='color:${o.color}'>${i}</div><br>`;r._AddLogEntry(n),r._GenerateLimitMessage(t,e)}static get LogCache(){return r._LogCache}static ClearLogCache(){r._LogCache="",r._LogLimitOutputs={},r.errorsCount=0}static set LogLevels(e){r.Log=r._LogDisabled,r.Warn=r._LogDisabled,r.Error=r._LogDisabled,[r.MessageLogLevel,r.WarningLogLevel,r.ErrorLogLevel].forEach((t=>{if((e&t)===t){const e=this._Levels[t];r[e.name]=r._LogEnabled.bind(r,t)}}))}}r.NoneLogLevel=0,r.MessageLogLevel=1,r.WarningLogLevel=2,r.ErrorLogLevel=4,r.AllLogLevel=7,r.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",r._LogCache="",r._LogLimitOutputs={},r._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],r.errorsCount=0,r.Log=r._LogEnabled.bind(r,r.MessageLogLevel),r.Warn=r._LogEnabled.bind(r,r.WarningLogLevel),r.Error=r._LogEnabled.bind(r,r.ErrorLogLevel)},88114:(e,t,s)=>{s.d(t,{d:()=>n});var r=s(62897),i=s(16142),o=s(1421);s(41247);class n{constructor(e){this.onAfterReductionPerformed=new r.y$,this._forceFullscreenViewport=!0,this._activated=!1,this._camera=e,this._postProcessManager=new o.O(e.getScene()),this._onContextRestoredObserver=e.getEngine().onContextRestoredObservable.add((()=>{this._postProcessManager._rebuild()}))}get sourceTexture(){return this._sourceTexture}setSourceTexture(e,t,s=2,r=!0){if(e===this._sourceTexture)return;this.dispose(!1),this._sourceTexture=e,this._reductionSteps=[],this._forceFullscreenViewport=r;const o=this._camera.getScene(),n=new i.D("Initial reduction phase","minmaxRedux",["texSize"],["sourceTexture"],1,null,1,o.getEngine(),!1,"#define INITIAL"+(t?"\n#define DEPTH_REDUX":""),s,void 0,void 0,void 0,7);n.autoClear=!1,n.forceFullscreenViewport=r;let a=this._sourceTexture.getRenderWidth(),c=this._sourceTexture.getRenderHeight();n.onApply=((e,t)=>s=>{s.setTexture("sourceTexture",this._sourceTexture),s.setFloat2("texSize",e,t)})(a,c),this._reductionSteps.push(n);let l=1;for(;a>1||c>1;){a=Math.max(Math.round(a/2),1),c=Math.max(Math.round(c/2),1);const e=new i.D("Reduction phase "+l,"minmaxRedux",["texSize"],null,{width:a,height:c},null,1,o.getEngine(),!1,"#define "+(1==a&&1==c?"LAST":1==a||1==c?"ONEBEFORELAST":"MAIN"),s,void 0,void 0,void 0,7);if(e.autoClear=!1,e.forceFullscreenViewport=r,e.onApply=((e,t)=>s=>{1==e||1==t?s.setInt2("texSize",e,t):s.setFloat2("texSize",e,t)})(a,c),this._reductionSteps.push(e),l++,1==a&&1==c){const t=(e,t,s)=>{const r=new Float32Array(4*e*t),i={min:0,max:0};return()=>{o.getEngine()._readTexturePixels(s.inputTexture.texture,e,t,-1,0,r,!1),i.min=r[0],i.max=r[1],this.onAfterReductionPerformed.notifyObservers(i)}};e.onAfterRenderObservable.add(t(a,c,e))}}}get refreshRate(){return this._sourceTexture?this._sourceTexture.refreshRate:-1}set refreshRate(e){this._sourceTexture&&(this._sourceTexture.refreshRate=e)}get activated(){return this._activated}activate(){!this._onAfterUnbindObserver&&this._sourceTexture&&(this._onAfterUnbindObserver=this._sourceTexture.onAfterUnbindObservable.add((()=>{var e,t;const s=this._camera.getScene().getEngine();null===(e=s._debugPushGroup)||void 0===e||e.call(s,"min max reduction",1),this._reductionSteps[0].activate(this._camera),this._postProcessManager.directRender(this._reductionSteps,this._reductionSteps[0].inputTexture,this._forceFullscreenViewport),s.unBindFramebuffer(this._reductionSteps[0].inputTexture,!1),null===(t=s._debugPopGroup)||void 0===t||t.call(s,1)})),this._activated=!0)}deactivate(){this._onAfterUnbindObserver&&this._sourceTexture&&(this._sourceTexture.onAfterUnbindObservable.remove(this._onAfterUnbindObserver),this._onAfterUnbindObserver=null,this._activated=!1)}dispose(e=!0){if(e&&(this.onAfterReductionPerformed.clear(),this._onContextRestoredObserver&&(this._camera.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)),this.deactivate(),this._reductionSteps){for(let e=0;e<this._reductionSteps.length;++e)this._reductionSteps[e].dispose();this._reductionSteps=null}this._postProcessManager&&e&&this._postProcessManager.dispose(),this._sourceTexture=null}}},62897:(e,t,s)=>{s.d(t,{Qj:()=>i,he:()=>r,y$:()=>o});class r{constructor(e,t=!1,s,r){this.initialize(e,t,s,r)}initialize(e,t=!1,s,r){return this.mask=e,this.skipNextObservers=t,this.target=s,this.currentTarget=r,this}}class i{constructor(e,t,s=null){this.callback=e,this.mask=t,this.scope=s,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class o{static FromPromise(e,t){const s=new o;return e.then((e=>{s.notifyObservers(e)})).catch((e=>{if(!t)throw e;t.notifyObservers(e)})),s}get observers(){return this._observers}constructor(e){this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._eventState=new r(0),e&&(this._onObserverAdded=e)}add(e,t=-1,s=!1,r=null,o=!1){if(!e)return null;const n=new i(e,t,r);return n.unregisterOnNextCall=o,s?this._observers.unshift(n):this._observers.push(n),this._onObserverAdded&&this._onObserverAdded(n),n}addOnce(e){return this.add(e,void 0,void 0,void 0,!0)}remove(e){if(!e)return!1;return-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)}removeCallback(e,t){for(let s=0;s<this._observers.length;s++){const r=this._observers[s];if(!r._willBeUnregistered&&(r.callback===e&&(!t||t===r.scope)))return this._deferUnregister(r),!0}return!1}_deferUnregister(e){this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((()=>{this._remove(e)}),0)}_remove(e,t=!0){if(!e)return!1;const s=this._observers.indexOf(e);return-1!==s&&(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(s,1),!0)}makeObserverTopPriority(e){this._remove(e,!1),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e,!1),this._observers.push(e)}notifyObservers(e,t=-1,s,r,i){if(!this._observers.length)return!0;const o=this._eventState;o.mask=t,o.target=s,o.currentTarget=r,o.skipNextObservers=!1,o.lastReturnValue=e,o.userInfo=i;for(const s of this._observers)if(!s._willBeUnregistered&&(s.mask&t&&(s.unregisterOnNextCall&&this._deferUnregister(s),s.scope?o.lastReturnValue=s.callback.apply(s.scope,[e,o]):o.lastReturnValue=s.callback(e,o)),o.skipNextObservers))return!1;return!0}notifyObserver(e,t,s=-1){if(e._willBeUnregistered)return;const r=this._eventState;r.mask=s,r.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(t,r)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){this._observers=new Array,this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0}clone(){const e=new o;return e._observers=this._observers.slice(0),e}hasSpecificMask(e=-1){for(const t of this._observers)if(t.mask&e||t.mask===e)return!0;return!1}}},82577:(e,t,s)=>{s.d(t,{z:()=>i});var r=s(29945);class i{get min(){return this._min}get max(){return this._max}get average(){return this._average}get lastSecAverage(){return this._lastSecAverage}get current(){return this._current}get total(){return this._totalAccumulated}get count(){return this._totalValueCount}constructor(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}fetchNewFrame(){this._totalValueCount++,this._current=0,this._lastSecValueCount++}addCount(e,t){i.Enabled&&(this._current+=e,t&&this._fetchResult())}beginMonitoring(){i.Enabled&&(this._startMonitoringTime=r.F.Now)}endMonitoring(e=!0){if(!i.Enabled)return;e&&this.fetchNewFrame();const t=r.F.Now;this._current=t-this._startMonitoringTime,e&&this._fetchResult()}_fetchResult(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;const e=r.F.Now;e-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=e,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}i.Enabled=!0},31700:(e,t,s)=>{s.d(t,{A:()=>i});var r=s(29945);class i{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new o(e)}sampleFrame(e=r.F.Now){if(this._enabled){if(null!=this._lastFrameTimeMs){const t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){const e=this._rollingFrameTime.history(0);return 0===e?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class o{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){const e=this._samples[this._pos];t=e-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(e-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;const t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){const t=this._samples.length;return(e%t+t)%t}}},11337:(e,t,s)=>{s.d(t,{m:()=>i});var r=s(58095);class i{static _RemoveAndStorePivotPoint(e){e&&0===i._PivotCached&&(e.getPivotPointToRef(i._OldPivotPoint),i._PivotPostMultiplyPivotMatrix=e._postMultiplyPivotMatrix,i._OldPivotPoint.equalsToFloats(0,0,0)||(e.setPivotMatrix(r.y3.IdentityReadOnly),i._OldPivotPoint.subtractToRef(e.getPivotPoint(),i._PivotTranslation),i._PivotTmpVector.copyFromFloats(1,1,1),i._PivotTmpVector.subtractInPlace(e.scaling),i._PivotTmpVector.multiplyInPlace(i._PivotTranslation),e.position.addInPlace(i._PivotTmpVector))),i._PivotCached++}static _RestorePivotPoint(e){e&&!i._OldPivotPoint.equalsToFloats(0,0,0)&&1===i._PivotCached&&(e.setPivotPoint(i._OldPivotPoint),e._postMultiplyPivotMatrix=i._PivotPostMultiplyPivotMatrix,i._PivotTmpVector.copyFromFloats(1,1,1),i._PivotTmpVector.subtractInPlace(e.scaling),i._PivotTmpVector.multiplyInPlace(i._PivotTranslation),e.position.subtractInPlace(i._PivotTmpVector)),this._PivotCached--}}i._PivotCached=0,i._OldPivotPoint=new r.P,i._PivotTranslation=new r.P,i._PivotTmpVector=new r.P,i._PivotPostMultiplyPivotMatrix=!1},29945:(e,t,s)=>{s.d(t,{F:()=>i});var r=s(80352);class i{static get Now(){return r.MZ.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},42874:(e,t,s)=>{s.d(t,{b:()=>r});class r{static ExponentialBackoff(e=3,t=500){return(s,r,i)=>0!==r.status||i>=e||-1!==s.indexOf("file:")?-1:Math.pow(2,i)*t}}},95718:(e,t,s)=>{s.d(t,{r:()=>o});var r=s(16142),i=(s(87866),s(13534),s(80949));class o{static ExpandRGBDTexture(e){const t=e._texture;if(!t||!e.isRGBD)return;const s=t.getEngine(),i=s.getCaps(),o=t.isReady;let n=!1;i.textureHalfFloatRender&&i.textureHalfFloatLinearFiltering?(n=!0,t.type=2):i.textureFloatRender&&i.textureFloatLinearFiltering&&(n=!0,t.type=1),n&&(t.isReady=!1,t._isRGBD=!1,t.invertY=!1);const a=()=>{if(n){const i=new r.D("rgbdDecode","rgbdDecode",null,null,1,null,3,s,!1,void 0,t.type,void 0,null,!1);i.externalTextureSamplerBinding=!0;const o=s.createRenderTargetTexture(t.width,{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:t.samplingMode,type:t.type,format:5});i.getEffect().executeWhenCompiled((()=>{i.onApply=e=>{e._bindTexture("textureSampler",t),e.setFloat2("scale",1,1)},e.getScene().postProcessManager.directRender([i],o,!0),s.restoreDefaultFramebuffer(),s._releaseTexture(t),i&&i.dispose(),o._swapAndDie(t),t.isReady=!0}))}};o?a():e.onLoadObservable.addOnce(a)}static EncodeTextureToRGBD(e,t,s=0){return(0,i.$0)("rgbdEncode",e,t,s,1,5)}}},77118:(e,t,s)=>{var r=s(73803),i=s(63784),o=s(30374),n=s(84318),a=s(13514),c=s(74802);let l=null;function h(e,t,s,r,i="image/png",o=!1){const{height:c,width:h}=f(e,t,s);if(!c||!h)return void n.Y.Error("Invalid 'size' parameter !");l||(l=document.createElement("canvas")),l.width=h,l.height=c;const d=l.getContext("2d"),g=e.getRenderWidth()/e.getRenderHeight();let p=h,m=p/g;m>c&&(m=c,p=m*g);const _=Math.max(0,h-p)/2,A=Math.max(0,c-m)/2;t.getScene().activeCamera!==t?u(e,t,s,(e=>{if(o){const t=new Blob([e]);a.w1.DownloadBlob(t),r&&r("")}else r&&r(e)}),i,1,e.getCreationOptions().antialias):e.onEndFrameObservable.addOnce((()=>{const t=e.getRenderingCanvas();d&&t&&d.drawImage(t,_,A,p,m),l&&(o?(a.w1.EncodeScreenshotCanvasData(l,void 0,i),r&&r("")):a.w1.EncodeScreenshotCanvasData(l,r,i))}))}function d(e,t,s,r="image/png"){return new Promise(((i,o)=>{h(e,t,s,(e=>{void 0!==e?i(e):o(new Error("Data is undefined"))}),r)}))}function u(e,t,s,a,l="image/png",h=1,d=!1,u,g=!1,p=!1,m=!0){const{height:_,width:A}=f(e,t,s),v={width:A,height:_};if(!_||!A)return void n.Y.Error("Invalid 'size' parameter !");const C={width:e.getRenderWidth(),height:e.getRenderHeight()};e.setSize(A,_);const T=t.getScene(),w=new i._("screenShot",v,T,!1,!1,0,!1,r.x.NEAREST_SAMPLINGMODE,void 0,p,void 0,void 0,void 0,h);w.renderList=T.meshes.slice(),w.samples=h,w.renderSprites=g,w.activeCamera=t,w.forceLayerMaskCheck=m;const b=()=>{e.onEndFrameObservable.addOnce((()=>{w.readPixels(void 0,void 0,void 0,!1).then((e=>{c.B.DumpData(A,_,e,a,l,u,!0),w.dispose()}))})),T.incrementRenderId(),T.resetCachedMaterial(),w.render(!0),T.incrementRenderId(),T.resetCachedMaterial(),e.setSize(C.width,C.height),t.getProjectionMatrix(!0),T.render()};if(d){const e=new o.P("antialiasing",1,T.activeCamera);w.addPostProcess(e),e.getEffect().isReady()?b():e.getEffect().onCompiled=()=>{b()}}else b()}function g(e,t,s,r="image/png",i=1,o=!1,n,a=!1,c=!1,l=!0){return new Promise(((h,d)=>{u(e,t,s,(e=>{void 0!==e?h(e):d(new Error("Data is undefined"))}),r,i,o,n,a,c,l)}))}function f(e,t,s){let r=0,i=0;if("object"==typeof s){const o=s.precision?Math.abs(s.precision):1;s.width&&s.height?(r=s.height*o,i=s.width*o):s.width&&!s.height?(i=s.width*o,r=Math.round(i/e.getAspectRatio(t))):s.height&&!s.width?(r=s.height*o,i=Math.round(r*e.getAspectRatio(t))):(i=Math.round(e.getRenderWidth()*o),r=Math.round(i/e.getAspectRatio(t)))}else isNaN(s)||(r=s,i=s);return i&&(i=Math.floor(i)),r&&(r=Math.floor(r)),{height:0|r,width:0|i}}a.w1.CreateScreenshot=h,a.w1.CreateScreenshotAsync=d,a.w1.CreateScreenshotUsingRenderTarget=u,a.w1.CreateScreenshotUsingRenderTargetAsync=g},7788:(e,t,s)=>{s.d(t,{f:()=>i,t:()=>r});class r{constructor(e){this.length=0,this.data=new Array(e),this._id=r._GlobalId++}push(e){this.data[this.length++]=e,this.length>this.data.length&&(this.data.length*=2)}forEach(e){for(let t=0;t<this.length;t++)e(this.data[t])}sort(e){this.data.sort(e)}reset(){this.length=0}dispose(){this.reset(),this.data&&(this.data.length=0)}concat(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(let t=0;t<e.length;t++)this.data[this.length++]=(e.data||e)[t]}}indexOf(e){const t=this.data.indexOf(e);return t>=this.length?-1:t}contains(e){return-1!==this.indexOf(e)}}r._GlobalId=0;class i extends r{constructor(){super(...arguments),this._duplicateId=0}push(e){super.push(e),e.__smartArrayFlags||(e.__smartArrayFlags={}),e.__smartArrayFlags[this._id]=this._duplicateId}pushNoDuplicate(e){return(!e.__smartArrayFlags||e.__smartArrayFlags[this._id]!==this._duplicateId)&&(this.push(e),!0)}reset(){super.reset(),this._duplicateId++}concatWithNoDuplicate(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(let t=0;t<e.length;t++){const s=(e.data||e)[t];this.pushNoDuplicate(s)}}}}},45008:(e,t,s)=>{s.d(t,{x:()=>r});class r{constructor(){this._count=0,this._data={}}copyFrom(e){this.clear(),e.forEach(((e,t)=>this.add(e,t)))}get(e){const t=this._data[e];if(void 0!==t)return t}getOrAddWithFactory(e,t){let s=this.get(e);return void 0!==s||(s=t(e),s&&this.add(e,s)),s}getOrAdd(e,t){const s=this.get(e);return void 0!==s?s:(this.add(e,t),t)}contains(e){return void 0!==this._data[e]}add(e,t){return void 0===this._data[e]&&(this._data[e]=t,++this._count,!0)}set(e,t){return void 0!==this._data[e]&&(this._data[e]=t,!0)}getAndRemove(e){const t=this.get(e);return void 0!==t?(delete this._data[e],--this._count,t):null}remove(e){return!!this.contains(e)&&(delete this._data[e],--this._count,!0)}clear(){this._data={},this._count=0}get count(){return this._count}forEach(e){for(const t in this._data){e(t,this._data[t])}}first(e){for(const t in this._data){const s=e(t,this._data[t]);if(s)return s}return null}}},29972:(e,t,s)=>{s.d(t,{Gh:()=>i,HQ:()=>n,Ml:()=>a,fJ:()=>r,rP:()=>o});const r=e=>{if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let s=0;s<e.byteLength;s++)t+=String.fromCharCode(e[s]);return t},i=e=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s,r,i,o,n,a,c,l="",h=0;const d=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);for(;h<d.length;)s=d[h++],r=h<d.length?d[h++]:Number.NaN,i=h<d.length?d[h++]:Number.NaN,o=s>>2,n=(3&s)<<4|r>>4,a=(15&r)<<2|i>>6,c=63&i,isNaN(r)?a=c=64:isNaN(i)&&(c=64),l+=t.charAt(o)+t.charAt(n)+t.charAt(a)+t.charAt(c);return l},o=e=>atob(e),n=e=>{const t=o(e),s=t.length,r=new Uint8Array(new ArrayBuffer(s));for(let e=0;e<s;e++)r[e]=t.charCodeAt(e);return r.buffer},a={EndsWith:(e,t)=>e.endsWith(t),StartsWith:(e,t)=>!!e&&e.startsWith(t),Decode:r,EncodeArrayBufferToBase64:i,DecodeBase64ToString:o,DecodeBase64ToBinary:n,PadNumber:(e,t)=>{let s=String(e);for(;s.length<t;)s="0"+s;return s}}},20163:(e,t,s)=>{s.d(t,{$:()=>i});var r=s(26769);class i{static EnableFor(e){e._tags=e._tags||{},e.hasTags=()=>i.HasTags(e),e.addTags=t=>i.AddTagsTo(e,t),e.removeTags=t=>i.RemoveTagsFrom(e,t),e.matchesTagsQuery=t=>i.MatchesQuery(e,t)}static DisableFor(e){delete e._tags,delete e.hasTags,delete e.addTags,delete e.removeTags,delete e.matchesTagsQuery}static HasTags(e){if(!e._tags)return!1;const t=e._tags;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1}static GetTags(e,t=!0){if(!e._tags)return null;if(t){const t=[];for(const s in e._tags)Object.prototype.hasOwnProperty.call(e._tags,s)&&!0===e._tags[s]&&t.push(s);return t.join(" ")}return e._tags}static AddTagsTo(e,t){if(!t)return;if("string"!=typeof t)return;t.split(" ").forEach((function(t){i._AddTagTo(e,t)}))}static _AddTagTo(e,t){""!==(t=t.trim())&&"true"!==t&&"false"!==t&&(t.match(/[\s]/)||t.match(/^([!]|([|]|[&]){2})/)||(i.EnableFor(e),e._tags[t]=!0))}static RemoveTagsFrom(e,t){if(!i.HasTags(e))return;const s=t.split(" ");for(const t in s)i._RemoveTagFrom(e,s[t])}static _RemoveTagFrom(e,t){delete e._tags[t]}static MatchesQuery(e,t){return void 0===t||(""===t?i.HasTags(e):r.q.Eval(t,(t=>i.HasTags(e)&&e._tags[t])))}}},80949:(e,t,s)=>{s.d(t,{$0:()=>i,ay:()=>a,qZ:()=>c});s(73803),s(63784),s(89815);var r=s(16142);function i(e,t,s,i,o,n){const a=t.getEngine();return t.isReady=!1,o=null!=o?o:t.samplingMode,i=null!=i?i:t.type,n=null!=n?n:t.format,-1===i&&(i=0),new Promise((c=>{const l=new r.D("postprocess",e,null,null,1,null,o,a,!1,void 0,i,void 0,null,!1,n);l.externalTextureSamplerBinding=!0;const h=a.createRenderTargetTexture({width:t.width,height:t.height},{generateDepthBuffer:!1,generateMipMaps:!1,generateStencilBuffer:!1,samplingMode:o,type:i,format:n});l.getEffect().executeWhenCompiled((()=>{l.onApply=e=>{e._bindTexture("textureSampler",t),e.setFloat2("scale",1,1)},s.postProcessManager.directRender([l],h,!0),a.restoreDefaultFramebuffer(),a._releaseTexture(t),l&&l.dispose(),h._swapAndDie(t),t.type=i,t.format=5,t.isReady=!0,c(t)}))}))}let o,n;function a(e){o||(o=new Float32Array(1),n=new Int32Array(o.buffer)),o[0]=e;const t=n[0];let s=t>>16&32768,r=t>>12&2047;const i=t>>23&255;return i<103?s:i>142?(s|=31744,s|=(255==i?0:1)&&8388607&t,s):i<113?(r|=2048,s|=(r>>114-i)+(r>>113-i&1),s):(s|=i-112<<10|r>>1,s+=1&r,s)}function c(e){const t=(32768&e)>>15,s=(31744&e)>>10,r=1023&e;return 0===s?(t?-1:1)*Math.pow(2,-14)*(r/Math.pow(2,10)):31==s?r?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,s-15)*(1+r/Math.pow(2,10))}},76755:(e,t,s)=>{s.d(t,{A6:()=>i,Ab:()=>o});var r=s(84318);function i(e){let t=0;return{id_length:e[t++],colormap_type:e[t++],image_type:e[t++],colormap_index:e[t++]|e[t++]<<8,colormap_length:e[t++]|e[t++]<<8,colormap_size:e[t++],origin:[e[t++]|e[t++]<<8,e[t++]|e[t++]<<8],width:e[t++]|e[t++]<<8,height:e[t++]|e[t++]<<8,pixel_size:e[t++],flags:e[t++]}}function o(e,t){if(t.length<19)return void r.Y.Error("Unable to load TGA file - Not enough data to contain header");let s=18;const o=i(t);if(o.id_length+s>t.length)return void r.Y.Error("Unable to load TGA file - Not enough data");s+=o.id_length;let a,c=!1,l=!1,h=!1;switch(o.image_type){case 9:c=!0;case 1:l=!0;break;case 10:c=!0;case 2:break;case 11:c=!0;case 3:h=!0}const d=o.pixel_size>>3,u=o.width*o.height*d;let g,f,p,m,_,A,v;if(l&&(g=t.subarray(s,s+=o.colormap_length*(o.colormap_size>>3))),c){let e,r,i;a=new Uint8Array(u);let o=0;const n=new Uint8Array(d);for(;s<u&&o<u;)if(e=t[s++],r=1+(127&e),128&e){for(i=0;i<d;++i)n[i]=t[s++];for(i=0;i<r;++i)a.set(n,o+i*d);o+=d*r}else{for(r*=d,i=0;i<r;++i)a[o+i]=t[s++];o+=r}}else a=t.subarray(s,s+=l?o.width*o.height:u);switch((48&o.flags)>>4){default:case 2:f=0,m=1,v=o.width,p=0,_=1,A=o.height;break;case 0:f=0,m=1,v=o.width,p=o.height-1,_=-1,A=-1;break;case 3:f=o.width-1,m=-1,v=-1,p=0,_=1,A=o.height;break;case 1:f=o.width-1,m=-1,v=-1,p=o.height-1,_=-1,A=-1}const C="_getImageData"+(h?"Grey":"")+o.pixel_size+"bits",T=n[C](o,g,a,p,_,A,f,m,v);e.getEngine()._uploadDataToTextureDirectly(e,T)}const n={GetTGAHeader:i,UploadContent:o,_getImageData8bits:function(e,t,s,r,i,o,n,a,c){const l=s,h=t,d=e.width,u=e.height;let g,f,p,m=0;const _=new Uint8Array(d*u*4);for(p=r;p!==o;p+=i)for(f=n;f!==c;f+=a,m++)g=l[m],_[4*(f+d*p)+3]=255,_[4*(f+d*p)+2]=h[3*g+0],_[4*(f+d*p)+1]=h[3*g+1],_[4*(f+d*p)+0]=h[3*g+2];return _},_getImageData16bits:function(e,t,s,r,i,o,n,a,c){const l=s,h=e.width,d=e.height;let u,g,f,p=0;const m=new Uint8Array(h*d*4);for(f=r;f!==o;f+=i)for(g=n;g!==c;g+=a,p+=2){u=l[p+0]+(l[p+1]<<8);const e=255*((31744&u)>>10)/31|0,t=255*((992&u)>>5)/31|0,s=255*(31&u)/31|0;m[4*(g+h*f)+0]=e,m[4*(g+h*f)+1]=t,m[4*(g+h*f)+2]=s,m[4*(g+h*f)+3]=32768&u?0:255}return m},_getImageData24bits:function(e,t,s,r,i,o,n,a,c){const l=s,h=e.width,d=e.height;let u,g,f=0;const p=new Uint8Array(h*d*4);for(g=r;g!==o;g+=i)for(u=n;u!==c;u+=a,f+=3)p[4*(u+h*g)+3]=255,p[4*(u+h*g)+2]=l[f+0],p[4*(u+h*g)+1]=l[f+1],p[4*(u+h*g)+0]=l[f+2];return p},_getImageData32bits:function(e,t,s,r,i,o,n,a,c){const l=s,h=e.width,d=e.height;let u,g,f=0;const p=new Uint8Array(h*d*4);for(g=r;g!==o;g+=i)for(u=n;u!==c;u+=a,f+=4)p[4*(u+h*g)+2]=l[f+0],p[4*(u+h*g)+1]=l[f+1],p[4*(u+h*g)+0]=l[f+2],p[4*(u+h*g)+3]=l[f+3];return p},_getImageDataGrey8bits:function(e,t,s,r,i,o,n,a,c){const l=s,h=e.width,d=e.height;let u,g,f,p=0;const m=new Uint8Array(h*d*4);for(f=r;f!==o;f+=i)for(g=n;g!==c;g+=a,p++)u=l[p],m[4*(g+h*f)+0]=u,m[4*(g+h*f)+1]=u,m[4*(g+h*f)+2]=u,m[4*(g+h*f)+3]=255;return m},_getImageDataGrey16bits:function(e,t,s,r,i,o,n,a,c){const l=s,h=e.width,d=e.height;let u,g,f=0;const p=new Uint8Array(h*d*4);for(g=r;g!==o;g+=i)for(u=n;u!==c;u+=a,f+=2)p[4*(u+h*g)+0]=l[f+0],p[4*(u+h*g)+1]=l[f+0],p[4*(u+h*g)+2]=l[f+0],p[4*(u+h*g)+3]=l[f+1];return p}}},16433:(e,t,s)=>{s.d(t,{g_:()=>i});var r;s(62897);function i(e){var t;let s=0;const r=Date.now();e.observableParameters=null!==(t=e.observableParameters)&&void 0!==t?t:{};const i=e.contextObservable.add((t=>{const o=Date.now();s=o-r;const n={startTime:r,currentTime:o,deltaTime:s,completeRate:s/e.timeout,payload:t};e.onTick&&e.onTick(n),e.breakCondition&&e.breakCondition()&&(e.contextObservable.remove(i),e.onAborted&&e.onAborted(n)),s>=e.timeout&&(e.contextObservable.remove(i),e.onEnded&&e.onEnded(n))}),e.observableParameters.mask,e.observableParameters.insertFirst,e.observableParameters.scope);return i}!function(e){e[e.INIT=0]="INIT",e[e.STARTED=1]="STARTED",e[e.ENDED=2]="ENDED"}(r||(r={}))},44335:(e,t,s)=>{s.d(t,{Q:()=>i});var r=s(80352);class i{static SetImmediate(e){(0,r.CG)()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)}}},13514:(e,t,s)=>{s.d(t,{$g:()=>m,w1:()=>p});var r=s(62897),i=s(80352),o=s(84318),n=s(1101),a=s(29945),c=s(77851),l=s(51912),h=s(15210),d=s(79245),u=s(44335),g=s(35890),f=s(54007);class p{static get BaseUrl(){return d.rN.BaseUrl}static set BaseUrl(e){d.rN.BaseUrl=e}static get DefaultRetryStrategy(){return d.rN.DefaultRetryStrategy}static set DefaultRetryStrategy(e){d.rN.DefaultRetryStrategy=e}static get CorsBehavior(){return d.rN.CorsBehavior}static set CorsBehavior(e){d.rN.CorsBehavior=e}static get UseFallbackTexture(){return h.l.UseFallbackTexture}static set UseFallbackTexture(e){h.l.UseFallbackTexture=e}static get RegisteredExternalClasses(){return g.K.RegisteredExternalClasses}static set RegisteredExternalClasses(e){g.K.RegisteredExternalClasses=e}static get fallbackTexture(){return h.l.FallbackTexture}static set fallbackTexture(e){h.l.FallbackTexture=e}static FetchToRef(e,t,s,r,i,o){const n=4*((Math.abs(e)*s%s|0)+(Math.abs(t)*r%r|0)*s);o.r=i[n]/255,o.g=i[n+1]/255,o.b=i[n+2]/255,o.a=i[n+3]/255}static Mix(e,t,s){return e*(1-s)+t*s}static Instantiate(e){return g.K.Instantiate(e)}static SetImmediate(e){u.Q.SetImmediate(e)}static IsExponentOfTwo(e){let t=1;do{t*=2}while(t<e);return t===e}static FloatRound(e){return Math.fround?Math.fround(e):(p._TmpFloatArray[0]=e,p._TmpFloatArray[0])}static GetFilename(e){const t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)}static GetFolderPath(e,t=!1){const s=e.lastIndexOf("/");return s<0?t?e:"":e.substring(0,s+1)}static ToDegrees(e){return 180*e/Math.PI}static ToRadians(e){return e*Math.PI/180}static SmoothAngleChange(e,t,s=.9){const r=this.ToRadians(e),i=this.ToRadians(t);return this.ToDegrees(Math.atan2((1-s)*Math.sin(i)+s*Math.sin(r),(1-s)*Math.cos(i)+s*Math.cos(r)))}static MakeArray(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null}static GetPointerPrefix(e){let t="pointer";return(0,i.CG)()&&!window.PointerEvent&&(t="mouse"),!e._badDesktopOS||e._badOS||document&&"ontouchend"in document||(t="mouse"),t}static SetCorsBehavior(e,t){(0,d.$M)(e,t)}static SetReferrerPolicyBehavior(e,t){t.referrerPolicy=e}static CleanUrl(e){return e=e.replace(/#/gm,"%23")}static get PreprocessUrl(){return d.rN.PreprocessUrl}static set PreprocessUrl(e){d.rN.PreprocessUrl=e}static LoadImage(e,t,s,r,i,o){return(0,d.r6)(e,t,s,r,i,o)}static LoadFile(e,t,s,r,i,o){return(0,d.vP)(e,t,s,r,i,o)}static LoadFileAsync(e,t=!0){return new Promise(((s,r)=>{(0,d.vP)(e,(e=>{s(e)}),void 0,void 0,t,((e,t)=>{r(t)}))}))}static LoadScript(e,t,s,r){if("function"==typeof importScripts){try{importScripts(e),t()}catch(t){null==s||s(`Unable to load script '${e}' in worker`,t)}return}if(!(0,i.CG)())return void(null==s||s(`Cannot load script '${e}' outside of a window or a worker`));const o=document.getElementsByTagName("head")[0],n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),r&&(n.id=r),n.onload=()=>{t&&t()},n.onerror=t=>{s&&s(`Unable to load script '${e}'`,t)},o.appendChild(n)}static LoadScriptAsync(e){return new Promise(((t,s)=>{this.LoadScript(e,(()=>{t()}),((e,t)=>{s(t||new Error(e))}))}))}static ReadFileAsDataURL(e,t,s){const i=new FileReader,o={onCompleteObservable:new r.y$,abort:()=>i.abort()};return i.onloadend=()=>{o.onCompleteObservable.notifyObservers(o)},i.onload=e=>{t(e.target.result)},i.onprogress=s,i.readAsDataURL(e),o}static ReadFile(e,t,s,r,i){return(0,d.Ip)(e,t,s,r,i)}static FileAsURL(e){const t=new Blob([e]);return window.URL.createObjectURL(t)}static Format(e,t=2){return e.toFixed(t)}static DeepCopy(e,t,s,r){n.j.DeepCopy(e,t,s,r)}static IsEmpty(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}static RegisterTopRootEvents(e,t){for(let s=0;s<t.length;s++){const r=t[s];e.addEventListener(r.name,r.handler,!1);try{window.parent&&window.parent.addEventListener(r.name,r.handler,!1)}catch(e){}}}static UnregisterTopRootEvents(e,t){for(let s=0;s<t.length;s++){const r=t[s];e.removeEventListener(r.name,r.handler);try{e.parent&&e.parent.removeEventListener(r.name,r.handler)}catch(e){}}}static async DumpFramebuffer(e,t,s,r,i="image/png",o){throw(0,c.S)("DumpTools")}static DumpData(e,t,s,r,i="image/png",o,n=!1,a=!1,l){throw(0,c.S)("DumpTools")}static DumpDataAsync(e,t,s,r="image/png",i,o=!1,n=!1,a){throw(0,c.S)("DumpTools")}static ToBlob(e,t,s="image/png",r){e.toBlob||(e.toBlob=function(e,t,s){setTimeout((()=>{const r=atob(this.toDataURL(t,s).split(",")[1]),i=r.length,o=new Uint8Array(i);for(let e=0;e<i;e++)o[e]=r.charCodeAt(e);e(new Blob([o]))}))}),e.toBlob((function(e){t(e)}),s,r)}static DownloadBlob(e,t){if("download"in document.createElement("a")){if(!t){const e=new Date;t="screenshot_"+((e.getFullYear()+"-"+(e.getMonth()+1)).slice(2)+"-"+e.getDate()+"_"+e.getHours()+"-"+("0"+e.getMinutes()).slice(-2))+".png"}p.Download(e,t)}else if(e&&"undefined"!=typeof URL){const t=URL.createObjectURL(e),s=window.open("");if(!s)return;const r=s.document.createElement("img");r.onload=function(){URL.revokeObjectURL(t)},r.src=t,s.document.body.appendChild(r)}}static EncodeScreenshotCanvasData(e,t,s="image/png",r,i){if(t){t(e.toDataURL(s,i))}else this.ToBlob(e,(function(e){e&&p.DownloadBlob(e,r)}),s,i)}static Download(e,t){if("undefined"==typeof URL)return;const s=window.URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.style.display="none",r.href=s,r.download=t,r.addEventListener("click",(()=>{r.parentElement&&r.parentElement.removeChild(r)})),r.click(),window.URL.revokeObjectURL(s)}static BackCompatCameraNoPreventDefault(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]}static CreateScreenshot(e,t,s,r,i="image/png"){throw(0,c.S)("ScreenshotTools")}static CreateScreenshotAsync(e,t,s,r="image/png"){throw(0,c.S)("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(e,t,s,r,i="image/png",o=1,n=!1,a){throw(0,c.S)("ScreenshotTools")}static CreateScreenshotUsingRenderTargetAsync(e,t,s,r="image/png",i=1,o=!1,n){throw(0,c.S)("ScreenshotTools")}static RandomId(){return(0,f.f)()}static IsBase64(e){return(0,d.VL)(e)}static DecodeBase64(e){return(0,d.$K)(e)}static get errorsCount(){return o.Y.errorsCount}static Log(e){o.Y.Log(e)}static Warn(e){o.Y.Warn(e)}static Error(e){o.Y.Error(e)}static get LogCache(){return o.Y.LogCache}static ClearLogCache(){o.Y.ClearLogCache()}static set LogLevels(e){o.Y.LogLevels=e}static set PerformanceLogLevel(e){return(e&p.PerformanceUserMarkLogLevel)===p.PerformanceUserMarkLogLevel?(p.StartPerformanceCounter=p._StartUserMark,void(p.EndPerformanceCounter=p._EndUserMark)):(e&p.PerformanceConsoleLogLevel)===p.PerformanceConsoleLogLevel?(p.StartPerformanceCounter=p._StartPerformanceConsole,void(p.EndPerformanceCounter=p._EndPerformanceConsole)):(p.StartPerformanceCounter=p._StartPerformanceCounterDisabled,void(p.EndPerformanceCounter=p._EndPerformanceCounterDisabled))}static _StartPerformanceCounterDisabled(e,t){}static _EndPerformanceCounterDisabled(e,t){}static _StartUserMark(e,t=!0){if(!p._Performance){if(!(0,i.CG)())return;p._Performance=window.performance}t&&p._Performance.mark&&p._Performance.mark(e+"-Begin")}static _EndUserMark(e,t=!0){t&&p._Performance.mark&&(p._Performance.mark(e+"-End"),p._Performance.measure(e,e+"-Begin",e+"-End"))}static _StartPerformanceConsole(e,t=!0){t&&(p._StartUserMark(e,t),console.time&&console.time(e))}static _EndPerformanceConsole(e,t=!0){t&&(p._EndUserMark(e,t),console.timeEnd(e))}static get Now(){return a.F.Now}static GetClassName(e,t=!1){let s=null;if(!t&&e.getClassName)s=e.getClassName();else{if(e instanceof Object){s=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__}s||(s=typeof e)}return s}static First(e,t){for(const s of e)if(t(s))return s;return null}static getFullClassName(e,t=!1){let s=null,r=null;if(!t&&e.getClassName)s=e.getClassName();else{if(e instanceof Object){const i=t?e:Object.getPrototypeOf(e);s=i.constructor.__bjsclassName__,r=i.constructor.__bjsmoduleName__}s||(s=typeof e)}return s?(null!=r?r+".":"")+s:null}static DelayAsync(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}static IsSafari(){return!!(0,i.up)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}p.UseCustomRequestHeaders=!1,p.CustomRequestHeaders=l.g.CustomRequestHeaders,p._TmpFloatArray=new Float32Array(1),p.GetDOMTextContent=i.v,p.GetAbsoluteUrl="object"==typeof document?e=>{const t=document.createElement("a");return t.href=e,t.href}:"function"==typeof URL&&"object"==typeof location?e=>new URL(e,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},p.NoneLogLevel=o.Y.NoneLogLevel,p.MessageLogLevel=o.Y.MessageLogLevel,p.WarningLogLevel=o.Y.WarningLogLevel,p.ErrorLogLevel=o.Y.ErrorLogLevel,p.AllLogLevel=o.Y.AllLogLevel,p.IsWindowObjectExist=i.CG,p.PerformanceNoneLogLevel=0,p.PerformanceUserMarkLogLevel=1,p.PerformanceConsoleLogLevel=2,p.StartPerformanceCounter=p._StartPerformanceCounterDisabled,p.EndPerformanceCounter=p._EndPerformanceCounterDisabled;class m{constructor(e,t,s,r=0){this.iterations=e,this.index=r-1,this._done=!1,this._fn=t,this._successCallback=s}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(e,t,s,r=0){const i=new m(e,t,s,r);return i.executeNext(),i}static SyncAsyncForLoop(e,t,s,r,i,o=0){return m.Run(Math.ceil(e/t),(r=>{i&&i()?r.breakLoop():setTimeout((()=>{for(let o=0;o<t;++o){const n=r.index*t+o;if(n>=e)break;if(s(n),i&&i()){r.breakLoop();break}}r.executeNext()}),o)}),r)}}h.l.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},48620:(e,t,s)=>{s.d(t,{H:()=>i,q:()=>o});const r={};function i(e,t){r[e]=t}function o(e){return r[e]}},46310:(e,t,s)=>{s.d(t,{K:()=>r});class r{static get UniqueId(){const e=this._UniqueIdCounter;return this._UniqueIdCounter++,e}}r._UniqueIdCounter=1},59711:(e,t,s)=>{s.d(t,{N:()=>n,h:()=>r});var r,i=s(58095),o=s(45008);!function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(r||(r={}));class n{static _GetDefaultOptions(){return{puckSize:40,containerSize:60,color:"cyan",puckImage:void 0,containerImage:void 0,position:void 0,alwaysVisible:!1,limitToContainer:!1}}constructor(e,t){this._released=!1;const s={...n._GetDefaultOptions(),...t};if(this._leftJoystick=!!e,n._GlobalJoystickIndex++,this._axisTargetedByLeftAndRight=r.X,this._axisTargetedByUpAndDown=r.Y,this.reverseLeftRight=!1,this.reverseUpDown=!1,this._touches=new o.x,this.deltaPosition=i.P.Zero(),this._joystickSensibility=25,this._inversedSensibility=1/(this._joystickSensibility/1e3),this._onResize=()=>{n._VJCanvasWidth=window.innerWidth,n._VJCanvasHeight=window.innerHeight,n.Canvas&&(n.Canvas.width=n._VJCanvasWidth,n.Canvas.height=n._VJCanvasHeight),n._HalfWidth=n._VJCanvasWidth/2},!n.Canvas){window.addEventListener("resize",this._onResize,!1),n.Canvas=document.createElement("canvas"),n._VJCanvasWidth=window.innerWidth,n._VJCanvasHeight=window.innerHeight,n.Canvas.width=window.innerWidth,n.Canvas.height=window.innerHeight,n.Canvas.style.width="100%",n.Canvas.style.height="100%",n.Canvas.style.position="absolute",n.Canvas.style.backgroundColor="transparent",n.Canvas.style.top="0px",n.Canvas.style.left="0px",n.Canvas.style.zIndex="5",n.Canvas.style.touchAction="none",n.Canvas.setAttribute("touch-action","none");const e=n.Canvas.getContext("2d");if(!e)throw new Error("Unable to create canvas for virtual joystick");n._VJCanvasContext=e,n._VJCanvasContext.strokeStyle="#ffffff",n._VJCanvasContext.lineWidth=2,document.body.appendChild(n.Canvas)}n._HalfWidth=n.Canvas.width/2,this.pressed=!1,this.limitToContainer=s.limitToContainer,this._joystickColor=s.color,this.containerSize=s.containerSize,this.puckSize=s.puckSize,s.position&&this.setPosition(s.position.x,s.position.y),s.puckImage&&this.setPuckImage(s.puckImage),s.containerImage&&this.setContainerImage(s.containerImage),s.alwaysVisible&&n._AlwaysVisibleSticks++,this.alwaysVisible=s.alwaysVisible,this._joystickPointerId=-1,this._joystickPointerPos=new i.FM(0,0),this._joystickPreviousPointerPos=new i.FM(0,0),this._joystickPointerStartPos=new i.FM(0,0),this._deltaJoystickVector=new i.FM(0,0),this._onPointerDownHandlerRef=e=>{this._onPointerDown(e)},this._onPointerMoveHandlerRef=e=>{this._onPointerMove(e)},this._onPointerUpHandlerRef=e=>{this._onPointerUp(e)},n.Canvas.addEventListener("pointerdown",this._onPointerDownHandlerRef,!1),n.Canvas.addEventListener("pointermove",this._onPointerMoveHandlerRef,!1),n.Canvas.addEventListener("pointerup",this._onPointerUpHandlerRef,!1),n.Canvas.addEventListener("pointerout",this._onPointerUpHandlerRef,!1),n.Canvas.addEventListener("contextmenu",(e=>{e.preventDefault()}),!1),requestAnimationFrame((()=>{this._drawVirtualJoystick()}))}setJoystickSensibility(e){this._joystickSensibility=e,this._inversedSensibility=1/(this._joystickSensibility/1e3)}_onPointerDown(e){let t;e.preventDefault(),t=!0===this._leftJoystick?e.clientX<n._HalfWidth:e.clientX>n._HalfWidth,t&&this._joystickPointerId<0?(this._joystickPointerId=e.pointerId,this._joystickPosition?(this._joystickPointerStartPos=this._joystickPosition.clone(),this._joystickPointerPos=this._joystickPosition.clone(),this._joystickPreviousPointerPos=this._joystickPosition.clone(),this._onPointerMove(e)):(this._joystickPointerStartPos.x=e.clientX,this._joystickPointerStartPos.y=e.clientY,this._joystickPointerPos=this._joystickPointerStartPos.clone(),this._joystickPreviousPointerPos=this._joystickPointerStartPos.clone()),this._deltaJoystickVector.x=0,this._deltaJoystickVector.y=0,this.pressed=!0,this._touches.add(e.pointerId.toString(),e)):n._GlobalJoystickIndex<2&&this._action&&(this._action(),this._touches.add(e.pointerId.toString(),{x:e.clientX,y:e.clientY,prevX:e.clientX,prevY:e.clientY}))}_onPointerMove(e){if(this._joystickPointerId==e.pointerId){if(this.limitToContainer){const t=new i.FM(e.clientX-this._joystickPointerStartPos.x,e.clientY-this._joystickPointerStartPos.y),s=t.length();s>this.containerSize&&t.scaleInPlace(this.containerSize/s),this._joystickPointerPos.x=this._joystickPointerStartPos.x+t.x,this._joystickPointerPos.y=this._joystickPointerStartPos.y+t.y}else this._joystickPointerPos.x=e.clientX,this._joystickPointerPos.y=e.clientY;this._deltaJoystickVector=this._joystickPointerPos.clone(),this._deltaJoystickVector=this._deltaJoystickVector.subtract(this._joystickPointerStartPos),0<n._AlwaysVisibleSticks&&(this._leftJoystick?this._joystickPointerPos.x=Math.min(n._HalfWidth,this._joystickPointerPos.x):this._joystickPointerPos.x=Math.max(n._HalfWidth,this._joystickPointerPos.x));const t=(this.reverseLeftRight?-1:1)*this._deltaJoystickVector.x/this._inversedSensibility;switch(this._axisTargetedByLeftAndRight){case r.X:this.deltaPosition.x=Math.min(1,Math.max(-1,t));break;case r.Y:this.deltaPosition.y=Math.min(1,Math.max(-1,t));break;case r.Z:this.deltaPosition.z=Math.min(1,Math.max(-1,t))}const s=(this.reverseUpDown?1:-1)*this._deltaJoystickVector.y/this._inversedSensibility;switch(this._axisTargetedByUpAndDown){case r.X:this.deltaPosition.x=Math.min(1,Math.max(-1,s));break;case r.Y:this.deltaPosition.y=Math.min(1,Math.max(-1,s));break;case r.Z:this.deltaPosition.z=Math.min(1,Math.max(-1,s))}}else{const t=this._touches.get(e.pointerId.toString());t&&(t.x=e.clientX,t.y=e.clientY)}}_onPointerUp(e){if(this._joystickPointerId==e.pointerId)this._clearPreviousDraw(),this._joystickPointerId=-1,this.pressed=!1;else{const t=this._touches.get(e.pointerId.toString());t&&n._VJCanvasContext.clearRect(t.prevX-44,t.prevY-44,88,88)}this._deltaJoystickVector.x=0,this._deltaJoystickVector.y=0,this._touches.remove(e.pointerId.toString())}setJoystickColor(e){this._joystickColor=e}set containerSize(e){this._joystickContainerSize=e,this._clearContainerSize=~~(2.1*this._joystickContainerSize),this._clearContainerSizeOffset=~~(this._clearContainerSize/2)}get containerSize(){return this._joystickContainerSize}set puckSize(e){this._joystickPuckSize=e,this._clearPuckSize=~~(2.1*this._joystickPuckSize),this._clearPuckSizeOffset=~~(this._clearPuckSize/2)}get puckSize(){return this._joystickPuckSize}clearPosition(){this.alwaysVisible=!1,this._joystickPosition=null}set alwaysVisible(e){this._alwaysVisible!==e&&(e&&this._joystickPosition?(n._AlwaysVisibleSticks++,this._alwaysVisible=!0):(n._AlwaysVisibleSticks--,this._alwaysVisible=!1))}get alwaysVisible(){return this._alwaysVisible}setPosition(e,t){this._joystickPointerStartPos&&this._clearPreviousDraw(),this._joystickPosition=new i.FM(e,t)}setActionOnTouch(e){this._action=e}setAxisForLeftRight(e){switch(e){case r.X:case r.Y:case r.Z:this._axisTargetedByLeftAndRight=e;break;default:this._axisTargetedByLeftAndRight=r.X}}setAxisForUpDown(e){switch(e){case r.X:case r.Y:case r.Z:this._axisTargetedByUpAndDown=e;break;default:this._axisTargetedByUpAndDown=r.Y}}_clearPreviousDraw(){const e=this._joystickPosition||this._joystickPointerStartPos;n._VJCanvasContext.clearRect(e.x-this._clearContainerSizeOffset,e.y-this._clearContainerSizeOffset,this._clearContainerSize,this._clearContainerSize),n._VJCanvasContext.clearRect(this._joystickPreviousPointerPos.x-this._clearPuckSizeOffset,this._joystickPreviousPointerPos.y-this._clearPuckSizeOffset,this._clearPuckSize,this._clearPuckSize)}setContainerImage(e){const t=new Image;t.src=e,t.onload=()=>this._containerImage=t}setPuckImage(e){const t=new Image;t.src=e,t.onload=()=>this._puckImage=t}_drawContainer(){const e=this._joystickPosition||this._joystickPointerStartPos;this._clearPreviousDraw(),this._containerImage?n._VJCanvasContext.drawImage(this._containerImage,e.x-this.containerSize,e.y-this.containerSize,2*this.containerSize,2*this.containerSize):(n._VJCanvasContext.beginPath(),n._VJCanvasContext.strokeStyle=this._joystickColor,n._VJCanvasContext.lineWidth=2,n._VJCanvasContext.arc(e.x,e.y,this.containerSize,0,2*Math.PI,!0),n._VJCanvasContext.stroke(),n._VJCanvasContext.closePath(),n._VJCanvasContext.beginPath(),n._VJCanvasContext.lineWidth=6,n._VJCanvasContext.strokeStyle=this._joystickColor,n._VJCanvasContext.arc(e.x,e.y,this.puckSize,0,2*Math.PI,!0),n._VJCanvasContext.stroke(),n._VJCanvasContext.closePath())}_drawPuck(){this._puckImage?n._VJCanvasContext.drawImage(this._puckImage,this._joystickPointerPos.x-this.puckSize,this._joystickPointerPos.y-this.puckSize,2*this.puckSize,2*this.puckSize):(n._VJCanvasContext.beginPath(),n._VJCanvasContext.strokeStyle=this._joystickColor,n._VJCanvasContext.lineWidth=2,n._VJCanvasContext.arc(this._joystickPointerPos.x,this._joystickPointerPos.y,this.puckSize,0,2*Math.PI,!0),n._VJCanvasContext.stroke(),n._VJCanvasContext.closePath())}_drawVirtualJoystick(){this._released||(this.alwaysVisible&&this._drawContainer(),this.pressed&&this._touches.forEach(((e,t)=>{t.pointerId===this._joystickPointerId?(this.alwaysVisible||this._drawContainer(),this._drawPuck(),this._joystickPreviousPointerPos=this._joystickPointerPos.clone()):(n._VJCanvasContext.clearRect(t.prevX-44,t.prevY-44,88,88),n._VJCanvasContext.beginPath(),n._VJCanvasContext.fillStyle="white",n._VJCanvasContext.beginPath(),n._VJCanvasContext.strokeStyle="red",n._VJCanvasContext.lineWidth=6,n._VJCanvasContext.arc(t.x,t.y,40,0,2*Math.PI,!0),n._VJCanvasContext.stroke(),n._VJCanvasContext.closePath(),t.prevX=t.x,t.prevY=t.y)})),requestAnimationFrame((()=>{this._drawVirtualJoystick()})))}releaseCanvas(){n.Canvas&&(n.Canvas.removeEventListener("pointerdown",this._onPointerDownHandlerRef),n.Canvas.removeEventListener("pointermove",this._onPointerMoveHandlerRef),n.Canvas.removeEventListener("pointerup",this._onPointerUpHandlerRef),n.Canvas.removeEventListener("pointerout",this._onPointerUpHandlerRef),window.removeEventListener("resize",this._onResize),document.body.removeChild(n.Canvas),n.Canvas=null),this._released=!0}}n._GlobalJoystickIndex=0,n._AlwaysVisibleSticks=0},51912:(e,t,s)=>{s.d(t,{g:()=>r});class r{constructor(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const e in r.CustomRequestHeaders){const t=r.CustomRequestHeaders[e];t&&this._xhr.setRequestHeader(e,t)}}_shouldSkipRequestModifications(e){return r.SkipRequestModificationForBabylonCDN&&(e.includes("preview.babylonjs.com")||e.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(e){this._xhr.onprogress=e}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(e){this._xhr.responseType=e}get timeout(){return this._xhr.timeout}set timeout(e){this._xhr.timeout=e}addEventListener(e,t,s){this._xhr.addEventListener(e,t,s)}removeEventListener(e,t,s){this._xhr.removeEventListener(e,t,s)}abort(){this._xhr.abort()}send(e){r.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(e)}open(e,t){for(const e of r.CustomRequestModifiers){if(this._shouldSkipRequestModifications(t))return;e(this._xhr,t)}return t=(t=t.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=t,this._xhr.open(e,t,!0)}setRequestHeader(e,t){this._xhr.setRequestHeader(e,t)}getResponseHeader(e){return this._xhr.getResponseHeader(e)}}r.CustomRequestHeaders={},r.CustomRequestModifiers=new Array,r.SkipRequestModificationForBabylonCDN=!0},11758:(e,t,s)=>{s.d(t,{v:()=>r});class r extends class{constructor(e){this._pendingActions=new Array,this._workerInfos=e.map((e=>({workerPromise:Promise.resolve(e),idle:!0})))}dispose(){for(const e of this._workerInfos)e.workerPromise.then((e=>{e.terminate()}));this._workerInfos.length=0,this._pendingActions.length=0}push(e){this._executeOnIdleWorker(e)||this._pendingActions.push(e)}_executeOnIdleWorker(e){for(const t of this._workerInfos)if(t.idle)return this._execute(t,e),!0;return!1}_execute(e,t){e.idle=!1,e.workerPromise.then((s=>{t(s,(()=>{const t=this._pendingActions.shift();t?this._execute(e,t):e.idle=!0}))}))}}{constructor(e,t,s=r.DefaultOptions){super([]),this._maxWorkers=e,this._createWorkerAsync=t,this._options=s}push(e){if(!this._executeOnIdleWorker(e))if(this._workerInfos.length<this._maxWorkers){const t={workerPromise:this._createWorkerAsync(),idle:!1};this._workerInfos.push(t),this._execute(t,e)}else this._pendingActions.push(e)}_execute(e,t){e.timeoutId&&(clearTimeout(e.timeoutId),delete e.timeoutId),super._execute(e,((s,r)=>{t(s,(()=>{r(),e.idle&&(e.timeoutId=setTimeout((()=>{e.workerPromise.then((e=>{e.terminate()}));const t=this._workerInfos.indexOf(e);-1!==t&&this._workerInfos.splice(t,1)}),this._options.idleTimeElapsedBeforeRelease))}))}))}}r.DefaultOptions={idleTimeElapsedBeforeRelease:1e3}},82799:(e,t,s)=>{s(8471),s(27398)},8471:(e,t,s)=>{s.d(t,{Y:()=>l});var r=s(72433),i=s(62897),o=s(15210),n=s(72208),a=s(96969),c=s(48620);class l{get influence(){return this._influence}set influence(e){if(this._influence===e)return;const t=this._influence;this._influence=e,this.onInfluenceChanged.hasObservers()&&this.onInfluenceChanged.notifyObservers(0===t||0===e)}get animationPropertiesOverride(){return!this._animationPropertiesOverride&&this._scene?this._scene.animationPropertiesOverride:this._animationPropertiesOverride}set animationPropertiesOverride(e){this._animationPropertiesOverride=e}constructor(e,t=0,s=null){this.name=e,this.animations=new Array,this._positions=null,this._normals=null,this._tangents=null,this._uvs=null,this._uniqueId=0,this.onInfluenceChanged=new i.y$,this._onDataLayoutChanged=new i.y$,this._animationPropertiesOverride=null,this._scene=s||o.l.LastCreatedScene,this.influence=t,this._scene&&(this._uniqueId=this._scene.getUniqueId())}get uniqueId(){return this._uniqueId}get hasPositions(){return!!this._positions}get hasNormals(){return!!this._normals}get hasTangents(){return!!this._tangents}get hasUVs(){return!!this._uvs}setPositions(e){const t=this.hasPositions;this._positions=e,t!==this.hasPositions&&this._onDataLayoutChanged.notifyObservers(void 0)}getPositions(){return this._positions}setNormals(e){const t=this.hasNormals;this._normals=e,t!==this.hasNormals&&this._onDataLayoutChanged.notifyObservers(void 0)}getNormals(){return this._normals}setTangents(e){const t=this.hasTangents;this._tangents=e,t!==this.hasTangents&&this._onDataLayoutChanged.notifyObservers(void 0)}getTangents(){return this._tangents}setUVs(e){const t=this.hasUVs;this._uvs=e,t!==this.hasUVs&&this._onDataLayoutChanged.notifyObservers(void 0)}getUVs(){return this._uvs}clone(){const e=a.p4.Clone((()=>new l(this.name,this.influence,this._scene)),this);return e._positions=this._positions,e._normals=this._normals,e._tangents=this._tangents,e._uvs=this._uvs,e}serialize(){const e={};return e.name=this.name,e.influence=this.influence,e.positions=Array.prototype.slice.call(this.getPositions()),null!=this.id&&(e.id=this.id),this.hasNormals&&(e.normals=Array.prototype.slice.call(this.getNormals())),this.hasTangents&&(e.tangents=Array.prototype.slice.call(this.getTangents())),this.hasUVs&&(e.uvs=Array.prototype.slice.call(this.getUVs())),a.p4.AppendSerializedAnimations(this,e),e}getClassName(){return"MorphTarget"}static Parse(e,t){const s=new l(e.name,e.influence);if(s.setPositions(e.positions),null!=e.id&&(s.id=e.id),e.normals&&s.setNormals(e.normals),e.tangents&&s.setTangents(e.tangents),e.uvs&&s.setUVs(e.uvs),e.animations){for(let t=0;t<e.animations.length;t++){const r=e.animations[t],i=(0,c.q)("BABYLON.Animation");i&&s.animations.push(i.Parse(r))}e.autoAnimate&&t&&t.beginAnimation(s,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1)}return s}static FromMesh(e,t,s){t||(t=e.name);const r=new l(t,s,e.getScene());return r.setPositions(e.getVerticesData(n.o.PositionKind)),e.isVerticesDataPresent(n.o.NormalKind)&&r.setNormals(e.getVerticesData(n.o.NormalKind)),e.isVerticesDataPresent(n.o.TangentKind)&&r.setTangents(e.getVerticesData(n.o.TangentKind)),e.isVerticesDataPresent(n.o.UVKind)&&r.setUVs(e.getVerticesData(n.o.UVKind)),r}}(0,r.gn)([(0,a.qC)()],l.prototype,"id",void 0)},27398:(e,t,s)=>{s.d(t,{O:()=>c});var r=s(7788),i=s(84318),o=s(15210),n=s(8471),a=s(93097);class c{set areUpdatesFrozen(e){e?this._blockCounter++:(this._blockCounter--,this._blockCounter<=0&&(this._blockCounter=0,this._syncActiveTargets(!0)))}get areUpdatesFrozen(){return this._blockCounter>0}constructor(e=null){if(this._targets=new Array,this._targetInfluenceChangedObservers=new Array,this._targetDataLayoutChangedObservers=new Array,this._activeTargets=new r.t(16),this._supportsNormals=!1,this._supportsTangents=!1,this._supportsUVs=!1,this._vertexCount=0,this._textureVertexStride=0,this._textureWidth=0,this._textureHeight=1,this._uniqueId=0,this._tempInfluences=new Array,this._canUseTextureForTargets=!1,this._blockCounter=0,this._parentContainer=null,this.optimizeInfluencers=!0,this.enableNormalMorphing=!0,this.enableTangentMorphing=!0,this.enableUVMorphing=!0,this._useTextureToStoreTargets=!0,e||(e=o.l.LastCreatedScene),this._scene=e,this._scene){this._scene.morphTargetManagers.push(this),this._uniqueId=this._scene.getUniqueId();const e=this._scene.getEngine().getCaps();this._canUseTextureForTargets=e.canUseGLVertexID&&e.textureFloat&&e.maxVertexTextureImageUnits>0&&e.texture2DArrayMaxLayerCount>1}}get uniqueId(){return this._uniqueId}get vertexCount(){return this._vertexCount}get supportsNormals(){return this._supportsNormals&&this.enableNormalMorphing}get supportsTangents(){return this._supportsTangents&&this.enableTangentMorphing}get supportsUVs(){return this._supportsUVs&&this.enableUVMorphing}get numTargets(){return this._targets.length}get numInfluencers(){return this._activeTargets.length}get influences(){return this._influences}get useTextureToStoreTargets(){return this._useTextureToStoreTargets}set useTextureToStoreTargets(e){this._useTextureToStoreTargets=e}get isUsingTextureForTargets(){return c.EnableTextureStorage&&this.useTextureToStoreTargets&&this._canUseTextureForTargets}getActiveTarget(e){return this._activeTargets.data[e]}getTarget(e){return this._targets[e]}addTarget(e){this._targets.push(e),this._targetInfluenceChangedObservers.push(e.onInfluenceChanged.add((e=>{this._syncActiveTargets(e)}))),this._targetDataLayoutChangedObservers.push(e._onDataLayoutChanged.add((()=>{this._syncActiveTargets(!0)}))),this._syncActiveTargets(!0)}removeTarget(e){const t=this._targets.indexOf(e);t>=0&&(this._targets.splice(t,1),e.onInfluenceChanged.remove(this._targetInfluenceChangedObservers.splice(t,1)[0]),e._onDataLayoutChanged.remove(this._targetDataLayoutChangedObservers.splice(t,1)[0]),this._syncActiveTargets(!0))}_bind(e){e.setFloat3("morphTargetTextureInfo",this._textureVertexStride,this._textureWidth,this._textureHeight),e.setFloatArray("morphTargetTextureIndices",this._morphTargetTextureIndices),e.setTexture("morphTargets",this._targetStoreTexture)}clone(){const e=new c(this._scene);for(const t of this._targets)e.addTarget(t.clone());return e.enableNormalMorphing=this.enableNormalMorphing,e.enableTangentMorphing=this.enableTangentMorphing,e.enableUVMorphing=this.enableUVMorphing,e}serialize(){const e={};e.id=this.uniqueId,e.targets=[];for(const t of this._targets)e.targets.push(t.serialize());return e}_syncActiveTargets(e){if(this.areUpdatesFrozen)return;let t=0;this._activeTargets.reset(),this._supportsNormals=!0,this._supportsTangents=!0,this._supportsUVs=!0,this._vertexCount=0,this._scene&&this._targets.length>this._scene.getEngine().getCaps().texture2DArrayMaxLayerCount&&(this.useTextureToStoreTargets=!1),this._morphTargetTextureIndices&&this._morphTargetTextureIndices.length===this._targets.length||(this._morphTargetTextureIndices=new Float32Array(this._targets.length));let s=-1;for(const e of this._targets){if(s++,0===e.influence&&this.optimizeInfluencers)continue;if(this._activeTargets.length>=c.MaxActiveMorphTargetsInVertexAttributeMode&&!this.isUsingTextureForTargets)break;this._activeTargets.push(e),this._morphTargetTextureIndices[t]=s,this._tempInfluences[t++]=e.influence,this._supportsNormals=this._supportsNormals&&e.hasNormals,this._supportsTangents=this._supportsTangents&&e.hasTangents,this._supportsUVs=this._supportsUVs&&e.hasUVs;const r=e.getPositions();if(r){const e=r.length/3;if(0===this._vertexCount)this._vertexCount=e;else if(this._vertexCount!==e)return void i.Y.Error("Incompatible target. Targets must all have the same vertices count.")}}this._influences&&this._influences.length===t||(this._influences=new Float32Array(t));for(let e=0;e<t;e++)this._influences[e]=this._tempInfluences[e];e&&this.synchronize()}synchronize(){if(this._scene&&!this.areUpdatesFrozen){if(this.isUsingTextureForTargets&&this._vertexCount){this._textureVertexStride=1,this._supportsNormals&&this._textureVertexStride++,this._supportsTangents&&this._textureVertexStride++,this._supportsUVs&&this._textureVertexStride++,this._textureWidth=this._vertexCount*this._textureVertexStride,this._textureHeight=1;const e=this._scene.getEngine().getCaps().maxTextureSize;this._textureWidth>e&&(this._textureHeight=Math.ceil(this._textureWidth/e),this._textureWidth=e);let t=!0;if(this._targetStoreTexture){const e=this._targetStoreTexture.getSize();e.width===this._textureWidth&&e.height===this._textureHeight&&this._targetStoreTexture.depth===this._targets.length&&(t=!1)}if(t){this._targetStoreTexture&&this._targetStoreTexture.dispose();const e=this._targets.length,t=new Float32Array(e*this._textureWidth*this._textureHeight*4);let s=0;for(let r=0;r<e;r++){const e=this._targets[r],o=e.getPositions(),n=e.getNormals(),a=e.getUVs(),c=e.getTangents();if(!o)return void(0===r&&i.Y.Error("Invalid morph target. Target must have positions."));s=r*this._textureWidth*this._textureHeight*4;for(let e=0;e<this._vertexCount;e++)t[s]=o[3*e],t[s+1]=o[3*e+1],t[s+2]=o[3*e+2],s+=4,n&&(t[s]=n[3*e],t[s+1]=n[3*e+1],t[s+2]=n[3*e+2],s+=4),a&&(t[s]=a[2*e],t[s+1]=a[2*e+1],s+=4),c&&(t[s]=c[3*e],t[s+1]=c[3*e+1],t[s+2]=c[3*e+2],s+=4)}this._targetStoreTexture=a.e.CreateRGBATexture(t,this._textureWidth,this._textureHeight,e,this._scene,!1,!1,1,1)}}for(const e of this._scene.meshes)e.morphTargetManager===this&&e._syncGeometryWithMorphTargetManager()}}dispose(){if(this._targetStoreTexture&&this._targetStoreTexture.dispose(),this._targetStoreTexture=null,this._scene&&(this._scene.removeMorphTargetManager(this),this._parentContainer)){const e=this._parentContainer.morphTargetManagers.indexOf(this);e>-1&&this._parentContainer.morphTargetManagers.splice(e,1),this._parentContainer=null}}static Parse(e,t){const s=new c(t);s._uniqueId=e.id;for(const r of e.targets)s.addTarget(n.Y.Parse(r,t));return s}}c.EnableTextureStorage=!0,c.MaxActiveMorphTargetsInVertexAttributeMode=8},5257:(e,t,s)=>{s(84318),s(89209),s(91243),s(34389),s(62897),s(72208)},8820:(e,t,s)=>{var r=s(13514),i=s(84318),o=s(76755),n=s(37290),a=s(51912);n.D.OfflineProviderFactory=(e,t,s=!1)=>new c(e,t,s);class c{get enableSceneOffline(){return this._enableSceneOffline}get enableTexturesOffline(){return this._enableTexturesOffline}constructor(e,t,s=!1){this._idbFactory="undefined"!=typeof indexedDB?indexedDB:void 0,this._currentSceneUrl=c._ReturnFullUrlLocation(e),this._db=null,this._enableSceneOffline=!1,this._enableTexturesOffline=!1,this._manifestVersionFound=0,this._mustUpdateRessources=!1,this._hasReachedQuota=!1,c.IDBStorageEnabled?s?(this._enableSceneOffline=!0,this._enableTexturesOffline=!0,this._manifestVersionFound=1,r.w1.SetImmediate((()=>{t(!0)}))):this._checkManifestFile(t):t(!0)}_checkManifestFile(e){const t=()=>{this._enableSceneOffline=!1,this._enableTexturesOffline=!1,e(!1)},s=()=>{try{if("function"==typeof URL&&0===this._currentSceneUrl.indexOf("http")){const e=new URL(this._currentSceneUrl);return e.pathname+=".manifest",e.toString()}}catch(e){}return`${this._currentSceneUrl}.manifest`};let r=!1,o=s();const n=new a.g;navigator.onLine&&(r=!0,o=o+(null==o.match(/\?/)?"?":"&")+Date.now()),n.open("GET",o),n.addEventListener("load",(()=>{if(200===n.status||c._ValidateXHRData(n,1))try{const t=JSON.parse(n.response);this._enableSceneOffline=t.enableSceneOffline,this._enableTexturesOffline=t.enableTexturesOffline&&c._IsUASupportingBlobStorage,t.version&&!isNaN(parseInt(t.version))&&(this._manifestVersionFound=t.version),e(!0)}catch(e){t()}else t()}),!1),n.addEventListener("error",(()=>{if(r){r=!1;const e=s();n.open("GET",e),n.send()}else t()}),!1);try{n.send()}catch(t){i.Y.Error("Error on XHR send request."),e(!1)}}open(e,t){const s=()=>{this._isSupported=!1,t&&t()};if(this._idbFactory&&(this._enableSceneOffline||this._enableTexturesOffline))if(this._db)e&&e();else{this._hasReachedQuota=!1,this._isSupported=!0;const t=this._idbFactory.open("babylonjs",1);t.onerror=()=>{s()},t.onblocked=()=>{i.Y.Error("IDB request blocked. Please reload the page."),s()},t.onsuccess=()=>{this._db=t.result,e()},t.onupgradeneeded=e=>{if(this._db=e.target.result,this._db)try{this._db.createObjectStore("scenes",{keyPath:"sceneUrl"}),this._db.createObjectStore("versions",{keyPath:"sceneUrl"}),this._db.createObjectStore("textures",{keyPath:"textureUrl"})}catch(e){i.Y.Error("Error while creating object stores. Exception: "+e.message),s()}}}else this._isSupported=!1,t&&t()}loadImage(e,t){const s=c._ReturnFullUrlLocation(e),r=()=>{this._hasReachedQuota||null===this._db?t.src=e:this._saveImageIntoDBAsync(s,t)};this._mustUpdateRessources?r():this._loadImageFromDBAsync(s,t,r)}_loadImageFromDBAsync(e,t,s){if(this._isSupported&&null!==this._db){let r;const o=this._db.transaction(["textures"]);o.onabort=()=>{t.src=e},o.oncomplete=()=>{let o;r&&"function"==typeof URL?(o=URL.createObjectURL(r.data),t.onerror=()=>{i.Y.Error("Error loading image from blob URL: "+o+" switching back to web url: "+e),t.src=e},t.src=o):s()};const n=o.objectStore("textures").get(e);n.onsuccess=e=>{r=e.target.result},n.onerror=()=>{i.Y.Error("Error loading texture "+e+" from DB."),t.src=e}}else i.Y.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),t.src=e}_saveImageIntoDBAsync(e,t){let s;if(this._isSupported){const r=()=>{let e;if(s&&"function"==typeof URL)try{e=URL.createObjectURL(s)}catch(t){e=URL.createObjectURL(s)}e&&(t.src=e)};if(c._IsUASupportingBlobStorage){const o=new a.g;o.open("GET",e),o.responseType="blob",o.addEventListener("load",(()=>{if(200===o.status&&this._db){s=o.response;const i=this._db.transaction(["textures"],"readwrite");i.onabort=e=>{try{const t=e.target.error;t&&"QuotaExceededError"===t.name&&(this._hasReachedQuota=!0)}catch(e){}r()},i.oncomplete=()=>{r()};const n={textureUrl:e,data:s};try{const e=i.objectStore("textures").put(n);e.onsuccess=()=>{},e.onerror=()=>{r()}}catch(s){25===s.code&&(c._IsUASupportingBlobStorage=!1,this._enableTexturesOffline=!1),t.src=e}}else t.src=e}),!1),o.addEventListener("error",(()=>{i.Y.Error("Error in XHR request in BABYLON.Database."),t.src=e}),!1),o.send()}else t.src=e}else i.Y.Error("Error: IndexedDB not supported by your browser or Babylon.js database is not open."),t.src=e}_checkVersionFromDB(e,t){this._loadVersionFromDBAsync(e,t,(()=>{this._saveVersionIntoDBAsync(e,t)}))}_loadVersionFromDBAsync(e,t,s){if(this._isSupported&&this._db){let r;try{const o=this._db.transaction(["versions"]);o.oncomplete=()=>{r?this._manifestVersionFound!==r.data?(this._mustUpdateRessources=!0,s()):t(r.data):(this._mustUpdateRessources=!0,s())},o.onabort=()=>{t(-1)};const n=o.objectStore("versions").get(e);n.onsuccess=e=>{r=e.target.result},n.onerror=()=>{i.Y.Error("Error loading version for scene "+e+" from DB."),t(-1)}}catch(e){i.Y.Error("Error while accessing 'versions' object store (READ OP). Exception: "+e.message),t(-1)}}else i.Y.Error("Error: IndexedDB not supported by your browser or Babylon.js database is not open."),t(-1)}_saveVersionIntoDBAsync(e,t){if(this._isSupported&&!this._hasReachedQuota&&this._db)try{const s=this._db.transaction(["versions"],"readwrite");s.onabort=e=>{try{const t=e.target.error;t&&"QuotaExceededError"===t.name&&(this._hasReachedQuota=!0)}catch(e){}t(-1)},s.oncomplete=()=>{t(this._manifestVersionFound)};const r={sceneUrl:e,data:this._manifestVersionFound},o=s.objectStore("versions").put(r);o.onsuccess=()=>{},o.onerror=()=>{i.Y.Error("Error in DB add version request in BABYLON.Database.")}}catch(e){i.Y.Error("Error while accessing 'versions' object store (WRITE OP). Exception: "+e.message),t(-1)}else t(-1)}loadFile(e,t,s,r,i){const o=c._ReturnFullUrlLocation(e),n=()=>{this._saveFileAsync(o,t,s,i,r)};this._checkVersionFromDB(o,(e=>{-1!==e?this._mustUpdateRessources?this._saveFileAsync(o,t,s,i,r):this._loadFileAsync(o,t,n):r&&r()}))}_loadFileAsync(e,t,s){if(this._isSupported&&this._db){let r,o;r=-1!==e.indexOf(".babylon")?"scenes":"textures";const n=this._db.transaction([r]);n.oncomplete=()=>{o?t(o.data):s()},n.onabort=()=>{s()};const a=n.objectStore(r).get(e);a.onsuccess=e=>{o=e.target.result},a.onerror=()=>{i.Y.Error("Error loading file "+e+" from DB."),s()}}else i.Y.Error("Error: IndexedDB not supported by your browser or BabylonJS Database is not open."),t()}_saveFileAsync(e,t,s,r,o){if(this._isSupported){let n;n=-1!==e.indexOf(".babylon")?"scenes":"textures";const l=new a.g;let h;l.open("GET",e+(null==e.match(/\?/)?"?":"&")+Date.now()),r&&(l.responseType="arraybuffer"),s&&(l.onprogress=s),l.addEventListener("load",(()=>{if(200===l.status||l.status<400&&c._ValidateXHRData(l,r?6:1))if(h=r?l.response:l.responseText,!this._hasReachedQuota&&this._db){const s=this._db.transaction([n],"readwrite");let r;s.onabort=e=>{try{const t=e.target.error;t&&"QuotaExceededError"===t.name&&(this._hasReachedQuota=!0)}catch(e){}t(h)},s.oncomplete=()=>{t(h)},r="scenes"===n?{sceneUrl:e,data:h,version:this._manifestVersionFound}:{textureUrl:e,data:h};try{const e=s.objectStore(n).put(r);e.onsuccess=()=>{},e.onerror=()=>{i.Y.Error("Error in DB add file request in BABYLON.Database.")}}catch(e){t(h)}}else t(h);else l.status>=400&&o?o(l):t()}),!1),l.addEventListener("error",(()=>{i.Y.Error("error on XHR request."),o&&o()}),!1),l.send()}else i.Y.Error("Error: IndexedDB not supported by your browser or Babylon.js database is not open."),o&&o()}static _ValidateXHRData(e,t=7){try{if(1&t){if(e.responseText&&e.responseText.length>0)return!0;if(1===t)return!1}if(2&t){const s=(0,o.A6)(e.response);if(s.width&&s.height&&s.width>0&&s.height>0)return!0;if(2===t)return!1}if(4&t){const t=new Uint8Array(e.response,0,3);return 68===t[0]&&68===t[1]&&83===t[2]}}catch(e){}return!1}}c._IsUASupportingBlobStorage=!0,c.IDBStorageEnabled=!1,c._ParseURL=e=>{document.createElement("a").href=e;const t=e.substring(0,e.lastIndexOf("#")),s=e.substring(t.lastIndexOf("/")+1,e.length);return e.substring(0,e.indexOf(s,0))},c._ReturnFullUrlLocation=e=>-1===e.indexOf("http:/")&&-1===e.indexOf("https:/")&&"undefined"!=typeof window?c._ParseURL(window.location.href)+e:e}}]);